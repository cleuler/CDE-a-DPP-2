<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt-BR" xml:lang="pt-BR"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Cleuler Barbosa das Neves">
<title>4&nbsp; AED - cap 5 pldr - Ajustando Modelos aos Dados – __Ciência de Dados e Estatística Aplicadas ao Direito e Políticas Públicas__</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 1em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./cap13-pldr-model-rel-contin.html" rel="next">
<link href="./cap3-DistNorm.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-70a47bd5681a7291082a5b9f83d58762.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./cap5-pldr-modelos-dados.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">AED - cap 5 pldr - Ajustando Modelos aos Dados</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Procurar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./"><strong>Ciência de Dados e Estatística Aplicadas ao Direito e Políticas Públicas</strong></a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Alternar modo de leitor">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Procurar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pretexto</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introdução</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AEID-cap18-Reproduzivel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">AEID - Análise Exploratória e Inferencial de Dados</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cap3-DistNorm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">AED - cap 3 - As Distribuições Normais</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cap5-pldr-modelos-dados.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">AED - cap 5 pldr - Ajustando Modelos aos Dados</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cap13-pldr-model-rel-contin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">AID - cap 13 - Modelagem de Relações Contínuas</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cap16-pldr-EstMultiv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">AID - cap 16 - Estatística Multivariada</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cap6-moore-tab-dupla-entrada.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">AED - cap 6 moore - Tabelas de Dupla Entrada</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./replicar-suco-uva-tab-graf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">AED - suco uva - Tabelas e Gráficos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cap16-moore-IC-o-basico.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">AEI - cap 16 moore - IC: o Básico</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cap17-moore-TSHN-o-basico.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">AEI - cap 17 moore - TSH0</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cap17-LO-testes-significancia-basico.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Testes de Significância: o Básico</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cap18-LO-inferencia-na-pratica.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Inferência na Prática</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Conclusão</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apendiceA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Apêndice A - EMENTA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apendiceB-quadroVar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Apêndice B - Quadro Var</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./referencias.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referências</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Sumário</h2>
   
  <ul>
<li><a href="#objetivos-da-aprendizagem" id="toc-objetivos-da-aprendizagem" class="nav-link active" data-scroll-target="#objetivos-da-aprendizagem"><span class="header-section-number">4.1</span> Objetivos da Aprendizagem</a></li>
  <li><a href="#o-que-%C3%A9-um-modelo" id="toc-o-que-é-um-modelo" class="nav-link" data-scroll-target="#o-que-%C3%A9-um-modelo"><span class="header-section-number">4.2</span> O que É um Modelo?</a></li>
  <li><a href="#modelagem-estat%C3%ADstica-um-exemplo" id="toc-modelagem-estatística-um-exemplo" class="nav-link" data-scroll-target="#modelagem-estat%C3%ADstica-um-exemplo"><span class="header-section-number">4.3</span> Modelagem Estatística: Um Exemplo</a></li>
  <li><a href="#aprimorando-nosso-modelo" id="toc-aprimorando-nosso-modelo" class="nav-link" data-scroll-target="#aprimorando-nosso-modelo"><span class="header-section-number">4.4</span> Aprimorando Nosso Modelo</a></li>
  <li><a href="#quais-s%C3%A3o-os-crit%C3%A9rios-para-um-bom-modelo" id="toc-quais-são-os-critérios-para-um-bom-modelo" class="nav-link" data-scroll-target="#quais-s%C3%A3o-os-crit%C3%A9rios-para-um-bom-modelo"><span class="header-section-number">4.5</span> Quais São os Critérios para um “Bom” Modelo?</a></li>
  <li><a href="#um-modelo-pode-ser-demasiadamente-bom" id="toc-um-modelo-pode-ser-demasiadamente-bom" class="nav-link" data-scroll-target="#um-modelo-pode-ser-demasiadamente-bom"><span class="header-section-number">4.6</span> Um Modelo Pode Ser Demasiadamente Bom?</a></li>
  <li><a href="#sumariza%C3%A7%C3%A3o-de-dados-usando-a-m%C3%A9dia" id="toc-sumarização-de-dados-usando-a-média" class="nav-link" data-scroll-target="#sumariza%C3%A7%C3%A3o-de-dados-usando-a-m%C3%A9dia"><span class="header-section-number">4.7</span> Sumarização de Dados Usando a Média</a></li>
  <li><a href="#sumariza%C3%A7%C3%A3o-robusta-de-dados-usando-a-mediana" id="toc-sumarização-robusta-de-dados-usando-a-mediana" class="nav-link" data-scroll-target="#sumariza%C3%A7%C3%A3o-robusta-de-dados-usando-a-mediana"><span class="header-section-number">4.8</span> Sumarização Robusta de Dados Usando a Mediana</a></li>
  <li><a href="#a-moda" id="toc-a-moda" class="nav-link" data-scroll-target="#a-moda"><span class="header-section-number">4.9</span> A Moda</a></li>
  <li><a href="#variabilidade-at%C3%A9-que-ponto-a-m%C3%A9dia-se-ajusta-bem-aos-dados" id="toc-variabilidade-até-que-ponto-a-média-se-ajusta-bem-aos-dados" class="nav-link" data-scroll-target="#variabilidade-at%C3%A9-que-ponto-a-m%C3%A9dia-se-ajusta-bem-aos-dados"><span class="header-section-number">4.10</span> Variabilidade: Até que Ponto a Média se Ajusta Bem aos Dados?</a></li>
  <li><a href="#usando-simula%C3%A7%C3%B5es-para-entender-estat%C3%ADstica" id="toc-usando-simulações-para-entender-estatística" class="nav-link" data-scroll-target="#usando-simula%C3%A7%C3%B5es-para-entender-estat%C3%ADstica"><span class="header-section-number">4.11</span> Usando Simulações para Entender Estatística</a></li>
  <li><a href="#z-scores" id="toc-z-scores" class="nav-link" data-scroll-target="#z-scores"><span class="header-section-number">4.12</span> Z-Scores</a></li>
  <li><a href="#interpretando-z-scores" id="toc-interpretando-z-scores" class="nav-link" data-scroll-target="#interpretando-z-scores"><span class="header-section-number">4.13</span> Interpretando Z-scores</a></li>
  <li><a href="#escores-padronizados" id="toc-escores-padronizados" class="nav-link" data-scroll-target="#escores-padronizados"><span class="header-section-number">4.14</span> Escores Padronizados</a></li>
  <li><a href="#usando-z-scores-para-comparar-distribui%C3%A7%C3%B5es" id="toc-usando-z-scores-para-comparar-distribuições" class="nav-link" data-scroll-target="#usando-z-scores-para-comparar-distribui%C3%A7%C3%B5es"><span class="header-section-number">4.15</span> Usando Z-scores para Comparar Distribuições</a></li>
  <li><a href="#problemas" id="toc-problemas" class="nav-link" data-scroll-target="#problemas"><span class="header-section-number">4.16</span> Problemas</a></li>
  <li><a href="#coeficiente-de-correla%C3%A7%C3%A3o---cap.-10-pldr" id="toc-coeficiente-de-correlação---cap.-10-pldr" class="nav-link" data-scroll-target="#coeficiente-de-correla%C3%A7%C3%A3o---cap.-10-pldr"><span class="header-section-number">4.17</span> Coeficiente de Correlação - cap. 10 pldr</a></li>
  <li>
<a href="#correla%C3%A7%C3%A3o-micro-e-pequena-empresas" id="toc-correlação-micro-e-pequena-empresas" class="nav-link" data-scroll-target="#correla%C3%A7%C3%A3o-micro-e-pequena-empresas"><span class="header-section-number">4.18</span> Correlação: micro e pequena empresas</a>
  <ul>
<li><a href="#importar" id="toc-importar" class="nav-link" data-scroll-target="#importar"><span class="header-section-number">4.18.1</span> Importar</a></li>
  <li><a href="#dicion%C3%A1rio-de-dados" id="toc-dicionário-de-dados" class="nav-link" data-scroll-target="#dicion%C3%A1rio-de-dados"><span class="header-section-number">4.18.2</span> Dicionário de Dados</a></li>
  <li><a href="#contexto-dos-dados" id="toc-contexto-dos-dados" class="nav-link" data-scroll-target="#contexto-dos-dados"><span class="header-section-number">4.18.3</span> Contexto dos dados</a></li>
  <li><a href="#explorar" id="toc-explorar" class="nav-link" data-scroll-target="#explorar"><span class="header-section-number">4.18.4</span> Explorar</a></li>
  <li><a href="#contexto-mpe-no-estado-de-goi%C3%A1s" id="toc-contexto-mpe-no-estado-de-goiás" class="nav-link" data-scroll-target="#contexto-mpe-no-estado-de-goi%C3%A1s"><span class="header-section-number">4.18.5</span> Contexto MPE no Estado de Goiás</a></li>
  <li>
<a href="#an%C3%A1lise-explorat%C3%B3ria-explicativa-bivariada" id="toc-análise-exploratória-explicativa-bivariada" class="nav-link" data-scroll-target="#an%C3%A1lise-explorat%C3%B3ria-explicativa-bivariada"><span class="header-section-number">4.18.6</span> Análise Exploratória Explicativa bivariada</a>
  <ul class="collapse">
<li><a href="#y-caged-e-x-pgtogo_mpe" id="toc-y-caged-e-x-pgtogo_mpe" class="nav-link" data-scroll-target="#y-caged-e-x-pgtogo_mpe"><span class="header-section-number">4.18.6.1</span> Y = <code>CAGED</code> e X = <code>PgtoGO_MPE</code></a></li>
  <li><a href="#z-score" id="toc-z-score" class="nav-link" data-scroll-target="#z-score"><span class="header-section-number">4.18.6.2</span> Z-score</a></li>
  <li><a href="#y-rais-e-x-pgtogo_mpe" id="toc-y-rais-e-x-pgtogo_mpe" class="nav-link" data-scroll-target="#y-rais-e-x-pgtogo_mpe"><span class="header-section-number">4.18.6.3</span> Y = <code>RAIS</code> e X = <code>PgtoGO_MPE</code></a></li>
  <li><a href="#y-pib-e-x-pgtogo_mpe" id="toc-y-pib-e-x-pgtogo_mpe" class="nav-link" data-scroll-target="#y-pib-e-x-pgtogo_mpe"><span class="header-section-number">4.18.6.4</span> Y = <code>PIB</code> e X = <code>PgtoGO_MPE</code></a></li>
  </ul>
</li>
  <li><a href="#conclus%C3%A3o" id="toc-conclusão" class="nav-link" data-scroll-target="#conclus%C3%A3o"><span class="header-section-number">4.18.7</span> Conclusão</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-model-dados" class="quarto-section-identifier"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">AED - cap 5 pldr - Ajustando Modelos aos Dados</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><blockquote class="blockquote">
<p>Uma das atividades fundamentais da estatística é criar modelos que possam sumarizar os dados com um conjunto pequeno de números, fornecendo, assim, uma descrição compacta deles, aliada a uma medida de nossa incerteza sobre essa descrição. Neste capítulo, analisaremos o conceito de modelo estatístico e como ele pode ser usado para descrever os dados.. <span class="citation" data-cites="poldrack_pensamento_est_2025">(<a href="referencias.html#ref-poldrack_pensamento_est_2025" role="doc-biblioref">Poldrack, 2025</a> , p.&nbsp;41)</span>.</p>
</blockquote>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(NHANES)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mapproj)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pander)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelr)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">panderOptions</span>(<span class="st">'round'</span>,<span class="dv">2</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">panderOptions</span>(<span class="st">'digits'</span>,<span class="dv">7</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>))</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>) <span class="co"># set random seed to exactly replicate results</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="objetivos-da-aprendizagem" class="level2" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="objetivos-da-aprendizagem">
<span class="header-section-number">4.1</span> Objetivos da Aprendizagem</h2>
<blockquote class="blockquote">
<p>Após ler este capítulo, você deve ser capaz de:</p>
<p>▶Descrever a equação básica para modelos estatísticos (dados = modelo + erro).</p>
<p>▶Descrever diferentes medidas de tendência central e dispersão, como são calculadas e quais são apropriadas em quais circunstâncias.</p>
<p>▶Calcular o Z-score [escore-Z] e descrever por que é útil. <span class="citation" data-cites="poldrack_pensamento_est_2025">(<a href="referencias.html#ref-poldrack_pensamento_est_2025" role="doc-biblioref">Poldrack, 2025</a> , p.&nbsp;41)</span>.</p>
</blockquote>
</section><section id="o-que-é-um-modelo" class="level2" data-number="4.2"><h2 data-number="4.2" class="anchored" data-anchor-id="o-que-é-um-modelo">
<span class="header-section-number">4.2</span> O que É um Modelo?</h2>
<blockquote class="blockquote">
<p>No mundo tangível, <strong><em>modelos geralmente são simplificações</em></strong> de <strong><em>objetos</em></strong> do <strong><em>mundo real</em></strong> que, ainda assim, <strong><em>expressam a essência</em></strong> do que está sendo <em>modelado</em>.</p>
<p>Um <em>modelo</em> de um edifício traduz a estrutura da sua construção, sendo ao mesmo tempo pequeno e leve o suficiente para ser manuseado com as mãos; em biologia, um modelo de célula é muito maior que a célula propriamente dita, mas, novamente, representa suas partes principais e suas relações.</p>
<p>Em <em>estatística</em>, um <strong><em>modelo</em></strong> tem o <strong><em>objetivo</em></strong> de <strong><em>fornecer uma descrição condensada</em></strong> parecida, porém <strong><em>aplicada a dados</em></strong> e não a uma estrutura física.</p>
<p>Assim como modelos físicos, em geral, um modelo estatístico é bem <strong><em>mais simples</em></strong> do <strong><em>que</em></strong> os <strong><em>dados que descreve</em></strong>; ele serve para <strong><em>capturar a estrutura</em></strong> deles da <strong><em>forma mais simples possível</em></strong>.</p>
<p>Em ambos os casos, percebemos que o <u><strong><em>modelo</em></strong></u> <strong><em>é uma ficção conveniente</em></strong> que <strong><em>necessariamente ignora alguns detalhes</em></strong> do <strong><em>objeto real</em></strong> que está sendo <strong><em>modelado</em></strong>.</p>
<p>Como disse o famoso estatístico George Box: <u><strong>“Todos os modelos estão errados, mas alguns são úteis”</strong></u>.</p>
<p>Além disso, <strong><em>pode ser útil</em></strong> <u><strong><em>considerar um modelo estatístico como uma teoria de como os dados observados foram gerados</em></strong></u>; nosso <strong><em>objetivo</em></strong> então se torna <u><strong><em>encontrar aquele que sumariza</em></strong></u> <strong><em>com mais <u>eficiência e acurácia</u></em></strong> a maneira <u><strong><em>como os dados</em></strong></u> foram verdadeiramente <u><strong><em>gerados</em></strong></u>.</p>
<p>No entanto, como veremos a seguir, os desejos de eficiência e de acurácia, não raro, são radicalmente contrários entre si.</p>
<p>A estrutura básica de um modelo estatístico é:</p>
<p><span class="math display">\[
dados = modelo + erros
\]</span></p>
<p>Isso <em>expressa a <strong>ideia</strong></em> de que os <u><strong><em>dados</em></strong></u> podem ser <u><strong><em>divididos</em></strong></u> em <u><strong><em>duas partes</em></strong></u>: <strong><em>uma que é descrita por</em></strong> um <u><strong><em>modelo estatístico</em></strong></u>, expressando os <strong><em>valores que esperamos que os dados assumam devido ao nosso conhecimento</em></strong>, e <u><strong><em>outra parte</em></strong></u> que chamamos de <u><strong><em>erro</em></strong></u>, retratando a <strong><em>diferença entre as predições do modelo e os dados observados</em></strong>.</p>
<p>Basicamente, gostaríamos de usar nosso modelo a fim de <u><strong><em>predizer</em></strong></u> o valor dos dados para qualquer observação. Escreveríamos a equação assim:</p>
<p><span class="math display">\[
\widehat{dados_i} = modelo_i
\]</span></p>
<p>O <strong>“chapéu”</strong> sobre <em>dados</em> indica que se trata de uma estimativa, e não do valor real deles.</p>
<p>Ou seja, o <strong><em>valor predito</em></strong> dos dados para a <em>observação i</em> é <em>igual</em> ao <em>valor do modelo</em> para <em>essa observação</em>.</p>
<p>Assim que tivermos uma predição do modelo, podemos calcular o <u><strong><em>erro</em></strong></u> <u>[</u>resíduo<u>]</u>: Ou seja, o erro para qualquer <em>observação i</em> é a <strong><em>diferença entre o valor observado dos dados e o valor predito dos dados a partir do modelo</em></strong>.</p>
<p><span class="citation" data-cites="poldrack_pensamento_est_2025">(<a href="referencias.html#ref-poldrack_pensamento_est_2025" role="doc-biblioref">Poldrack, 2025</a> , p.&nbsp;41-42)</span>.</p>
</blockquote>
</section><section id="modelagem-estatística-um-exemplo" class="level2" data-number="4.3"><h2 data-number="4.3" class="anchored" data-anchor-id="modelagem-estatística-um-exemplo">
<span class="header-section-number">4.3</span> Modelagem Estatística: Um Exemplo</h2>
<blockquote class="blockquote">
<p>Vejamos um exemplo de criação de um modelo para os dados, usando os dados do NHANES. Em termos específicos, tentaremos criar um modelo da altura das crianças na amostra do NHANES. Primeiro, carregaremos e plotaremos os dados (Figura 5.1). <span class="citation" data-cites="poldrack_pensamento_est_2025">(<a href="referencias.html#ref-poldrack_pensamento_est_2025" role="doc-biblioref">Poldrack, 2025</a> , p.&nbsp;42)</span></p>
</blockquote>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># drop duplicated IDs within the NHANES dataset</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>NHANES <span class="ot">&lt;-</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  NHANES <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(ID, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># select the appropriate children with good height measurements</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>NHANES_child <span class="ot">&lt;-</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  NHANES <span class="sc">%&gt;%</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(Height) <span class="sc">%&gt;%</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(Age <span class="sc">&lt;</span> <span class="dv">18</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>NHANES_child <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>NHANES_child <span class="sc">%&gt;%</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Height)) <span class="sc">+</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">100</span>) <span class="sc">+</span> </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Histograma da altura [Height]: 1691 crianças no NHANES"</span>,</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">"filtro: idade (age) &lt; 18 anos"</span>,</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Fonte: Poldrack, 2025, p. 42, fig. 5.1"</span>,</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"Altura (Height)"</span>,</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">"Contagem (Count)"</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 1691</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap5-pldr-modelos-dados_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Lembre que queremos descrever os dados do modo mais simples possível, porém capturando suas features mais importantes. O modelo mais simples imaginável teria apenas um número; ou seja, prediria o mesmo valor para cada observação, independentemente de qualquer outra informação que temos sobre essas observações. Em geral, descrevemos um modelo conforme seus parâmetros, valores que podemos alterar para modificar as predições dele. No decorrer desta obra, usamos a letra grega beta (β) para representá-los; quando o modelo tem mais de um parâmetro, usamos números subscritos para diferenciar as letras betas (por exemplo, β1). É comum também referenciar os valores dos dados usando a letra y e observações individuais usando uma versão com subscrita (yi).</p>
<p>Como geralmente não conhecemos os valores lógicos dos parâmetros, precisamos estimá-los a partir dos dados. Por isso, costumamos colocar um “chapéu” sobre o símbolo β para indicar que estamos usando uma estimativa do valor do parâmetro, e não o seu valor lógico.</p>
<p>Assim, nosso <strong><em>modelo simples</em></strong> para <strong><em>altura considerando um único parâmetro</em></strong> seria:</p>
<p><span class="math display">\[
y_i = \hat{\beta} + \epsilon
\]</span></p>
<p>O i subscrito não aparece ao lado direito da equação, significando que a predição do modelo não depende da observação específica que estamos analisando — é a mesma para todas. A pergunta então é: como estimamos os melhores valores do(s) parâmetro(s) no modelo? Nesse caso específico, qual valor único seria a melhor estimativa para β? E, mais importante, como definimos melhor?</p>
<p><strong><em>Um estimador simples</em></strong> seria a <strong><em>moda</em></strong>, que é simplesmente o valor mais comum no conjunto de dados. Ela redescreveria todo o conjunto de 1.691 crianças em termos de um único número. Se quiséssemos predizer a altura de qualquer nova criança, nosso valor predito seria o mesmo número:</p>
<p><span class="math display">\[
y_i = 166.5 \text{ para todos os i}
\]</span></p>
<p>O <strong><em>erro</em></strong> [também denominado por <em>resíduo</em>] para cada sujeito de pesquisa seria então a diferença entre o valor predito <span class="math inline">\((\hat{y}_i)\)</span> e sua altura real <span class="math inline">\((y_i)\)</span>:</p>
<p><span class="math display">\[
erro_i = y_i - \hat{y}_i
\]</span></p>
<p>Qual a eficácia deste modelo? Em geral, definimos a qualidade de um modelo em termos da magnitude do erro, que representa o quanto os dados divergem das predições; em condições iguais, aquele que gera o menor erro é o melhor modelo. (Mas, como veremos mais tarde, as condições nem sempre são iguais…). No caso de colocar a moda como estimador para β, descobrimos que o erro médio individual é de consideráveis −28,8 centímetros, o que não parece muito bom à primeira vista.</p>
<p>Como podemos encontrar um melhor estimador para o parâmetro do nosso modelo? Podemos começar tentando encontrar um estimador que nos forneça um erro médio de 0. Um bom candidato é a média aritmética (também chamada simplesmente de média, geralmente representada por uma barra sobre a variável, como <span class="math inline">\(\overline{X}\)</span>), calculada como a soma de todos os valores, dividida pelo número de valores. Matematicamente, ela é expressada assim:</p>
<p><span class="math display">\[
\bar{X} = \frac{\sum_{i=1}^{n} x_i}{n}
\]</span></p>
<p>Acontece que, se usarmos a média aritmética como nosso estimador, o erro médio é matematicamente garantido como 0 (veja a comprovação simples no final do capítulo, caso esteja interessado).</p>
<p>Embora a média dos erros a partir da média seja 0, no histograma da Figura 5.2, é possível ver que cada item individual ainda tem algum grau de erro; alguns são positivos, outros, negativos, e <strong><em>eles se anulam mutuamente para fornecer um erro médio de 0</em></strong>.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># compute error compared to the mean and plot histogram</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>error_mean <span class="ot">&lt;-</span> NHANES_child<span class="sc">$</span>Height <span class="sc">-</span> <span class="fu">mean</span>(NHANES_child<span class="sc">$</span>Height)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="cn">NULL</span>, <span class="fu">aes</span>(error_mean)) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">60</span>, <span class="dv">60</span>) <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Histograma da distribuição de erros a partir da média"</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">"1691 crianças no NHANES com filtro: idade (age) &lt; 18 anos"</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Fonte: Poldrack, 2025, p. 44, fig. 5.2"</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"Erro ao predizer a Altura (Height) com a média"</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">"Contagem (Count)"</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap5-pldr-modelos-dados_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Gerar um boxplot para verificar a existência de <strong><em>outliers</em></strong>.</p>
<p>Não foram detectados NA’s nem outliers no conjunto de dados plotados.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.na</span>(error_mean) <span class="sc">%&gt;%</span> <span class="fu">sum</span>() <span class="co"># verifica se há NA's</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>error_mean <span class="sc">%&gt;%</span> <span class="fu">summary</span>() <span class="co"># resumo dos 5 números e média</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="cn">NULL</span>, <span class="fu">aes</span>(error_mean)) <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">60</span>, <span class="dv">60</span>) <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">title    =</span> <span class="st">"Boxplot da altura [Height]: 1691 crianças no NHANES"</span>,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">"filtro: idade (age) &lt; 18 anos"</span>,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption  =</span> <span class="st">"Fonte: cleuler"</span>,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"Erro ao predizer a Altura (Height) com a média"</span>,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">"Contagem (Count)"</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  -54.1   -23.0     2.5     0.0    23.0    55.6 </code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap5-pldr-modelos-dados_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>O fato de os erros negativos e positivos se anularem implica que dois modelos diferentes poderiam ter erros de magnitude bem distintos em termos absolutos, mas que, ainda assim, teriam o mesmo erro médio.</p>
<p>É exatamente por isso que o <strong><em>erro médio não é um bom critério para nosso estimador</em></strong>; <strong><em>queremos um critério que minimize o erro geral, independentemente da direção</em></strong>.</p>
<p>Por esse motivo, normalmente sumarizamos os erros usando algum tipo de medida que considere indesejáveis aqueles positivos e negativos.</p>
<p>Poderíamos usar o valor absoluto de cada erro, porém é <strong><em>mais comum usar os erros quadráticos</em></strong>, por razões que analisaremos mais adiante no livro.</p>
<p>Ao longo desta obra, os leitores verão <strong><em>diversas formas comuns de sumarizar o erro quadrático</em></strong>.</p>
<p>Por isso, é importante entender como elas se relacionam.</p>
<p><u><strong>Primeiro</strong></u>, poderíamos simplesmente somá-los; isso se chama <strong><em>soma dos erros quadráticos</em></strong>.</p>
<p>Normalmente, o motivo pelo qual não usamos essa medida é que <strong><em>sua magnitude depende do número de pontos de dados</em></strong>, podendo <strong><em>dificultar a interpretação</em></strong>, <strong><em>a menos que estejamos analisando o mesmo número de observações</em></strong>.</p>
<p><u><strong>Segundo</strong></u>, poderíamos calcular a <strong><em>média dos valores do erro quadrático</em></strong>, conhecida como <u><strong><em>erro quadrático médio</em></strong></u> (<u><strong>MSE</strong></u> <u><strong>[Mean Squared Error]</strong></u>).</p>
<p>No entanto, como elevamos os valores ao quadrado antes de calcular a média, eles <strong><em>não estão na mesma escala dos dados originais</em></strong>; estão em centímetros ao quadrado.</p>
<p>Por isso, também <u><strong><em>é comum obter a raiz quadrada do MSE</em></strong></u>, que chamamos de <u><strong><em>raiz do erro quadrático médio</em></strong></u> (<u><strong>RMSE</strong></u> - [<strong><em>Root Mean Squared Error</em></strong>]), de modo que o erro seja calculado <u><strong><em>nas mesmas unidades dos valores originais</em></strong></u> (nesse exemplo, em centímetros).</p>
<p>A <u><strong>média</strong></u> tem <strong><em>erros consideráveis</em></strong> — <em>qualquer ponto individual de dado estará</em>, em <em>média</em>, a cerca de <strong><em>27 cm da média</em></strong> —, porém ainda <strong><em>é melhor que a <u>moda</u></em></strong>, a qual tem <strong><em>um erro quadrático médio</em></strong> de cerca de <strong><em>39 cm</em></strong>.</p>
</section><section id="aprimorando-nosso-modelo" class="level2" data-number="4.4"><h2 data-number="4.4" class="anchored" data-anchor-id="aprimorando-nosso-modelo">
<span class="header-section-number">4.4</span> Aprimorando Nosso Modelo</h2>
<p>Podemos imaginar um modelo melhor?</p>
<p>Lembre que esses dados abrangem todas as crianças na amostra do NHANES, com idades entre 2 e 17 anos [filtro foi variável <code>age</code> &lt; 18].</p>
<p>Dada essa <em>ampla faixa etária</em>, poderíamos <strong><em>esperar</em></strong> que nosso <u><strong><em>modelo</em></strong></u> <strong><em>de <u>altura</u> também considerasse a idade</em></strong> [<code>age</code>, e <em>não apenas</em> a <u><em>média</em></u> ou <u><em>moda</em></u> do <em>conjunto de dados de alturas das crianças e adolescentes</em>].</p>
<p><strong><em>Plotaremos os dados de altura em relação à idade</em></strong> para <strong><em>verificar se</em></strong> essa <u><strong><em>relação realmente existe</em></strong></u>.</p>
<p>No painel A da Figura 5.3, os <em>pontos demonstram pessoas no conjunto de dados</em>, e, como seria <strong><em>de esperar</em></strong>, aparentemente existe <strong><em>uma forte relação entre altura e idade</em></strong>.</p>
<p>Desse modo, podemos <strong><em>criar um modelo que relacione as duas</em></strong>:</p>
<p><span class="math display">\[
\hat{y}_i = \hat{\beta} \times idade_i
\]</span></p>
<p>em que <span class="math inline">\(\hat{\beta}\)</span> é a nossa <u><strong><em>estimativa</em></strong></u> do <u><strong><em>parâmetro</em></strong></u>, que multiplicamos pela <code>idade</code> a fim de gerar a <u><strong><em>predição</em></strong></u> do modelo.</p>
<p>Talvez você se recorde de que, em álgebra, <strong><em>uma linha é definida</em></strong> da seguinte <u><strong><em>forma</em></strong></u>:</p>
<p><span class="math display">\[
y = inclinação \times x + intercepto
\]</span></p>
<p>Se a <strong><em>idade</em></strong> for a variável <code>x</code>, significa que nossa <strong><em>predição de altura</em></strong> a <em>partir da idade</em> será <em>uma <u><strong>linha</strong></u></em> [uma <strong>reta</strong>] <em>com</em> <u><strong><em>inclinação</em></strong></u> β e <u><strong><em>intercepto</em></strong></u> 0 [zero].</p>
<p>Para visualizar isso, plotaremos a linha [a reta] com o ajuste mais adequado no topo dos dados (painel B da Figura 5.3).</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># compute and print RMSE for mean and mode</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>rmse_mean <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(error_mean<span class="sc">**</span><span class="dv">2</span>))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># from https://www.tutorialspoint.com/r/r_mean_median_mode.htm</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>getmode <span class="ot">&lt;-</span> <span class="cf">function</span>(v) {</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>   uniqv <span class="ot">&lt;-</span> <span class="fu">unique</span>(v)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>   uniqv[<span class="fu">which.max</span>(<span class="fu">tabulate</span>(<span class="fu">match</span>(v, uniqv)))]</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>error_mode <span class="ot">&lt;-</span> NHANES_child<span class="sc">$</span>Height <span class="sc">-</span> <span class="fu">getmode</span>(NHANES_child<span class="sc">$</span>Height)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>rmse_mode  <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(error_mode<span class="sc">**</span><span class="dv">2</span>))</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> NHANES_child <span class="sc">%&gt;%</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Age, <span class="at">y =</span> Height)) <span class="sc">+</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">"jitter"</span>,<span class="at">size=</span><span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq.int</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'A: original data'</span>)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>lmResultHeightOnly <span class="ot">&lt;-</span> <span class="fu">lm</span>(Height <span class="sc">~</span> Age <span class="sc">+</span> <span class="dv">0</span>, <span class="at">data=</span>NHANES_child)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>rmse_heightOnly    <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(lmResultHeightOnly<span class="sc">$</span>residuals<span class="sc">**</span><span class="dv">2</span>))</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> NHANES_child <span class="sc">%&gt;%</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Age, <span class="at">y =</span> Height)) <span class="sc">+</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">"jitter"</span>,<span class="at">size=</span><span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq.int</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">'segment'</span>,<span class="at">x=</span><span class="dv">0</span>,<span class="at">xend=</span><span class="fu">max</span>(NHANES_child<span class="sc">$</span>Age),</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">y=</span><span class="dv">0</span>,<span class="at">yend=</span><span class="fu">max</span>(lmResultHeightOnly<span class="sc">$</span>fitted.values),</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">color=</span><span class="st">'blue'</span>,<span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'B: age'</span>)</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> NHANES_child <span class="sc">%&gt;%</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Age, <span class="at">y =</span> Height)) <span class="sc">+</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">"jitter"</span>,<span class="at">size=</span><span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq.int</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>,<span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'C: age + constant'</span>)</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> NHANES_child <span class="sc">%&gt;%</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Age, <span class="at">y =</span> Height)) <span class="sc">+</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="fu">factor</span>(Gender)),</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="st">"jitter"</span>,</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.8</span>,</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>             <span class="at">size=</span><span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>,<span class="fu">aes</span>(<span class="at">group =</span> <span class="fu">factor</span>(Gender),</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colour =</span> <span class="fu">factor</span>(Gender))) <span class="sc">+</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'D: age + constant + gender'</span>)</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando a nota de rodapé como grob com tamanho de fonte personalizado</span></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>nota_rodape <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Altura [Height] das crianças no NHANES, plotadas sem um modelo (A, Original data [Dados originais]); com um modelo linear incluindo apenas</span><span class="sc">\n</span><span class="st">idade (B, Age [Idade]) ou incluindo idade e uma constante (C, Age + constant [Idade + constante]) e com um modelo linear que ajusta efeitos</span><span class="sc">\n</span><span class="st">diferentes de idade para homens e mulheres (D, Age + constant + gender [Idade + constante + gênero]). Fonte: Poldrack, 2025, p. 46, fig. 5.3"</span>,</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">8</span>,</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="st">"italic"</span>),</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fl">0.5</span>,</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">hjust =</span> <span class="fl">0.5</span></span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Usando grid.arrange com a nota de rodapé customizada</span></span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a><span class="co"># usando grid.arrange() (do pacote gridExtra), pode usar o argumento bottom:</span></span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a><span class="co"># para gerar um nota de rodapé ´no gráfico final</span></span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(</span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>  p1, p2, p3, p4,</span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>  <span class="at">bottom =</span> nota_rodape</span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap5-pldr-modelos-dados_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Algo claramente está errado com esse <strong>segundo modelo [B]</strong>, pois a <em>linha não parece seguir os dados muito bem</em>.</p>
<p>Na verdade, sua <strong>RMSE</strong> (39,16 cm) é bem <strong><em>maior</em></strong> do que a do <strong><em>modelo que inclui apenas a média</em></strong>!</p>
<p>O problema surge do fato de <strong>B</strong> considerar <strong><em>somente</em></strong> a <code>idade</code>, significando que o <strong><em>valor predito</em></strong> de <code>altura</code> <span class="math inline">\([\hat{y}_i]\)</span> a partir dele deve <strong><em>assumir</em></strong> um valor de <strong>0</strong> [zero] quando a <code>idade</code> for <strong>0</strong> [zero].</p>
<p>Ainda que os dados não incluam crianças com idade 0, matematicamente, exige-se que a linha tenha um valor y de 0 quando x é 0, o que explica por que a ela é forçada para baixo dos pontos de dados que representam pessoas mais jovens.</p>
<p>Podemos <strong><em>corrigir</em></strong> isso <strong><em>incluindo um intercepto</em></strong> em <strong><em>nosso modelo</em></strong>, que basicamente <strong><em>representa</em></strong> a <code>altura</code> <strong><em>estimada</em></strong> <span class="math inline">\([\hat{y}_i]\)</span> quando a <code>idade</code> é igual a 0; <em>embora</em>, <em>nesse conjunto de dados</em>, <em>uma idade de 0 não seja plausível</em>, é <em>uma estratégia matemática</em> que permite ao <em>modelo considerar a magnitude geral dos dados</em>. Assim:</p>
<p><span class="math display">\[
\hat{y}_i = \hat{\beta_0} + \hat{\beta_1} \times idade_i
\]</span></p>
<p>Em que <span class="math inline">\(\hat{\beta_0}\)</span> é nossa <strong><em>estimativa</em></strong> para o <strong><em>intercepto</em></strong>, <em>um valor constante adicionado à predição para cada indivíduo</em>; chamamos isso de intercepto, pois ele mapeia o intercepto na equação para uma linha reta.</p>
<p>Posteriormente, aprenderemos como estimamos esses valores de parâmetros para um conjunto de dados específico; por ora, <strong><em>usaremos nosso software estatístico para estimar os valores dos parâmetros que nos fornecem o menor erro para esses dados específicos</em></strong>.</p>
<p>Na Figura 5.3, o painel <strong>C</strong> mostra <strong><em>esse</em></strong> <strong><em>modelo aplicado aos dados do NHANES</em></strong>.</p>
<p>Vemos que a <strong><em>linha se ajusta melhor aos dados do que a anterior</em></strong>, <em>sem uma constante</em>.</p>
<p>Nosso <strong><em>erro</em></strong> é <strong><em>bem menor com esse novo modelo</em></strong> — apenas <strong>8,36 cm</strong> em média [<strong>RMSE</strong>].</p>
<p>Consegue <u><strong><em>pensar em outras variáveis</em></strong></u> [<strong>ocultas</strong>] que também possam estar <strong><em>relacionadas</em></strong> à <code>altura</code>?</p>
<p>Que tal o gênero? No painel <strong>D</strong> da Figura 5.3, plotamos os <strong><em>dados com linhas ajustadas separadamente para homens e mulheres</em></strong>.</p>
<p>A partir do gráfico, parece haver <strong><em>uma diferença entre meninos e meninas</em></strong>, mesmo que <em>relativamente pequena</em> e <strong><em>só presente após a puberdade</em></strong>.</p>
<p>Na Figura 5.4, plotamos os <strong><em>valores</em></strong> da <u><strong><em>raiz do erro quadrático médio</em></strong></u> [<u><strong>RMSE</strong></u>] para os <strong>diferentes modelos</strong>, <em>incluindo um com um parâmetro adicional que modela o efeito de gênero</em>.</p>
<p>A partir disso, observamos que o <strong><em>modelo melhorou um pouco</em></strong> ao <strong><em>passar</em></strong> da <u><strong>moda</strong></u> <strong><em>para</em></strong> <u><strong>média</strong></u>; <strong><em>muito</em></strong> ao <strong><em>somar</em></strong> a <code>idade</code> <strong><em>à</em></strong> <u><strong>média</strong></u> e <strong><em>ligeiramente</em></strong> ao <strong><em>incluir</em></strong> o <code>gênero</code>.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># find the best fitting model to predict height given age</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>model_age <span class="ot">&lt;-</span> <span class="fu">lm</span>(Height <span class="sc">~</span> Age, <span class="at">data =</span> NHANES_child)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># the add_predictions() function uses the fitted model to add the predicted values for each person to our dataset</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>NHANES_child <span class="ot">&lt;-</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  NHANES_child <span class="sc">%&gt;%</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_age, <span class="at">var =</span> <span class="st">"predicted_age"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">error_age =</span> Height <span class="sc">-</span> predicted_age <span class="co">#calculate each individual's difference from the predicted value</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>rmse_age <span class="ot">&lt;-</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  NHANES_child <span class="sc">%&gt;%</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sqrt</span>(<span class="fu">mean</span>((error_age)<span class="sc">**</span><span class="dv">2</span>)) <span class="co">#calculate the root mean squared error</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>()</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co"># compute model fit for modeling with age and gender</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>model_age_gender <span class="ot">&lt;-</span> <span class="fu">lm</span>(Height <span class="sc">~</span> Age <span class="sc">+</span> Gender, <span class="at">data =</span> NHANES_child)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>rmse_age_gender <span class="ot">&lt;-</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  NHANES_child <span class="sc">%&gt;%</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_age_gender, <span class="at">var =</span> <span class="st">"predicted_age_gender"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sqrt</span>(<span class="fu">mean</span>((Height <span class="sc">-</span> predicted_age_gender)<span class="sc">**</span><span class="dv">2</span>))</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>()</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>error_df <span class="ot">&lt;-</span> <span class="co">#build a dataframe using the function tribble()</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tribble</span>(</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span>model, <span class="sc">~</span>error,</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mode"</span>, rmse_mode,</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mean"</span>, rmse_mean,</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">"constant + age"</span>, rmse_age,</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">"constant + age + gender"</span>, rmse_age_gender</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMSE =</span> error</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>error_df <span class="sc">%&gt;%</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> model, <span class="at">y =</span> RMSE)) <span class="sc">+</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"mode"</span>, <span class="st">"mean"</span>, <span class="st">"constant + age"</span>, <span class="st">"constant + age + gender"</span>)) <span class="sc">+</span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"root mean squared error [RMSE]"</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">title    =</span> <span class="st">"Gráfico de Barras: altura [Height] 1691 crianças no NHANES"</span>,</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">"filtro: idade (age) &lt; 18 anos"</span>,</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption  =</span> <span class="st">"Raiz do Erro Quadrático Médio [Root Mean Squared Error - RMSE] plotado para cada um dos</span><span class="sc">\n</span><span class="st">modelos testados anteriormente. Aqui, temos: Constante + idade + gênero [Constant + age + gender],</span><span class="sc">\n</span><span class="st">Constante + idade [Constant + age], Média [Mean] e Moda [Mode]. Fonte: Poldrack, 2025, p. 47, fig. 5.4"</span>,</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"Modelos p/predizer Altura (Height)"</span>,</span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">"Root Mean Squared Error [RMSE, cm]"</span></span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap5-pldr-modelos-dados_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="quais-são-os-critérios-para-um-bom-modelo" class="level2" data-number="4.5"><h2 data-number="4.5" class="anchored" data-anchor-id="quais-são-os-critérios-para-um-bom-modelo">
<span class="header-section-number">4.5</span> Quais São os Critérios para um “Bom” Modelo?</h2>
<p>Via de regra, <strong><em>queremos duas coisas</em></strong> do nosso <u><strong>modelo estatístico</strong></u>.</p>
<p><u><strong>Primeiro</strong></u>, queremos que ele <strong><em>descreva bem os nossos dados</em></strong>; ou seja, que tenha o <strong><em>menor erro possível</em></strong> ao modelar nossos dados.</p>
<p><u><strong>Segundo</strong></u>, queremos que generalize com eficácia em conjuntos novos de dados; ou seja, <strong><em>esperamos</em></strong> o <strong><em>menor número possível de erros</em></strong> quando formos <strong><em>aplicá-lo</em></strong> a <u><strong><em>um conjunto novo de dados</em></strong></u> para <strong><em>realizar</em></strong> uma <u><strong>predição</strong></u>.</p>
<p>Acontece que esses dois aspectos podem entrar em conflito.</p>
<p>Para entender isso, antes de mais nada, é necessário analisarmos qual é a <strong><em>origem</em></strong> do <strong><em>erro</em></strong> [<strong><em>resíduo</em></strong>].</p>
<p><u><strong><em>Primeiro</em></strong></u>, ele pode ocorrer <strong><em>se nosso modelo estiver errado</em></strong>; por exemplo, <em>se dissermos, inadequadamente</em>, que a <code>altura</code> <em>diminui com a idade em vez de aumentar</em>, nosso <em>erro</em> será <em>maior</em> do que seria para o <em>modelo correto</em>. [Erro percepsional]</p>
<p>Do mesmo modo, <em>se estiver faltando um fator importante em nosso modelo</em>, isso também <em>aumentará nosso erro</em> (como aconteceu quando <em>desconsideramos</em> a <code>idade</code> do <em>modelo</em> de <code>altura</code>).</p>
<p>No entanto, o <strong><em>erro</em></strong> também <strong><em>pode ocorrer mesmo quando o modelo está correto</em></strong>, devido à <strong><em>variação aleatória nos dados</em></strong>, o qual geralmente chamamos de <u><strong>erro de medição</strong></u> ou de <u><strong>ruído</strong></u>. [Erro Amostral]</p>
<p>Às vezes, isso se deve a um <em>erro em nossas medições</em> — por exemplo, quando elas <em>dependem de um humano</em> [Erro do <em>instrumentador</em>], como usar um cronômetro [Erro ou limite de <em>precisão</em> intrínseco do <em>instrumento</em>] para medir o tempo decorrido em uma corrida de rua.</p>
<p>Em outros casos, nosso <strong><em>dispositivo de medição</em></strong> tem <strong><em>alta acurácia</em></strong> (como <em>uma balança digital</em> para medir o <em>peso corporal</em>), <strong><em>mas o que está sendo medido é afetado por muitos fatores diferentes</em></strong> que <strong><em>o tornam variável</em></strong>.</p>
<p><em>Se conhecêssemos todos esses fatores</em>, poderíamos <em>criar um modelo</em> com <em>maior acurácia</em> [<em>menor RMSE</em>], mas, na <em>prática</em>, isso <em>raramente é possível</em>.</p>
<p>Usaremos <em>um exemplo para ilustrar</em> o caso.</p>
<p>Em vez de usar dados reais, <em>geraremos alguns dados com uma <strong>simulação</strong></em> de computador (no Capítulo 8, falaremos mais a respeito desse assunto).</p>
<p>Suponha que queremos <em>entender</em> a <em>relação</em> entre o <strong><em>teor de álcool no sangue</em></strong> (<code>TAS</code>) de uma pessoa e seu <strong><em>tempo de reação</em></strong> em <em>um teste computadorizado de <strong>condução</strong></em>.</p>
<p>Podemos <strong><em>gerar alguns dados simulados</em></strong> e <strong><em>plotar</em></strong> a <strong><em>relação</em></strong> (painel <strong>A</strong> da Figura 5.5).</p>
<p>Nesse exemplo, o <code>tempo de reação</code> <em>aumenta de modo sistemático</em> com o <code>teor de álcool no sangue</code> — a linha mostra o <strong><em>modelo com o ajuste mais adequado</em></strong>.</p>
<p>Podemos notar que <strong><em>existem poucos erros</em></strong>, observação <strong><em>evidenciada</em></strong> pelo fato de <strong><em>todos os pontos estarem muito próximos à linha</em></strong>.</p>
<p>Além disso, <em>poderíamos imaginar dados que mostram a mesma relação linear</em>, porém <em>com muito mais erros</em>, como no painel <strong>B</strong> da Figura 5.5.</p>
<p>Aqui, verificamos que ainda <em>existe um aumento sistemático</em> do <code>tempo de reação</code> com o <code>TAS</code>, [<code>BAC</code> - <em>Blood Alcoholic Concentration</em>], porém ele <em>varia muito entre os indivíduos</em>.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>dataDf <span class="ot">&lt;-</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">BAC =</span> <span class="fu">runif</span>(<span class="dv">100</span>) <span class="sc">*</span> <span class="fl">0.3</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ReactionTime =</span> BAC <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>) <span class="sc">*</span> <span class="fl">0.01</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> dataDf <span class="sc">%&gt;%</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> BAC, <span class="at">y =</span> ReactionTime)) <span class="sc">+</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'A: linear, low noise'</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># noisy version</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>dataDf <span class="ot">&lt;-</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">BAC =</span> <span class="fu">runif</span>(<span class="dv">100</span>) <span class="sc">*</span> <span class="fl">0.3</span>,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">ReactionTime =</span> BAC <span class="sc">*</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>) <span class="sc">*</span> <span class="fl">0.2</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> dataDf <span class="sc">%&gt;%</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> BAC, <span class="at">y =</span> ReactionTime)) <span class="sc">+</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'B: linear, high noise'</span>)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="co"># nonlinear (inverted-U) function</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>dataDf <span class="ot">&lt;-</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>  dataDf <span class="sc">%&gt;%</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">caffeineLevel =</span> <span class="fu">runif</span>(<span class="dv">100</span>) <span class="sc">*</span> <span class="dv">10</span>,</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">caffeineLevelInvertedU =</span> (caffeineLevel <span class="sc">-</span> <span class="fu">mean</span>(caffeineLevel))<span class="sc">**</span><span class="dv">2</span>,</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">testPerformance =</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> caffeineLevelInvertedU <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>) <span class="sc">*</span> <span class="fl">0.5</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> dataDf <span class="sc">%&gt;%</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> caffeineLevel, <span class="at">y =</span> testPerformance)) <span class="sc">+</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'C: nonlinear'</span>)</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_grid(p1, p2, p3)</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando a nota de rodapé como grob com tamanho de fonte personalizado</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>nota_rodape <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Relação simulada entre o teor de álcool no sangue [BAC] e o tempo de reação [Reaction time] em um teste de condução [Test performance],</span><span class="sc">\n</span><span class="st">estando o modelo linear mais adequado representado pela linha. (A) Linear, low noise [Linear, ruído baixo]: relação linear com baixo erro de</span><span class="sc">\n</span><span class="st">medição. (B), Linear, high noise [Linear, ruído alto]: relação linear com maior erro de medição. (C), Nonlinear [Não linear]: relação não linear</span><span class="sc">\n</span><span class="st">com baixo erro de medição e modelo linear (incorreto). Fonte: Poldrack, 2025, p. 48, fig. 5.5"</span>,</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">8</span>,</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="st">"italic"</span>),</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fl">0.5</span>,</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">hjust =</span> <span class="fl">0.5</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Usando grid.arrange com a nota de rodapé customizada</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a><span class="co"># usando grid.arrange() (do pacote gridExtra), pode usar o argumento bottom:</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a><span class="co"># para gerar um nota de rodapé ´no gráfico final</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>  p1, p2, p3,</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">bottom =</span> nota_rodape</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap5-pldr-modelos-dados_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ambos [<strong>A e B</strong>] são <strong><em>exemplos</em></strong> em que a <strong><em>relação entre as duas variáveis</em></strong> representadas parece ser <u><strong><em>linear</em></strong></u>, e o <u><strong><em>erro</em></strong></u> retrata <u><strong><em>ruído</em></strong></u> em <u><strong><em>nossa medição</em></strong></u>.</p>
<p>Em contrapartida, existem situações [<strong>C</strong>] em que a <strong><em>relação entre as variáveis <u>não é linear</u></em></strong>, e o <strong><em>erro aumenta</em></strong>, já que o <u><strong><em>modelo não está devidamente especificado</em></strong></u>.</p>
<p>Suponha que estamos interessados na <strong><em>relação</em></strong> entre a <code>ingestão de cafeína</code> e o <code>desempenho em um teste</code>.</p>
<p>A <strong><em>relação</em></strong> entre <em>estimulantes</em> como a <code>cafeína</code> e o <code>desempenho na prova</code> <em>geralmente</em> é <u><strong><em>não linear</em></strong></u> — ou seja, <em>não segue uma linha reta</em>.</p>
<p>Isso ocorre porque <strong><em>ele aumenta com pequenas quantidades</em></strong> de <code>cafeína</code> (à medida que a <em>pessoa fica mais alerta</em>), mas, <strong><em>depois, começa a diminuir com quantidades maiores</em></strong> (à medida que a <em>pessoa fica nervosa</em> e <em>agitada</em>).</p>
<p>É possível <u><strong>simular</strong></u> <em>dados dessa forma</em> e, em seguida, <strong><em>ajustar</em></strong> um <strong><em>modelo linear</em></strong> <em>aos dados</em> (painel <strong>C</strong> da Figura 5.5).</p>
<p>A <u><strong><em>linha reta</em></strong></u> que <u><strong><em>melhor se ajusta</em></strong></u> a <u><strong><em>esses dados</em></strong></u> [Método dos Minímos Quadrados - MMQ ; OMS - <em>Ordinary Minimum Square</em>] claramente <strong><em>retrata</em></strong> um <strong><em>alto grau</em></strong> de <u><strong><em>erro</em></strong></u>.</p>
<p>Ainda que exista uma relação muito consistente entre o <code>desempenho no teste</code> [Test performance] e a <code>ingestão de cafeína</code> [Caffeine level], ela <u><strong><em>segue uma curva</em></strong></u> e <u><strong><em>não uma linha reta</em></strong></u>.</p>
<p>O <u><strong>modelo</strong></u>, que <u><strong>assume</strong></u> uma <u><strong>relação linear</strong></u>, apresenta <u><strong><em>erro elevado</em></strong></u> porque é o <u><strong><em>modelo inadequado</em></strong></u> para esses dados. [Erro percepcional: está no Modelo, mas não está no Mundo real]</p>
</section><section id="um-modelo-pode-ser-demasiadamente-bom" class="level2" data-number="4.6"><h2 data-number="4.6" class="anchored" data-anchor-id="um-modelo-pode-ser-demasiadamente-bom">
<span class="header-section-number">4.6</span> Um Modelo Pode Ser Demasiadamente Bom?</h2>
<p>A impressão que temos é do <u><strong>erro</strong></u> <u><strong><em>como algo ruim</em></strong></u>, e, normalmente, <u><strong><em>preferimos um modelo com menor a outro com maior erro</em></strong></u>.</p>
<p>No entanto, mencionamos anteriormente o <u><strong><em>conflito</em></strong></u> entre a <u><strong><em>capacidade de um modelo se ajustar com acurácia ao conjunto atual de dados</em></strong></u> e sua <u><strong><em>capacidade de generalizar em conjuntos novos de dados</em></strong></u>.</p>
<p>Em geral, acontece que <u><strong><em>aquele com o menor erro é bem pior em generalizar</em></strong></u> em <em>conjuntos novos de dados</em>!</p>
<p>Para visualizar isso, <strong><em>geraremos</em></strong> mais uma vez alguns <strong><em>dados</em></strong> para que <em>possamos saber a verdadeira relação entre as variáveis</em>.</p>
<p>Criaremos <em>dois conjuntos</em> de <strong><em>dados simulados</em></strong>, gerados exatamente da mesma forma: ou seja, a equação para ambos é</p>
<p><span class="math display">\[
y = \beta \times X + \epsilon
\]</span></p>
<p>a <strong><em>única diferença</em></strong> é que <strong><em>um</em></strong> <u><strong><em>ruído aleatório</em></strong></u> <strong><em>diferente</em></strong> foi <strong><em>usado para</em></strong> <span class="math inline">\(\epsilon\)</span>[letra grega <em>epsilon</em> que simboliza o <em>erro</em> ou <em>resíduo</em> ou <em>ruído</em>] <strong><em>em cada caso</em></strong>.</p>
<p>Em seguida, <strong><em>ajustamos dois modelos aos dados</em></strong>: <u><strong><em>um simples</em></strong></u> (com somente dois parâmetros, inclinação e intercepto) e um mais complexo que contém um total de oito parâmetros (inclinação e intercepto com parâmetros de tamanho que retratam polinômios de grau crescente, como X<sup>2</sup>, X<sup>3</sup>, e assim por diante).</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#parameters for simulation</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1122</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>sampleSize <span class="ot">&lt;-</span> <span class="dv">16</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">#build a dataframe of simulated data</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>simData <span class="ot">&lt;-</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">X =</span> <span class="fu">rnorm</span>(sampleSize),</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> X <span class="sc">+</span> <span class="fu">rnorm</span>(sampleSize, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ynew =</span> X <span class="sc">+</span> <span class="fu">rnorm</span>(sampleSize, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co">#fit models to these data</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>simpleModel <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> simData)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>complexModel <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> <span class="fu">poly</span>(X, <span class="dv">8</span>), <span class="at">data =</span> simData)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate root mean squared error for "current" dataset</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>rmse_simple <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(simpleModel<span class="sc">$</span>residuals<span class="sc">**</span><span class="dv">2</span>))</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>rmse_complex <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(complexModel<span class="sc">$</span>residuals<span class="sc">**</span><span class="dv">2</span>))</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate root mean squared error for "new" dataset</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>rmse_prediction_simple <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((simpleModel<span class="sc">$</span>fitted.values <span class="sc">-</span> simData<span class="sc">$</span>Ynew)<span class="sc">**</span><span class="dv">2</span>))</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>rmse_prediction_complex <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((complexModel<span class="sc">$</span>fitted.values <span class="sc">-</span> simData<span class="sc">$</span>Ynew)<span class="sc">**</span><span class="dv">2</span>))</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="co">#visualize</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>plot_original_data <span class="ot">&lt;-</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>  simData <span class="sc">%&gt;%</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(X, Y)) <span class="sc">+</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">8</span>),</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">FALSE</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">FALSE</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">"text"</span>,</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">-</span><span class="fl">1.25</span>,</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fl">2.5</span>,</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"RMSE=%0.1f"</span>, rmse_simple),</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="dv">0</span>,</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex =</span> <span class="dv">4</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">"text"</span>,</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">-</span><span class="fl">1.25</span>,</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="dv">2</span>,</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"RMSE=%0.1f"</span>, rmse_complex),</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="dv">0</span>,</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex =</span> <span class="dv">4</span></span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"original data"</span>)</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>plot_new_data  <span class="ot">&lt;-</span></span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>  simData <span class="sc">%&gt;%</span></span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(X, Ynew)) <span class="sc">+</span></span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(X, Y),</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">8</span>),</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">FALSE</span></span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(X, Y),</span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">FALSE</span></span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>    <span class="st">"text"</span>,</span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">-</span><span class="fl">1.25</span>,</span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fl">2.5</span>,</span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"RMSE=%0.1f"</span>, rmse_prediction_simple),</span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="dv">0</span>,</span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex =</span> <span class="dv">4</span></span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a>    <span class="st">"text"</span>,</span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">-</span><span class="fl">1.25</span>,</span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="dv">2</span>,</span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"RMSE=%0.1f"</span>, rmse_prediction_complex),</span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="dv">0</span>,</span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex =</span> <span class="dv">4</span></span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"new data"</span>)</span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_grid(plot_original_data, plot_new_data)</span></span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando a nota de rodapé como grob com tamanho de fonte personalizado</span></span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a>nota_rodape <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(</span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Um exemplo de sobreajuste. Ambos os conjuntos de dados foram gerados com o mesmo modelo, com diferentes ruídos aleatórios</span><span class="sc">\n</span><span class="st">adicionados para gerar cada conjunto. O painel A (Original data [Dados originais]) mostra os dados usados para ajustar o modelo, com um</span><span class="sc">\n</span><span class="st">ajuste linear simples (linha reta) e um ajuste polinomial complexo de oitavo grau (linha curva). Os valores da raiz do erro quadrático médio</span><span class="sc">\n</span><span class="st">(RMSE) para cada modelo são mostrados na figura; nesse caso, o complexo tem uma RMSE menor do que o simples. O painel B (New</span><span class="sc">\n</span><span class="st">data [Dados novos]) mostra o segundo conjunto de dados, considerando o mesmo modelo sobreposto e os valores RMSE calculados com</span><span class="sc">\n</span><span class="st">o modelo obtido a partir do primeiro conjunto de dados. Aqui, vemos que o mais simples se ajusta melhor ao conjunto novo de dados</span><span class="sc">\n</span><span class="st">do que o mais complexo, que foi sobreajustado ao primeiro conjunto de dados. Fonte: Poldrack, 2025, p. 49, fig. 5.6"</span>,</span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a>  <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">8</span>,</span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="st">"italic"</span>),</span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fl">0.5</span>,</span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true" tabindex="-1"></a>  <span class="at">hjust =</span> <span class="fl">0.5</span></span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true" tabindex="-1"></a><span class="co"># Usando grid.arrange com a nota de rodapé customizada</span></span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true" tabindex="-1"></a><span class="co"># usando grid.arrange() (do pacote gridExtra), pode usar o argumento bottom:</span></span>
<span id="cb11-115"><a href="#cb11-115" aria-hidden="true" tabindex="-1"></a><span class="co"># para gerar um nota de rodapé ´no gráfico final</span></span>
<span id="cb11-116"><a href="#cb11-116" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(</span>
<span id="cb11-117"><a href="#cb11-117" aria-hidden="true" tabindex="-1"></a>  plot_original_data, plot_new_data,</span>
<span id="cb11-118"><a href="#cb11-118" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb11-119"><a href="#cb11-119" aria-hidden="true" tabindex="-1"></a>  <span class="at">bottom =</span> nota_rodape</span>
<span id="cb11-120"><a href="#cb11-120" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-121"><a href="#cb11-121" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap5-pldr-modelos-dados_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Na Figura 5.6, o painel <strong>A</strong> mostra que o <strong><em>modelo mais complexo (não linear) se ajusta melhor aos dados do que o mais simples (linear)</em></strong>.</p>
<p>No entanto, vemos o <strong><em>contrário quando o mesmo modelo é aplicado a um conjunto novo de dados gerados da mesma forma</em></strong> (painel <strong>B</strong>).</p>
<p>Aqui, o <u><strong><em>mais simples se ajusta melhor aos dados novos do que o mais complexo</em></strong></u>.</p>
<p>Por <em>intuição</em>, podemos <strong><em>observar que o modelo mais complexo é extremamente influenciado pelos pontos de dados específicos do primeiro conjunto de dados</em></strong>; como a <em>posição exata desses pontos</em> de dados foi <em>determinada por ruído aleatório</em>, isso <em>leva o modelo mais complexo a se ajustar indevidamente ao conjunto novo de dados</em>.</p>
<p>Chamamos esse fenômeno de <u><strong><em>sobreajuste</em></strong></u> [<u><strong><em>overfitting</em></strong></u>].</p>
<p>Por enquanto, é importante não esquecer que o <strong><em>ajuste do nosso modelo precisa ser bom, não demasiadamente bom</em></strong>.</p>
<p>Como disse Albert <strong>Einstein</strong> (<strong><em>1934</em></strong>): “Dificilmente se pode negar que o <strong><em>objetivo supremo de toda teoria é tornar os elementos básicos irredutíveis tão simples e tão poucos quanto possível sem ter que renunciar à representação adequada de um único dado da experiência</em></strong>”.</p>
<p>Em geral, isso é <strong><em>parafraseado</em></strong> como <u><strong>“tudo deve ser o mais simples possível, mas não demasiadamente simples”</strong></u>.</p>
</section><section id="sumarização-de-dados-usando-a-média" class="level2" data-number="4.7"><h2 data-number="4.7" class="anchored" data-anchor-id="sumarização-de-dados-usando-a-média">
<span class="header-section-number">4.7</span> Sumarização de Dados Usando a Média</h2>
<p>Já falamos sobre a média (ou valor médio) anteriormente, e, de fato, a maioria das pessoas a conhece, mesmo que nunca tenham feito um curso de estatística.</p>
<p>Ela é comumente usada para descrever o que chamamos de tendência central de um conjunto de dados — ou seja, em torno de qual valor os dados estão centralizados?</p>
<p>A maioria das pessoas não pensa em calcular a média como um meio para ajustar um modelo aos dados.</p>
<p>No entanto, é exatamente isso que estamos fazendo quando a calculamos.</p>
<p>Já vimos a fórmula para calcular a média de uma amostra de dados:</p>
<p><span class="math display">\[
\bar{X} = \frac{\sum_{i=1}^{n} x_i}{n}
\]</span></p>
<p>É importante ressaltar que essa fórmula <u><strong><em>é específica para uma amostra de dados</em></strong></u>, um conjunto de pontos de dados selecionados a partir de uma população maior.</p>
<p>Com uma amostra, desejamos caracterizar uma população maior — o conjunto completo de indivíduos em que estamos interessados. [<strong><em>Inferência</em></strong>]</p>
<p>Por exemplo, se fôssemos analistas de pesquisas eleitorais, nossa população de interesse poderia ser todos os eleitores registrados<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, ao passo que nossa amostra pode incluir apenas algumas milhares de pessoas dessa população.</p>
<p>No Capítulo 7, falaremos com mais detalhes sobre amostragem, mas, por ora, vale ressaltar que os estatísticos geralmente gostam de <strong><em>usar símbolos distintos</em></strong> a fim de <strong><em>diferenciar</em></strong> os cálculos estatísticos que descrevem <strong><em>valores para uma amostra</em></strong> a partir de <strong><em>parâmetros</em></strong> que descrevem os [verdadeiros e desconhecidos] <strong><em>valores</em></strong> lógicos para <strong><em>uma população</em></strong>; nesse caso, a fórmula para a <u><strong><em>média da população</em></strong></u> (denotada como μ) é: [N maiúscula denota o tamanho da população]</p>
<p><span class="math display">\[
\mu = \frac{\sum_{i=1}^{N} x_i}{N}
\]</span></p>
<p>Em que N é o tamanho de toda a população.</p>
<p>Nesse caso, os cálculos matemáticos são exatamente os mesmos para a amostra e para a população; apenas os símbolos diferem.</p>
<p>Mais tarde, veremos casos em que os cálculos matemáticos são diferentes, dependendo se estamos calculando um parâmetro da população ou uma estatística amostral.</p>
<p>Já vimos que a <strong><em>média é o <u>estimador</u></em></strong> que <strong><em>garante um erro médio de 0</em></strong>. [<strong><em>MSE</em></strong>]</p>
<p>No entanto, também aprendemos que o <strong><em>erro médio não é o melhor critério</em></strong>; queremos, na verdade, <u><strong><em>um estimador</em></strong></u> que nos forneça <u><strong><em>a menor soma dos erros quadráticos</em></strong></u> (<strong><em>SSE</em></strong>), o que a média também faz.</p>
<p>Isso poderia ser provado usando cálculo, mas demonstraremos graficamente na Figura 5.7.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>df_error <span class="ot">&lt;-</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">val =</span> <span class="fu">seq</span>(<span class="dv">100</span>, <span class="dv">175</span>, <span class="fl">0.05</span>),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sse =</span> <span class="cn">NA</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(df_error)[<span class="dv">1</span>]) {</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  err <span class="ot">&lt;-</span> NHANES_child<span class="sc">$</span>Height <span class="sc">-</span> df_error<span class="sc">$</span>val[i]</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  df_error<span class="sc">$</span>sse[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(err<span class="sc">**</span><span class="dv">2</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>df_error <span class="sc">%&gt;%</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(val, sse)) <span class="sc">+</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(NHANES_child<span class="sc">$</span>Height), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"text"</span>,</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">mean</span>(NHANES_child<span class="sc">$</span>Height) <span class="sc">+</span> <span class="dv">8</span>,</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">max</span>(df_error<span class="sc">$</span>sse),</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"mean"</span>,</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">title    =</span> <span class="st">"Gráfico com parábola (SSE): média [reta vertical]"</span>,</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">"SSE: Sum of Squared Error (Soma dos Erros Quadráticos - SEQ)"</span>,</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption  =</span> <span class="st">"Uma demonstração de como a média é a medida estatística que minimiza a soma dos erros quadráticos</span><span class="sc">\n</span><span class="st">[Sum of squared errors]. Usando os dados de altura infantil do NHANES, calculamos a média (denotada</span><span class="sc">\n</span><span class="st">pela linha vertical, Mean [Média]). Em seguida, testamos um intervalo de possíveis estimativas de</span><span class="sc">\n</span><span class="st">parâmetros e, para cada um, calculamos a soma dos erros quadráticos para cada ponto de dados desse</span><span class="sc">\n</span><span class="st">valor, que são indicados pela curva. Observamos que a média se situa no ponto mínimo</span><span class="sc">\n</span><span class="st">do gráfico de erro quadrático. Fonte: Poldrack, 2025, p. 51, fig. 5.7"</span>,</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"Test value"</span>,</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">"Sum of Squared Error [SSE]"</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap5-pldr-modelos-dados_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Como a minimização da SSE é uma boa <em>feature</em> [característica desejada], a <u><strong>média</strong></u> é <strong><em>a medida estatística mais utilizada para sumarizar os dados</em></strong>.</p>
<p>No entanto, ela também <strong><em>tem um lado sombrio</em></strong>.</p>
<p>Suponha que cinco pessoas estejam em um bar e que examinaremos a renda de cada uma delas (Tabela 5.1).</p>
<p>A média (US$61.600,00) parece ser uma boa sumarização da renda das cinco.</p>
<p>Agora, analisaremos o que acontece se Beyoncé Knowles entrar no bar (Tabela 5.2).</p>
<p>A média agora é de quase US$10 milhões, o que não é representativo de nenhuma das pessoas do bar — em particular, <strong>é extremamente influenciada pelo <em>outlier</em> de Beyoncé</strong>, que <em>foge, e muito, da média</em>.</p>
<p>De modo geral, <strong><em>essa medida estatística é altamente sensível a valores extremos</em></strong>, por isso é sempre <u><strong><em>importante garantir que não haja valores extremos ao usá-la para sumarizar os dados</em></strong></u>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="fig/Poldrack-tab-5.2-renda-5-pessoas-bar-com-Beyonce.png" class="img-fluid figure-img"></p>
<figcaption>Renda de cinco clientes do bar sem e com renda da Beyoncé</figcaption></figure>
</div>
</section><section id="sumarização-robusta-de-dados-usando-a-mediana" class="level2" data-number="4.8"><h2 data-number="4.8" class="anchored" data-anchor-id="sumarização-robusta-de-dados-usando-a-mediana">
<span class="header-section-number">4.8</span> Sumarização Robusta de Dados Usando a Mediana</h2>
<p>Se quisermos <strong>sumarizar</strong> os dados de uma forma <strong>menos sensível a <em>outliers</em></strong>, podemos usar outra medida estatística chamada <u><strong><em>mediana</em></strong></u>.</p>
<p>Se <strong><em>ordenarmos todos os valores por ordem de magnitude</em></strong>, a <u><strong><em>mediana é o valor que fica no meio</em></strong></u>.</p>
<p>Caso exista <strong><em>um número par</em></strong> de valores, existirão dois valores coincidentes para a posição do meio.</p>
<p>Nesse caso, usamos a <strong><em>média (ou seja, o ponto intermediário) desses dois números</em></strong>.</p>
<p>Vejamos um exemplo. Suponha que queremos sumarizar os seguintes valores:</p>
<p>8 6 3 14 12 7 6 4 9</p>
<p>Se os ordenarmos assim:</p>
<p>3 4 6 6 7 8 9 12 14</p>
<p>A <u><strong><em>mediana é o valor do meio</em></strong></u> — neste caso, o <em>quinto dos nove valores</em>.</p>
<p>Considerando que a <u><strong><em>média minimiza a soma dos erros quadráticos</em></strong></u>, a <u><strong><em>mediana minimiza</em></strong></u> uma <em>quantidade ligeiramente diferente</em>: a <u><strong><em>soma do valor absoluto dos erros</em></strong></u>.</p>
<p>Isso explica por que <strong>é menos sensível a <em>outliers</em></strong> — <em>elevar ao quadrado potencializa o efeito de grandes erros</em> em <em>comparação</em> ao <em>uso</em> do <em>valor absoluto</em>.</p>
<p>É possível observar isso no exemplo da renda: a renda mediana (US$65.000) é mais representativa do grupo como um todo do que a média (US$9.051.333) e menos sensível a um único <em>outlier</em> maior.</p>
<p><strong>Sendo assim, por que usaríamos a média?</strong></p>
<p>Conforme analisaremos em um próximo capítulo, <strong><em>ela é o “melhor” estimador no sentido de que varia menos de amostra para amostra</em></strong>, em <em>comparação</em> a <strong><em>outros estimadores</em></strong>.</p>
<p>Cabe a <strong>nós decidir se a sensibilidade a potenciais <em>outliers</em></strong> vale a pena — afinal de contas, a estatística tem tudo a ver com <em>trade-offs</em>. [trocas que caracterizam dilemas de escolha: melhorar um atributo piora outro e vice-vsera]</p>
</section><section id="a-moda" class="level2" data-number="4.9"><h2 data-number="4.9" class="anchored" data-anchor-id="a-moda">
<span class="header-section-number">4.9</span> A Moda</h2>
<p>Não raro, queremos descrever a tendência central de <strong><em>um conjunto de dados que não é numérico</em></strong>.</p>
<p>Por exemplo, imagine que queremos saber quais modelos de iPhone são mais usados.</p>
<p>Para testar isso, poderíamos perguntar a um grande grupo de usuários desse celular qual modelo cada um tem.</p>
<p>Se calculássemos a média desses valores, poderíamos observar que a média do modelo de iPhone é 9,51, o que <strong><em>claramente não faz sentido</em></strong>, pois esses números não podem ser interpretados como medidas quantitativas.</p>
<p>Neste caso, <strong><em>uma medida de tendência central mais adequada</em></strong> é a <u><strong><em>moda</em></strong></u>, o <u><strong><em>valor mais comum</em></strong></u> no <em>conjunto de dados</em>, conforme vimos anteriormente.</p>
</section><section id="variabilidade-até-que-ponto-a-média-se-ajusta-bem-aos-dados" class="level2" data-number="4.10"><h2 data-number="4.10" class="anchored" data-anchor-id="variabilidade-até-que-ponto-a-média-se-ajusta-bem-aos-dados">
<span class="header-section-number">4.10</span> Variabilidade: Até que Ponto a Média se Ajusta Bem aos Dados?</h2>
<p>Após descrevermos a tendência central dos dados, em geral, <strong><em>também queremos descrever até que ponto eles podem variar</em></strong>.</p>
<p>Às vezes, também chamamos essa descrição de <strong><em>dispersão</em></strong> pelo fato de descrever o quanto os dados estão amplamente dispersos.</p>
<p>Já exploramos a <em>soma dos erros quadráticos</em>, a <em>base para</em> as medidas de variabilidade mais utilizadas: a <strong><em>variância</em></strong> e o <strong><em>desvio-padrão</em></strong>.</p>
<p>A <u><strong><em>variância</em></strong></u> para <u><strong><em>uma população</em></strong></u> (referenciada como σ<sup>2</sup>) é simplesmente a <strong><em>soma dos erros quadráticos</em></strong> <strong>[SSE] <em>dividida pelo número de observações</em></strong> — ou seja, é exatamente <u><strong><em>o mesmo que o erro quadrático médio</em></strong></u> que já vimos:</p>
<p><span class="math display">\[
\sigma^2 = \frac{SSE}{N} = \frac{\sum_{i=1}^N (x_i - \mu)^2}{N}
\]</span></p>
<p>Em que μ é a média da população.</p>
<p>O <u><strong>desvio-padrão</strong></u> da população é simplesmente a <strong><em>raiz quadrada disso</em></strong> — ou seja, a <strong><em>raiz do erro quadrático</em></strong> [<strong>RMSE</strong>] que já vimos.</p>
<p>Ele é útil porque <strong><em>apresenta os erros nas mesmas unidades que os dados originais</em></strong> (desfazendo a quadratura que aplicamos aos erros).</p>
<p>Como normalmente não temos acesso a toda a população, temos que calcular a <strong>variância</strong> usando uma amostra, que chamamos de <span class="math inline">\(\hat{\sigma}^2\)</span>, com o “<strong><em>chapéu</em></strong>” representando o <u><strong><em>fato de se tratar de uma estimativa baseada em uma amostra</em></strong></u>.</p>
<p>A equação para <span class="math inline">\(\hat{\sigma}^2\)</span> (às vezes, também chamada de s<sup>2</sup>) é semelhante à de σ<sup>2</sup>: [<strong>variância amostral</strong>]</p>
<p><span class="math display">\[
s^2 = \hat{\sigma}^2 = \frac{\sum_{i=1}^n (x_i - \bar{X})^2}{n-1}
\]</span></p>
<p>A única diferença entre as duas equações é que dividimos por n − 1 a mesma variância em vez de dividir por N a variância da população.</p>
<p>Isso se relaciona com <strong><em>um conceito fundamental de estatística</em></strong>: <u><strong>graus de liberdade</strong></u>.</p>
<p>Lembre que, para calcular a <u><strong>variância amostral</strong></u>, <em>primeiro precisamos estimar</em> a <u><strong><em>média amostral</em></strong></u> <span class="math inline">\(\bar{X}\)</span>.</p>
<p>Ao fazer isso, <em>um valor nos dados não pode mais variar</em>.</p>
<p>Por exemplo, digamos que temos os seguintes pontos de dados para a variável x: [3, 5, 7, 9, 11], cuja média é 7.</p>
<p><em>Como já sabemos que média deste conjunto de dados é 7</em>, <em>podemos calcular o valor específico de qualquer dado ausente</em>.</p>
<p>Por exemplo, <em>suponha que ocultamos o primeiro valor (3)</em>.</p>
<p>Mesmo sem vê-lo, <em>sabemos que seu valor deve ser 3, pois a média de 7 implica que a soma de todos os valores é</em></p>
<p>7 * n = 35 e 35 − (5 + 7 + 9 + 11) = 3.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="fig/Poldrack-tab-5.3-estimativas-variancias-n-versus-n-1.png" class="img-fluid figure-img"></p>
<figcaption>Estimativas de Variância com n versus n-1</figcaption></figure>
</div>
<p>Assim sendo, quando dizemos que <u><strong><em>“perdemos” um grau de liberdade</em></strong></u>, <em>significa</em> que <em>há um valor que não é livre para variar após ajustarmos o modelo</em>.</p>
<p>No contexto da <u><strong>variância amostral</strong></u>, <u><strong>se desconsiderarmos o grau de liberdade perdido</strong></u>, nossa <u><strong>estimativa da variância amostral será enviesada</strong></u>, fazendo com que <u><strong><em>subestimemos a incerteza</em></strong></u> de <u><strong><em>nossa estimativa da média</em></strong></u>.</p>
</section><section id="usando-simulações-para-entender-estatística" class="level2" data-number="4.11"><h2 data-number="4.11" class="anchored" data-anchor-id="usando-simulações-para-entender-estatística">
<span class="header-section-number">4.11</span> Usando Simulações para Entender Estatística</h2>
<p>Sou defensor ferrenho do uso de <u><strong>simulações</strong></u> computacionais <strong><em>para entender conceitos estatísticos</em></strong>.</p>
<p>Nos capítulos posteriores, nós o exploraremos de forma mais aprofundada.</p>
<p>Aqui, apresentamos a ideia <strong><em>questionando se podemos confirmar a necessidade de subtrair 1</em></strong> [do tamanho n] da amostra ao calcular a <u><strong>variância amostral</strong></u>.</p>
<p><strong><em>Consideraremos toda a amostra de crianças do conjunto de dados do NHANES</em></strong> como nossa “<u><strong>população</strong></u>”.</p>
<p>Queremos <strong><em>avaliar</em></strong> a <strong><em>eficiência</em></strong> dos cálculos de <u><strong>variância amostral</strong></u>, <u><strong>usando n ou n − 1 no denominador</strong></u> <u><strong><em>para estimar a variância dessa população</em></strong></u>, considerando <em>um grande número de amostras aleatórias</em> <em>simuladas</em> a <em>partir dos dados</em>.</p>
<p>No Capítulo 8, abordaremos os detalhes de como fazer isso.</p>
<p>Na Tabela 5.3 [acima], os <u><strong><em>resultados mostram que a teoria descrita anteriormente estava correta</em></strong></u>: a <strong><em>estimativa da variância usando n − 1 como denominador é bem próxima da variância calculada em todos os dados</em></strong> (ou seja, <strong><em>a população</em></strong>), enquanto <strong><em>aquela calculada usando n como denominador é enviesada</em></strong> (menor) em comparação ao [<u><strong>verdadeiro e, neste caso, conhecido</strong></u>] <u><strong>valor</strong></u> lógico [do <strong>parâmetro populacional</strong>].</p>
<p>Como analisaremos mais tarde, <u><strong><em>subestimar a variância é bastante complicado porque nos torna excessivamente confiantes</em></strong></u> em relação às nossas <u><strong>decisões estatísticas</strong></u>. [os Testes de Significância da Hipótese Nula; <u><strong>NHST</strong></u> - <em>Null Hypotesis Signifcant Test</em>]</p>
</section><section id="z-scores" class="level2" data-number="4.12"><h2 data-number="4.12" class="anchored" data-anchor-id="z-scores">
<span class="header-section-number">4.12</span> Z-Scores</h2>
<p>Após caracterizar uma distribuição em termos de tendência central e de variabilidade, geralmente é útil expressar os <strong><em>escores individuais em termos de sua posição relativa à distribuição geral</em></strong>.</p>
<p>Suponha que estamos interessados em caracterizar o <strong><em>nível relativo de crimes em diferentes estados</em></strong>, a fim de determinar se a Califórnia é um lugar especialmente perigoso.</p>
<p>Podemos responder a essa pergunta com os dados de 2014 do site <em>Uniform Crime Reporting</em> do <strong>FBI</strong>.</p>
<p>O painel <strong>A</strong> da Figura 5.8 mostra <strong><em>um histograma do número de crimes violentos por estado</em></strong>, destacando o valor da Califórnia.</p>
<p>Observando esses dados, parece que a Califórnia é absurdamente perigosa, com 153.709 crimes em 2014.</p>
<p>Podemos <strong><em>visualizar esses dados gerando um mapa</em></strong>, que mostra a distribuição de uma variável entre os estados, apresentado no painel <strong>B</strong> da Figura 5.8 [abaixo].</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>crimeData <span class="ot">&lt;-</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read.table</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://raw.githubusercontent.com/statsthinking21/statsthinking21-figures-data/main/CrimeOneYearofData_clean.csv"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">","</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># let's drop DC since it is so small</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>crimeData <span class="ot">&lt;-</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  crimeData <span class="sc">%&gt;%</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(State <span class="sc">!=</span> <span class="st">"District of Columbia"</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>caCrimeData <span class="ot">&lt;-</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  crimeData <span class="sc">%&gt;%</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(State <span class="sc">==</span> <span class="st">"California"</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> crimeData <span class="sc">%&gt;%</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Violent.crime.total)) <span class="sc">+</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> caCrimeData<span class="sc">$</span>Violent.crime.total, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Number of violent crimes in 2014"</span>)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mapproj)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fiftystater)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="co"># É necessário instalar antes o pacote devtools</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="co"># retirar o hashtag do início da próxima linha e executar ela só 1 vez</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("devtools")</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Para depois instalar o pacote fiftystater</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Baixando-o do Git Hub:</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="co"># retirar o hashtag do início da próxima linha e executar ela só 1 vez</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_github("wmurphyrd/fiftystater")</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"fifty_states"</span>) <span class="co"># this line is optional due to lazy data loading</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>crimeData <span class="ot">&lt;-</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>  crimeData <span class="sc">%&gt;%</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">StateLower =</span> <span class="fu">tolower</span>(State),</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>         <span class="at">Violent.crime.thousands =</span> Violent.crime.total<span class="sc">/</span><span class="dv">1000</span>)</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a><span class="co"># map_id creates the aesthetic mapping to the state name column in your data</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>plot_map <span class="ot">&lt;-</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(crimeData, <span class="fu">aes</span>(<span class="at">map_id =</span> StateLower)) <span class="sc">+</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># map points to the fifty_states shape data</span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_map</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Violent.crime.thousands), <span class="at">map =</span> fifty_states) <span class="sc">+</span></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">10</span>,         <span class="co"># tamanho da fonte</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">face =</span> <span class="st">"bold"</span>,     <span class="co"># negrito</span></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"blue"</span>,    <span class="co"># cor do texto</span></span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">hjust =</span> <span class="dv">0</span>          <span class="co"># alinhamento horizontal (0 = esquerda, 0.5 = centro, 1 = direita)</span></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position  =</span> <span class="st">"bottom"</span>,</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>()</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_map</span>() <span class="sc">+</span></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> fifty_states<span class="sc">$</span>long, <span class="at">y =</span> fifty_states<span class="sc">$</span>lat) <span class="sc">+</span></span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">""</span></span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">+</span></span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>  <span class="co"># inverter o gradiente de cores para estados com mais crimes violentos</span></span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>  <span class="co"># serem representados pela cor azul mais escura.</span></span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># O oposto pela cor azul mais claro.</span></span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(</span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">low =</span> <span class="st">"lightblue"</span>, <span class="co"># cor para valores baixos</span></span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">high =</span> <span class="st">"darkblue"</span>  <span class="co"># cor para valores altos</span></span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a><span class="co"># add border boxes to AK/HI</span></span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> plot_map <span class="sc">+</span> <span class="fu">fifty_states_inset_boxes</span>()</span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_grid(p1, p2)</span></span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando a nota de rodapé como grob com tamanho de fonte personalizado</span></span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a>nota_rodape <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(</span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a>  <span class="st">"(A) Histograma do número de crimes violentos em 2014 [Number of violent crimes in 2014]. O valor para a Califórnia aparece como</span><span class="sc">\n</span><span class="st">uma linha vertical ao lado direito do gráfico. (B) Um mapa dos mesmos dados, com o número de crimes (em milhares) plotados por estado.</span><span class="sc">\n</span><span class="st">Fonte: Poldrack, 2025, p. 55, fig. 5.8 (apenas com a inversão do gradiente de cores do original)"</span>,</span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">8</span>,</span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="st">"italic"</span>),</span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fl">0.5</span>,</span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a>  <span class="at">hjust =</span> <span class="fl">0.5</span></span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Usando grid.arrange com a nota de rodapé customizada</span></span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a><span class="co"># usando grid.arrange() (do pacote gridExtra), pode usar o argumento bottom:</span></span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a><span class="co"># para gerar um nota de rodapé ´no gráfico final</span></span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(</span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true" tabindex="-1"></a>  p1, p2,</span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true" tabindex="-1"></a>  <span class="at">bottom =</span> nota_rodape</span>
<span id="cb13-94"><a href="#cb13-94" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-95"><a href="#cb13-95" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap5-pldr-modelos-dados_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>No entanto, pode ter lhe ocorrido que a <code>Califórnia</code> também tem <strong><em>a maior população entre os estados dos EUA</em></strong>.</p>
<p>Logo, é <strong><em>plausível que também tenha um número maior de crimes</em></strong>.</p>
<p>Se plotarmos o <strong><em>número de crimes em relação à população de cada estado</em></strong> (painel A da figura 5.9 [abaixo]), <strong><em>veremos uma relação direta entre as duas variáveis</em></strong>.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> crimeData <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Population, Violent.crime.total)) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"point"</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> caCrimeData<span class="sc">$</span>Population,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> caCrimeData<span class="sc">$</span>Violent.crime.total,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"text"</span>,</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> caCrimeData<span class="sc">$</span>Population <span class="sc">-</span> <span class="dv">1000000</span>,</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> caCrimeData<span class="sc">$</span>Violent.crime.total <span class="sc">+</span> <span class="dv">8000</span>,</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"CA"</span>,</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Number of violent crimes in 2014"</span>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> crimeData <span class="sc">%&gt;%</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Violent.Crime.rate)) <span class="sc">+</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">80</span>) <span class="sc">+</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> caCrimeData<span class="sc">$</span>Violent.Crime.rate, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"text"</span>,</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> caCrimeData<span class="sc">$</span>Violent.Crime.rate<span class="sc">+</span><span class="dv">25</span>,</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="dv">12</span>,</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"CA"</span>,</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq.int</span>(<span class="dv">0</span>, <span class="dv">700</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq.int</span>(<span class="dv">0</span>, <span class="dv">13</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Rate of violent crimes per 100,000 people"</span>) <span class="sc">+</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Rate of violent crimes per 100,000 people"</span>) <span class="sc">+</span> <span class="co"># label do eixo x</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>) <span class="co"># tamanho da fonte do título do eixo x</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_grid(p1, p2)</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando a nota de rodapé como grob com tamanho de fonte personalizado</span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>nota_rodape <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>  <span class="st">"(A) Um gráfico com o número de crimes violentos em 2014 [Z-scored rate of violent crimes] e a população [Population] por estado.</span><span class="sc">\n</span><span class="st">(B) Um histograma das taxas de crimes violentos per capita, expressos como crimes a cada 100.000 habitantes [Rate of violent crimes</span><span class="sc">\n</span><span class="st">per 100,000 people]. Fonte: Poldrack, 2025, p. 56, fig. 5.9 (apenas com ajuste do tamanho da fonte do eixo x original)"</span>,</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">8</span>,</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="st">"italic"</span>),</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fl">0.5</span>,</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">hjust =</span> <span class="fl">0.5</span></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Usando grid.arrange com a nota de rodapé customizada</span></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a><span class="co"># usando grid.arrange() (do pacote gridExtra), pode usar o argumento bottom:</span></span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a><span class="co"># para gerar um nota de rodapé ´no gráfico final</span></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(</span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>  p1, p2,</span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">bottom =</span> nota_rodape</span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap5-pldr-modelos-dados_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Em vez de usar o número bruto de crimes, <u><strong>devemos usar a taxa de crimes violentos <em>per capita</em></strong></u>, obtida <strong><em>dividindo</em></strong> o <u><strong><em>número de crimes por estado pela população de cada um</em></strong></u>.</p>
<p>O <em>conjunto de dados do FBI</em> já <em>inclui</em> esse valor (expresso como <em>taxa a cada 100.000 habitantes</em>).</p>
<p>Observando o painel <strong>B</strong> da Figura 5.9 [acima], percebemos que a <strong>Califórnia</strong> <u><strong><em>não é tão perigosa assim</em></strong></u>.</p>
<p>A <strong><em>taxa de criminalidade</em></strong> de <u><strong>396,10 por 100.000 pessoas</strong></u> está <strong><em>um pouco acima da média</em></strong> de <strong>346,81</strong> entre os estados, mas dentro do intervalo de muitos outros.</p>
<p>Mas e <strong><em>se quisermos ter uma visão mais clara da distância da Califórnia em relação ao restante da distribuição?</em></strong></p>
<p>O <u><strong>Z-score</strong></u> nos possibilita expressar os dados, de modo que forneça mais <em>insights</em> sobre a <strong><em>relação de cada ponto de dados com a distribuição geral</em></strong>.</p>
<p>A fórmula que calcula um <u><strong>Z-score</strong></u> para <u><strong><em>um ponto individual de dados</em></strong></u>, considerando a <strong><em>média da população</em></strong> (μ) e o <strong><em>desvio-padrão</em></strong> (σ) <strong><em>conhecidos</em></strong>, é:</p>
<p><span class="math display">\[
Z(x) = \frac{x - \mu}{\sigma}
\]</span></p>
<p>Intuitivamente, podemos considerar o <u><strong>Z-score</strong></u> como <u><strong><em>um indicador da distância</em></strong></u> de <u><strong>qualquer ponto de dados em relação à média</strong></u>, <u><strong>mensurada</strong></u> <u><strong><em>em unidades de desvio-padrão</em></strong></u>.</p>
<p>Podemos <em>calcular esse escore para os dados da taxa de criminalidade</em>, conforme mostrado na Figura 5.10, que <strong>plota os Z-scores</strong> em <strong><em>relação aos escores originais</em></strong>.</p>
<p>A seguir, o <u><strong>gráfico de dispersão mostra que o processo de Z-score não altera a distribuição relativa dos pontos de dados</strong></u> (visível porque os <em>dados originais e os com Z-score ficam em uma linha reta</em> quando plotados comparativamente em um gráfico) — <u><strong>apenas os desloca para ter uma média de 0 e um desvio padrão de 1</strong></u>.</p>
<p>A Figura 5.11 demonstra os <u><strong>dados de crimes com Z-score</strong></u> usando <strong><em>uma representação geográfica</em></strong>.</p>
<p>Ela nos <strong><em>proporciona uma perspectiva</em></strong> um pouco <strong><em>mais interpretável dos dados</em></strong>.</p>
<p>Por exemplo, podemos observar que <code>Nevada</code>, <code>Tennessee</code> e <code>Novo México</code> apresentam <strong><em>taxas de criminalidade que estão aproximadamente dois desvios-padrão acima da média</em></strong>.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># calcuar o Z-Score</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>crimeData <span class="ot">&lt;-</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  crimeData <span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">ViolentCrimeRateZscore =</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>      (Violent.Crime.rate <span class="sc">-</span> <span class="fu">mean</span>(Violent.Crime.rate)) <span class="sc">/</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sd</span>(crimeData<span class="sc">$</span>Violent.Crime.rate)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>caCrimeData <span class="ot">&lt;-</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  crimeData <span class="sc">%&gt;%</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(State <span class="sc">==</span> <span class="st">"California"</span>)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>media_x <span class="ot">&lt;-</span> <span class="fu">mean</span>(crimeData<span class="sc">$</span>Violent.Crime.rate)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>crimeData <span class="sc">%&gt;%</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Violent.Crime.rate, ViolentCrimeRateZscore)) <span class="sc">+</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"point"</span>,</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> caCrimeData<span class="sc">$</span>Violent.Crime.rate,</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> caCrimeData<span class="sc">$</span>ViolentCrimeRateZscore,</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">size  =</span> <span class="dv">3</span>,</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"text"</span>,</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> caCrimeData<span class="sc">$</span>Violent.Crime.rate <span class="sc">-</span> <span class="dv">5</span>,</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> caCrimeData<span class="sc">$</span>ViolentCrimeRateZscore <span class="sc">+</span> <span class="fl">0.30</span>,</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"CA"</span>,</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Rate of violent crimes per 100,000 people"</span>,</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Z-scored of rate of violent crimes"</span>,</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption  =</span> <span class="st">"Gráfico de dispersão dos dados originais da taxa de criminalidade em relação aos dados com Z-score.</span><span class="sc">\n</span><span class="st">Fonte: Poldrack, 2025, p. 57, fig. 5.10 (acrescida a taxa média e a California - CA como ponto azul claro)"</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> media_x,</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>             <span class="at">color      =</span> <span class="st">"blue"</span>,</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype   =</span> <span class="st">"dashed"</span>,</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>             <span class="at">linewidth  =</span> <span class="dv">1</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>             ) <span class="sc">+</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>    <span class="st">"text"</span>,</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> media_x <span class="sc">+</span> <span class="dv">70</span>, <span class="co"># ajuste conforme necessário para a posição horizontal</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="dv">2</span>,            <span class="co"># ajuste conforme necessário para a posição vertical</span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Média = "</span>, <span class="fu">round</span>(media_x, <span class="dv">1</span>)),</span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span></span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap5-pldr-modelos-dados_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Agora os dados de crime renderizados em um mapa dos EUA, apresentados como <u><strong>Z-scores</strong></u>.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>plot_map_z <span class="ot">&lt;-</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(crimeData, <span class="fu">aes</span>(<span class="at">map_id =</span> StateLower)) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># map points to the fifty_states shape data</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_map</span>(<span class="fu">aes</span>(<span class="at">fill =</span> ViolentCrimeRateZscore), <span class="at">map =</span> fifty_states) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> fifty_states<span class="sc">$</span>long, <span class="at">y =</span> fifty_states<span class="sc">$</span>lat) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>()</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_map</span>() <span class="sc">+</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> fifty_states<span class="sc">$</span>long, <span class="at">y =</span> fifty_states<span class="sc">$</span>lat) <span class="sc">+</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># inverter o gradiente de cores para estados com mais crimes violentos</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># serem representados pela cor azul mais escura.</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># O oposto pela cor azul mais claro.</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">low =</span> <span class="st">"lightblue"</span>,   <span class="co"># cor para valores baixos</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">high =</span> <span class="st">"darkblue"</span>  <span class="co"># cor para valores altos</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>final_plot <span class="ot">&lt;-</span> <span class="fu">ggdraw</span>(plot_map_z) <span class="sc">+</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_label</span>(</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Dados de crime renderizados em um mapa dos EUA, apresentados como Z-scores.</span><span class="sc">\n</span><span class="st">Fonte: Poldrack, 2025, p. 57, fig. 5.11 (apenas com a inversão do gradiente de cores do original)"</span>,</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="fl">0.02</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">0</span>,</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontface =</span> <span class="st">"italic"</span>, <span class="at">size =</span> <span class="dv">10</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a><span class="co"># print(final_plot)</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a><span class="co"># add border boxes to AK/HI</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>final_plot <span class="sc">+</span> <span class="fu">fifty_states_inset_boxes</span>()</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap5-pldr-modelos-dados_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="interpretando-z-scores" class="level2" data-number="4.13"><h2 data-number="4.13" class="anchored" data-anchor-id="interpretando-z-scores">
<span class="header-section-number">4.13</span> Interpretando Z-scores</h2>
<p><strong>O “Z” em Z-score se origina do fato de a distribuição normal padrão</strong> (ou seja, uma distribuição normal com uma média de 0 e um desvio-padrão de 1) frequentemente ser chamada de <u><strong><em>distribuição Z</em></strong></u>.</p>
<p>Podemos usar a distribuição normal padrão para nos ajudar a compreender <strong><em>o que os Z-scores específicos nos revelam</em></strong> sobre a posição de um ponto de dados em relação ao restante da distribuição.</p>
<p>Na Figura 5.12, a coluna da esquerda mostra que <strong><em>esperamos que cerca de 16% dos valores estejam em Z ≥ 1 e a mesma proporção, em Z ≤ −1</em></strong>.</p>
<p>Na Figura 5.12, a coluna da direita apresenta o mesmo gráfico, mas <strong><em>para dois desvios-padrão</em></strong>.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># First, create a function to generate plots of the density and CDF</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>dnormfun <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">dnorm</span>(x, <span class="dv">248</span>))</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>plot_density_and_cdf <span class="ot">&lt;-</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(zcut, <span class="at">zmin =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">zmax =</span> <span class="dv">4</span>, <span class="at">plot_cdf =</span> <span class="cn">TRUE</span>, <span class="at">zmean =</span> <span class="dv">0</span>, <span class="at">zsd =</span> <span class="dv">1</span>) {</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    zmin <span class="ot">&lt;-</span> zmin <span class="sc">*</span> zsd <span class="sc">+</span> zmean</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    zmax <span class="ot">&lt;-</span> zmax <span class="sc">*</span> zsd <span class="sc">+</span> zmean</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">seq</span>(zmin, zmax, <span class="fl">0.1</span> <span class="sc">*</span> zsd)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    zdist <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> zmean, <span class="at">sd =</span> zsd)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    area <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(zcut) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span>zcut)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    p2 <span class="ot">&lt;-</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tibble</span>(</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">zdist =</span> zdist,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> x</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, zdist)) <span class="sc">+</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>(</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(x, zdist),</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">2</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stat_function</span>(</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> zmean, <span class="at">sd =</span> zsd),</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlim =</span> <span class="fu">c</span>(zmean <span class="sc">-</span> zcut <span class="sc">*</span> zsd, zmean <span class="sc">+</span> zsd <span class="sc">*</span> zcut),</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="st">"orange"</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stat_function</span>(</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> zmean, <span class="at">sd =</span> zsd),</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlim =</span> <span class="fu">c</span>(zmin, zmean <span class="sc">-</span> zcut <span class="sc">*</span> zsd),</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="st">"green"</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stat_function</span>(</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> zmean, <span class="at">sd =</span> zsd),</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlim =</span> <span class="fu">c</span>(zmean <span class="sc">+</span> zcut <span class="sc">*</span> zsd, zmax),</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="st">"green"</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">annotate</span>(</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>        <span class="st">"text"</span>,</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> zmean,</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">dnorm</span>(zmean, <span class="at">mean =</span> zmean, <span class="at">sd =</span> zsd) <span class="sc">/</span> <span class="dv">2</span>,</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%0.1f%%"</span>, area <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">annotate</span>(</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>        <span class="st">"text"</span>,</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> zmean <span class="sc">-</span> zsd <span class="sc">*</span> zcut <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">*</span> zsd,</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">dnorm</span>(zmean <span class="sc">-</span> zcut <span class="sc">*</span> zsd, <span class="at">mean =</span> zmean, <span class="at">sd =</span> zsd) <span class="sc">+</span> <span class="fl">0.01</span> <span class="sc">/</span> zsd,</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%0.1f%%"</span>, <span class="fu">pnorm</span>(zmean <span class="sc">-</span> zsd <span class="sc">*</span> zcut, <span class="at">mean =</span> zmean, <span class="at">sd =</span> zsd) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>      <span class="fu">annotate</span>(</span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>        <span class="st">"text"</span>,</span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> zmean <span class="sc">+</span> zsd <span class="sc">*</span> zcut <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> zsd,</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">dnorm</span>(zmean <span class="sc">-</span> zcut <span class="sc">*</span> zsd, <span class="at">mean =</span> zmean, <span class="at">sd =</span> zsd) <span class="sc">+</span> <span class="fl">0.01</span> <span class="sc">/</span> zsd,</span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%0.1f%%"</span>, (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(zmean <span class="sc">+</span> zsd <span class="sc">*</span> zcut, <span class="at">mean =</span> zmean, <span class="at">sd =</span> zsd)) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>      <span class="fu">xlim</span>(zmin, zmax) <span class="sc">+</span></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(</span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Z score"</span>,</span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"density"</span></span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a>      cdf2 <span class="ot">&lt;-</span></span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a>        <span class="fu">tibble</span>(</span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>          <span class="at">zdist =</span> zdist,</span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> x,</span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>          <span class="at">zcdf =</span> <span class="fu">pnorm</span>(x, <span class="at">mean =</span> zmean, <span class="at">sd =</span> zsd)</span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">%&gt;%</span></span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, zcdf)) <span class="sc">+</span></span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a>        <span class="fu">annotate</span>(</span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a>          <span class="st">"segment"</span>,</span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> zmin,</span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a>          <span class="at">xend =</span> zmean <span class="sc">+</span> zsd <span class="sc">*</span> zcut,</span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="fu">pnorm</span>(zmean <span class="sc">+</span> zsd <span class="sc">*</span> zcut, <span class="at">mean =</span> zmean, <span class="at">sd =</span> zsd),</span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a>          <span class="at">yend =</span> <span class="fu">pnorm</span>(zmean <span class="sc">+</span> zsd <span class="sc">*</span> zcut, <span class="at">mean =</span> zmean, <span class="at">sd =</span> zsd),</span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a>          <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a>        <span class="fu">annotate</span>(</span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a>          <span class="st">"segment"</span>,</span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> zmean <span class="sc">+</span> zsd <span class="sc">*</span> zcut,</span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a>          <span class="at">xend =</span> zmean <span class="sc">+</span> zsd <span class="sc">*</span> zcut,</span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="fu">pnorm</span>(zmean <span class="sc">+</span> zsd <span class="sc">*</span> zcut, <span class="at">mean =</span> zmean, <span class="at">sd =</span> zsd),</span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a>          <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a>        <span class="fu">annotate</span>(</span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a>          <span class="st">"segment"</span>,</span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> zmin,</span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a>          <span class="at">xend =</span> zmean <span class="sc">-</span> zcut <span class="sc">*</span> zsd,</span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="fu">pnorm</span>(zmean <span class="sc">-</span> zcut <span class="sc">*</span> zsd, <span class="at">mean =</span> zmean, <span class="at">sd =</span> zsd),</span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a>          <span class="at">yend =</span> <span class="fu">pnorm</span>(zmean <span class="sc">-</span> zcut <span class="sc">*</span> zsd, <span class="at">mean =</span> zmean, <span class="at">sd =</span> zsd),</span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a>          <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a>        <span class="fu">annotate</span>(</span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a>          <span class="st">"segment"</span>,</span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> zmean <span class="sc">-</span> zcut <span class="sc">*</span> zsd,</span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a>          <span class="at">xend =</span> zmean <span class="sc">-</span> zcut <span class="sc">*</span> zsd,</span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a>          <span class="at">yend =</span> <span class="fu">pnorm</span>(zmean <span class="sc">-</span> zcut <span class="sc">*</span> zsd, <span class="at">mean =</span> zmean, <span class="at">sd =</span> zsd),</span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a>          <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ylab</span>(<span class="st">"Cumulative density"</span>)</span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">pdf =</span> p2, <span class="at">cdf =</span> cdf2))</span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a>plots1 <span class="ot">=</span> <span class="fu">plot_density_and_cdf</span>(<span class="dv">1</span>)</span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a>plots2 <span class="ot">=</span> <span class="fu">plot_density_and_cdf</span>(<span class="dv">2</span>)</span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_grid(plots1$pdf, plots2$pdf, plots1$cdf, plots2$cdf, nrow=2, ncol=2)</span></span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando a nota de rodapé como grob com tamanho de fonte personalizado</span></span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a>nota_rodape <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(</span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Na parte superior temos a densidade [Density] e, na parte inferior, a distribuição cumulativa [Cumulative density]</span><span class="sc">\n</span><span class="st">de uma distribuição normal padrão, com pontos de cutoffs em um desvio-padrão acima/abaixo da média (coluna da esquerda) e</span><span class="sc">\n</span><span class="st">dois desvios-padrão (coluna da direita). Fonte: Poldrack, 2025, p. 58, fig. 5.12 (apenas com ajuste do tamanho da fonte das proporções %)"</span>,</span>
<span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a>  <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">8</span>,</span>
<span id="cb17-125"><a href="#cb17-125" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="st">"italic"</span>),</span>
<span id="cb17-126"><a href="#cb17-126" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fl">0.5</span>,</span>
<span id="cb17-127"><a href="#cb17-127" aria-hidden="true" tabindex="-1"></a>  <span class="at">hjust =</span> <span class="fl">0.5</span></span>
<span id="cb17-128"><a href="#cb17-128" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-129"><a href="#cb17-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-130"><a href="#cb17-130" aria-hidden="true" tabindex="-1"></a><span class="co"># Usando grid.arrange com a nota de rodapé customizada</span></span>
<span id="cb17-131"><a href="#cb17-131" aria-hidden="true" tabindex="-1"></a><span class="co"># usando grid.arrange() (do pacote gridExtra), pode usar o argumento bottom:</span></span>
<span id="cb17-132"><a href="#cb17-132" aria-hidden="true" tabindex="-1"></a><span class="co"># para gerar um nota de rodapé ´no gráfico final</span></span>
<span id="cb17-133"><a href="#cb17-133" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(</span>
<span id="cb17-134"><a href="#cb17-134" aria-hidden="true" tabindex="-1"></a>  plots1<span class="sc">$</span>pdf, plots2<span class="sc">$</span>pdf, plots1<span class="sc">$</span>cdf, plots2<span class="sc">$</span>cdf,</span>
<span id="cb17-135"><a href="#cb17-135" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb17-136"><a href="#cb17-136" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb17-137"><a href="#cb17-137" aria-hidden="true" tabindex="-1"></a>  <span class="at">bottom =</span> nota_rodape)</span>
<span id="cb17-138"><a href="#cb17-138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap5-pldr-modelos-dados_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Aqui, vemos que <strong><em>apenas 2,3% dos valores estão em Z ≤ −2 e o mesmo em Z ≥ 2</em></strong>.</p>
<p>Portanto, <u><strong><em>se soubermos o Z-score de um determinado ponto de dados</em></strong></u>, podemos <u><strong><em>estimar</em></strong></u> a <u><strong>probabilidade</strong></u> ou a <strong><em>improbabilidade de encontrarmos um valor tão extremo quanto esse</em></strong>.</p>
<p>Isso nos possibilita contextualizar melhor os valores.</p>
<p>No caso das taxas de criminalidade, observamos que a <code>Califórnia</code> tem um <strong>Z-score</strong> de <strong>0.38</strong> em relação à <strong><em>sua taxa de crimes violentos per capita</em></strong>, indicando que <strong><em>está próxima da média de outros estados</em></strong>, pois <strong><em>cerca de 35% desses apresentam taxas maiores</em></strong> e <strong><em>cerca de 65% deles apresentam taxas menores</em></strong>.</p>
</section><section id="escores-padronizados" class="level2" data-number="4.14"><h2 data-number="4.14" class="anchored" data-anchor-id="escores-padronizados">
<span class="header-section-number">4.14</span> Escores Padronizados</h2>
<p>Um <u><strong>escore padronizado</strong></u> é <strong><em>um Z-score que foi transformado para ter média e desvio-padrão diferentes da distribuição normal padrão</em></strong>.</p>
<p>Suponha que, <em>em vez de Z-scores</em>, quiséssemos <strong><em>gerar escores padronizados de criminalidade com média de 100 e desvio-padrão de 10</em></strong> (Figura 5.13).</p>
<p>Isso <strong><em>se assemelha à padronização em notas de testes de inteligência</em></strong> para gerar o <u><strong>quociente de inteligência (QI)</strong></u>.</p>
<p>Podemos fazer isso <strong><em>simplesmente multiplicando os Z-scores por 10 e, em seguida, somando 100</em></strong>.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>crimeData <span class="ot">&lt;-</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  crimeData <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ViolentCrimeRateStdScore =</span> (ViolentCrimeRateZscore) <span class="sc">*</span> <span class="dv">10</span> <span class="sc">+</span> <span class="dv">100</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>caCrimeData <span class="ot">&lt;-</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  crimeData <span class="sc">%&gt;%</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(State <span class="sc">==</span> <span class="st">"California"</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>crimeData <span class="sc">%&gt;%</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(ViolentCrimeRateStdScore)) <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>,</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha    =</span> <span class="fl">0.6</span>,</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill  =</span> <span class="st">"gray"</span>,  <span class="co"># cor de preenchimento das barras</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>     <span class="co"># cor das linhas das bordas das barras</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>                 ) <span class="sc">+</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> caCrimeData<span class="sc">$</span>ViolentCrimeRateStdScore,</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"darkblue"</span>,</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>             ) <span class="sc">+</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq.int</span>(<span class="dv">0</span>, <span class="dv">13</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"text"</span>,</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> caCrimeData<span class="sc">$</span>ViolentCrimeRateStdScore <span class="sc">+</span> <span class="dv">6</span>,</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="dv">12</span>,</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"California = "</span>, <span class="fu">round</span>(caCrimeData<span class="sc">$</span>ViolentCrimeRateStdScore, <span class="dv">1</span>)),</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"darkblue"</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Standardized rate of violent crimes"</span>,</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption  =</span> <span class="st">"Dados de crimes apresentados como escores padronizados [Standardized rate of violent crimes]</span><span class="sc">\n</span><span class="st">com média de 100 e desvio-padrão de 10 (acrescido o da California - CA junto à linha vertical azul clara).</span><span class="sc">\n</span><span class="st">Fonte: Poldrack, 2025, p. 59, fig. 5.13"</span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap5-pldr-modelos-dados_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="usando-z-scores-para-comparar-distribuições" class="level2" data-number="4.15"><h2 data-number="4.15" class="anchored" data-anchor-id="usando-z-scores-para-comparar-distribuições">
<span class="header-section-number">4.15</span> Usando Z-scores para Comparar Distribuições</h2>
<p>Uma aplicação vantajosa dos <u><strong>Z-scores</strong></u> é <strong><em>comparar distribuições de diferentes variáveis</em></strong>.</p>
<p>Suponha que queiramos <em>comparar</em> a <strong><em>distribuição de crimes violentos</em></strong> e <strong><em>de crimes contra o patrimônio</em></strong> entre os <strong><em>estados</em></strong>.</p>
<p>No painel <strong>A</strong> da Figura 5.15, <strong><em>representamos comparativamente ambas</em></strong>, sendo que a Califórnia é mostrada na forma de um ponto enorme.</p>
<p>Como podemos observar, as <strong><em>taxas brutas de crimes contra o patrimônio são bem maiores do que as taxas brutas de crimes violentos</em></strong>.</p>
<p>Assim, <strong><em>não podemos comparar os números diretamente</em></strong>.</p>
<p>No entanto, <strong><em>podemos plotar os Z-scores desses dados entre si</em></strong> (painel <strong>B</strong> da Figura 5.14) — aqui, mais uma vez, observamos que a <strong><em>distribuição dos dados não muda</em></strong>.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> crimeData <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Violent.Crime.rate, Property.crime.rate)) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"point"</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> caCrimeData<span class="sc">$</span>Violent.Crime.rate,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> caCrimeData<span class="sc">$</span>Property.crime.rate,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"text"</span>,</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> caCrimeData<span class="sc">$</span>Violent.Crime.rate <span class="sc">+</span> <span class="dv">100</span>,</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> caCrimeData<span class="sc">$</span>Property.crime.rate <span class="sc">-</span> <span class="dv">50</span>,</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"California"</span>,</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Violent crime rate (per 100,000)"</span>,</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Property crime rate (per 100,000)"</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="co"># plot z scores</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>crimeData <span class="ot">&lt;-</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>  crimeData <span class="sc">%&gt;%</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">PropertyCrimeRateZscore =</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>      (Property.crime.rate <span class="sc">-</span> <span class="fu">mean</span>(Property.crime.rate)) <span class="sc">/</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sd</span>(Property.crime.rate)</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>caCrimeData <span class="ot">&lt;-</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>  crimeData <span class="sc">%&gt;%</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(State <span class="sc">==</span> <span class="st">"California"</span>)</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> crimeData <span class="sc">%&gt;%</span></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(ViolentCrimeRateZscore, PropertyCrimeRateZscore)) <span class="sc">+</span></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq.int</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, .<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq.int</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, .<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>    <span class="st">"point"</span>,</span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> caCrimeData<span class="sc">$</span>ViolentCrimeRateZscore,</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> caCrimeData<span class="sc">$</span>PropertyCrimeRateZscore,</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">"text"</span>,</span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> caCrimeData<span class="sc">$</span>ViolentCrimeRateZscore <span class="sc">+</span> <span class="fl">0.8</span>,</span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> caCrimeData<span class="sc">$</span>PropertyCrimeRateZscore  <span class="sc">-</span> <span class="fl">0.2</span>,</span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"California"</span>,</span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>)</span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"z-scored rate of violent crimes"</span>,</span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"z-scored rate of property crimes"</span></span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_grid(p1, p2)</span></span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando a nota de rodapé como grob com tamanho de fonte personalizado</span></span>
<span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a>nota_rodape <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(</span>
<span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a>  <span class="st">"(A) Gráfico de taxas de crimes contra o patrimônio [Z-scored rate of property crimes] e</span><span class="sc">\n</span><span class="st">(B) taxas de crimes contra o patrimônio e violentos [Z-scored rate of violent crimes] com Z-score.</span><span class="sc">\n</span><span class="st">Fonte: Poldrack, 2025, p. 60, fig. 5.14"</span>,</span>
<span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a>  <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">8</span>,</span>
<span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="st">"italic"</span>),</span>
<span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fl">0.5</span>,</span>
<span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a>  <span class="at">hjust =</span> <span class="fl">0.5</span></span>
<span id="cb19-76"><a href="#cb19-76" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-77"><a href="#cb19-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-78"><a href="#cb19-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Usando grid.arrange com a nota de rodapé customizada</span></span>
<span id="cb19-79"><a href="#cb19-79" aria-hidden="true" tabindex="-1"></a><span class="co"># usando grid.arrange() (do pacote gridExtra), pode usar o argumento bottom:</span></span>
<span id="cb19-80"><a href="#cb19-80" aria-hidden="true" tabindex="-1"></a><span class="co"># para gerar um nota de rodapé ´no gráfico final</span></span>
<span id="cb19-81"><a href="#cb19-81" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(</span>
<span id="cb19-82"><a href="#cb19-82" aria-hidden="true" tabindex="-1"></a>  p1, p2,</span>
<span id="cb19-83"><a href="#cb19-83" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb19-84"><a href="#cb19-84" aria-hidden="true" tabindex="-1"></a>  <span class="at">bottom =</span> nota_rodape)</span>
<span id="cb19-85"><a href="#cb19-85" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap5-pldr-modelos-dados_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><u><strong>Convertê-los em Z-scores para cada variável faz com que sejam comparáveis</strong></u> e nos <em>possibilita avaliar</em> que a <strong><em>Califórnia está no meio da distribuição em termos de crimes violentos e de crimes contra o patrimônio</em></strong>.</p>
<p><em>Adicionaremos mais um fator</em> ao gráfico: a <strong><em>população</em></strong>.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> crimeData <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(ViolentCrimeRateZscore, PropertyCrimeRateZscore)) <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> Population)) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"point"</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> caCrimeData<span class="sc">$</span>ViolentCrimeRateZscore,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> caCrimeData<span class="sc">$</span>PropertyCrimeRateZscore,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"z-scored rate of violent crimes"</span>,</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"z-scored rate of property crimes"</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.8</span>))</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>crimeData <span class="ot">&lt;-</span> crimeData <span class="sc">%&gt;%</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">ViolenceDiff =</span> ViolentCrimeRateZscore <span class="sc">-</span> PropertyCrimeRateZscore</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> crimeData <span class="sc">%&gt;%</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Population, ViolenceDiff)) <span class="sc">+</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Violence difference"</span>)</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_grid(p1, p2)</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando a nota de rodapé como grob com tamanho de fonte personalizado</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>nota_rodape <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>  <span class="st">"(A) Gráfico de taxas de crimes violentos [Z-scored rate of violent crimes] comparadas a taxas de crimes contra o patrimônio</span><span class="sc">\n</span><span class="st">[Z-scored rate of property crimes], com o tamanho da população retratado pelo tamanho do símbolo gráfico.</span><span class="sc">\n</span><span class="st">(B) Escores de diferença [Violence difference] para crimes violentos e crimes contra o patrimônio, plotados em relação à população [Population].</span><span class="sc">\n</span><span class="st">Fonte: Poldrack, 2025, p. 60, fig. 5.15"</span>,</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">8</span>,</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="st">"italic"</span>),</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fl">0.5</span>,</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">hjust =</span> <span class="fl">0.5</span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Usando grid.arrange com a nota de rodapé customizada</span></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a><span class="co"># usando grid.arrange() (do pacote gridExtra), pode usar o argumento bottom:</span></span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a><span class="co"># para gerar um nota de rodapé ´no gráfico final</span></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>  p1, p2,</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">bottom =</span> nota_rodape)</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap5-pldr-modelos-dados_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>No painel <strong>A</strong> da Figura 5.15, demonstramos isso com o tamanho do símbolo gráfico, que geralmente é uma forma útil de adicionar informações a um gráfico.</p>
<p>Como os <u><strong>Z-scores são diretamente comparáveis</strong></u>, também podemos <strong><em>calcular um escore de diferença</em></strong> que expresse a <strong><em>taxa relativa de crimes violentos e crimes não violentos</em></strong> (contra o patrimônio) entre os <strong><em>estados</em></strong>.</p>
<p>Em seguida, podemos <strong><em>plotar esses escores em relação à população</em></strong> (painel <strong>B</strong> da Figura 5.15).</p>
<p>Isso <u><strong>mostra como podemos usar Z-scores a fim de relacionar diferentes variáveis em uma escala comum</strong></u>.</p>
<p>Vale ressaltar que os <strong><em>estados menores parecem ter as maiores diferenças em ambas as direções</em></strong>.</p>
<p><em>Mesmo que seja tentador observar cada estado e tentar determinar por que eles têm um escore de diferença alto ou baixo</em>, isso <strong><em>provavelmente retrata o fato de que as estimativas obtidas a partir de amostras menores serão necessariamente mais variáveis</em></strong>, conforme analisaremos no Capítulo 7.</p>
</section><section id="problemas" class="level2" data-number="4.16"><h2 data-number="4.16" class="anchored" data-anchor-id="problemas">
<span class="header-section-number">4.16</span> Problemas</h2>
<ol type="1">
<li>Descreva as três partes do modelo básico de estatística e como elas se relacionam.</li>
<li>Um pesquisador quer criar um modelo para predizer a altura, usando uma amostra com 8 pessoas com as seguintes alturas (em centímetros): 170; 176; 168; 188; 178; 168; 179; 181.</li>
</ol>
<ul>
<li>▶Determine a moda desses dados.</li>
<li>▶Calcule o erro da moda para cada pessoa e depois calcule a média desses erros.</li>
<li>▶Calcule a média dos dados e, em seguida, calcule o erro médio a partir da média.</li>
</ul>
<ol start="3" type="1">
<li>Descreva as duas possíveis fontes de erro ao comparar as predições de um modelo com os dados.</li>
<li>Descreva o conceito de sobreajuste e como saber se o sobreajuste ocorreu.</li>
<li>Se estimarmos a média e a mediana de um conjunto de dados e, em seguida, calcularmos a soma dos erros quadráticos para cada uma dessas estimativas em comparação aos dados, qual das duas é necessariamente menor ou igual à outra?</li>
<li>Qual é a razão pela qual alguém pode querer usar a mediana em vez da média para descrever um conjunto específico de dados?</li>
<li>Calcule a mediana dos dados descritos na questão 2.</li>
<li>O que significa quando um símbolo estatístico tem um “chapéu” (como )?</li>
<li>Qual é a diferença entre a forma como o desvio-padrão é calculado para uma população e para uma amostra, e qual é o conceito fundamental de estatística relacionado a essa diferença?</li>
<li>Calcule o desvio-padrão para os dados da amostra descritos na questão 2.</li>
<li>Calcule os Z-scores para cada uma das pessoas descritas na questão 2.</li>
<li>Qual das afirmações a seguir é verdadeira em relação à média? Escolha todas as opções que se aplicam.</li>
</ol>
<ul>
<li>▶A soma dos erros de cada amostra com a média (amostral) é 0.</li>
<li>▶Ela minimiza a soma dos erros quadráticos.</li>
<li>▶Ela não é sensível a outliers.</li>
<li>▶Ela retrata o quinquagésimo percentil nos dados.</li>
</ul>
<ol start="13" type="1">
<li>O modelo que melhor se ajusta a um determinado conjunto de dados (ou seja, aquele com a menor soma de erros quadráticos) geralmente também é o modelo que melhor se ajusta a um conjunto novo de dados. Verdadeiro ou falso?</li>
<li>Qual desses conceitos é mais diretamente relevante para a pergunta anterior?</li>
</ol>
<ul>
<li>▶Sobreajuste</li>
<li>▶Graus de liberdade</li>
<li>▶Variabilidade</li>
<li>▶Escores padronizados</li>
</ul></section><section id="coeficiente-de-correlação---cap.-10-pldr" class="level2" data-number="4.17"><h2 data-number="4.17" class="anchored" data-anchor-id="coeficiente-de-correlação---cap.-10-pldr">
<span class="header-section-number">4.17</span> Coeficiente de Correlação - cap. 10 pldr</h2>
<p>O <u><strong>coeficiente de correlação</strong></u> (<strong>r</strong>) é <u><strong><em>uma medida</em></strong></u> da <u><strong><em>força</em></strong></u> da <u><strong><em>relação linear</em></strong></u> <u><strong><em>entre duas variáveis contínuas</em></strong></u>.</p>
<p>No Capítulo 13, analisaremos a correlação mais detalhadamente; por ora, <em>simplesmente apresentaremos</em> <strong><em>r</em></strong> como <strong><em>uma forma de quantificar a relação entre duas variáveis</em></strong>.</p>
<p>Trata-se de <em>uma</em> <strong><em>medida</em></strong> que varia de <strong>− 1 a 1</strong>, em que um <strong><em>valor</em></strong> de <strong><em>1 representa uma relação positiva perfeita</em></strong> <em>entre as variáveis</em>, <u><strong><em>0 representa nenhuma relação</em></strong></u>, e <strong><em>− 1 representa uma relação negativa perfeita</em></strong>.</p>
<p>A Figura 10.4 ilustra exemplos de diversos níveis de correlação usando dados gerados aleatoriamente. <span class="citation" data-cites="poldrack_pensamento_est_2025">(<a href="referencias.html#ref-poldrack_pensamento_est_2025" role="doc-biblioref">Poldrack, 2025</a> , cap. 10 - , p.&nbsp;123-124)</span></p>
<p>Carregar pacotes e o conjunto de dados <code>NHANES</code>. Selecionar o subset apenas de adultos (<code>age</code> &gt;= 18 anos).</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>) <span class="co"># set random seed to exactly replicate results</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>))</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># load the NHANES data library</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(NHANES)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co"># drop duplicated IDs within the NHANES dataset</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>NHANES <span class="ot">&lt;-</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  NHANES <span class="sc">%&gt;%</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(ID,<span class="at">.keep_all=</span><span class="cn">TRUE</span>)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>NHANES_adult <span class="ot">&lt;-</span> <span class="co"># Selecionar o subset apenas de adultos (age &gt;= 18 anos)</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  NHANES <span class="sc">%&gt;%</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(Weight) <span class="sc">%&gt;%</span> <span class="co"># descartar as observações com NA na variável Weight (peso).</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(Age <span class="sc">&gt;=</span> <span class="dv">18</span>)</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Gerar um painel com cinco <strong><em>gráficos de dispersão</em></strong> para ilustrar a relação entre a <strong><em>forma</em></strong> desses gráficos e o <strong><em>valor</em></strong> do <u><strong>coeficiente de correlação</strong></u> de Pierson, que mede a <u><strong>força</strong></u> da <u><strong>relação linear</strong></u> entre <u><strong>duas variáveis quantitativas</strong></u>: a variável resposta (Y) e a variável explicativa (X).</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456789</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>corrvals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="dv">1</span>) <span class="co"># um vetor com uma gama típica de valores de correlação</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(corrvals)){</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  simdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">mvrnorm</span>(<span class="at">n  =</span> <span class="dv">50</span>, <span class="co"># coleta uma AAS de tamanho n=50</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>                                <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="co"># um vetor com duas médias padronizadas</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>                                <span class="at">Sigma =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(          <span class="dv">1</span>, corrvals[i],</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>                                                 corrvals[i], <span class="dv">1</span>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>                                               ,<span class="dv">2</span> ,<span class="dv">2</span>)) <span class="co"># gerar uma matriz de covariâncias 2x2</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(simdata, <span class="fu">aes</span>(X1,X2)) <span class="sc">+</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">sprintf</span>(<span class="st">'r = %.02f'</span>, <span class="fu">cor</span>(simdata)[<span class="dv">1</span>,<span class="dv">2</span>]))</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  p[[i]] <span class="ot">=</span> tmp</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_grid(p[[1]],p[[2]],p[[3]],p[[4]],p[[5]])</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando a nota de rodapé como textGrob com tamanho de fonte personalizado</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>nota_rodape <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Exemplos de diversos níveis do coeficiente de correlação.</span><span class="sc">\n</span><span class="st">Fonte: Poldrack, 2025, p. 124, fig. 10.4"</span>,</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">8</span>,</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="st">"italic"</span>),</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fl">0.5</span>,</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">hjust =</span> <span class="fl">0.5</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Usando grid.arrange com a nota de rodapé customizada</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="co"># usando grid.arrange() (do pacote gridExtra), pode usar o argumento bottom:</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a><span class="co"># para gerar um nota de rodapé ´no gráfico final</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>  p[[<span class="dv">1</span>]],p[[<span class="dv">2</span>]],p[[<span class="dv">3</span>]],p[[<span class="dv">4</span>]],p[[<span class="dv">5</span>]],</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">bottom =</span> nota_rodape)</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap5-pldr-modelos-dados_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="correlação-micro-e-pequena-empresas" class="level2" data-number="4.18"><h2 data-number="4.18" class="anchored" data-anchor-id="correlação-micro-e-pequena-empresas">
<span class="header-section-number">4.18</span> Correlação: micro e pequena empresas</h2>
<p>Carregar pacotes e set up.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># import MASS first because it otherwise will mask dplyr::select</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdendro)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gplots)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pdist)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mclust)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>())</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Carregar dados primários e secundários coletados por <span class="citation" data-cites="Barzellay2022-ppfmpe">(<a href="referencias.html#ref-Barzellay2022-ppfmpe" role="doc-biblioref">BARZELLAY; DAS NEVES, 2022</a>)</span>.</p>
<section id="importar" class="level3" data-number="4.18.1"><h3 data-number="4.18.1" class="anchored" data-anchor-id="importar">
<span class="header-section-number">4.18.1</span> Importar</h3>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Importar como tibble o arquivo de dentro da pasta chamada: dat/csv.</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>mpe <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="at">file   =</span> <span class="st">"dat/csv/MPE-GO_DP_PIB_Caged_Rais.csv"</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                       <span class="co"># delim  = ",",</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">quote  =</span> <span class="st">"</span><span class="sc">\"</span><span class="st">"</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">locale =</span> <span class="fu">locale</span>(</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">decimal_mark =</span> <span class="st">"."</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">encoding     =</span> <span class="st">"UTF-8"</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>                         )</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co"># cat - Concatenate And Print</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) <span class="co"># imprime no console (saída) uma linha em branco</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Estrutura do objeto R denominado mpe:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mpe)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Nomes das 8 colunas do objeto mpe:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mpe)</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="co"># [1] "ano"  "PgtoGO_MPE"  "PIB"  "CAGED"  "RAIS"  "Pop"  "DPGO_MPE_pc"  "PIB_pc"</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="co"># ano: vai de 2006 até 2019 (14 linhas de observações para as 8 colunas de variáveis)</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>mpe <span class="co"># tibble: 14 × 8</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Estrutura do objeto R denominado mpe:
spc_tbl_ [14 × 8] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ ano        : num [1:14] 2006 2007 2008 2009 2010 ...
 $ PgtoGO_MPE : num [1:14] 1.65e+08 1.76e+08 2.05e+08 3.30e+08 4.53e+08 ...
 $ PIB        : num [1:14] 6.14e+07 7.14e+07 8.24e+07 9.29e+07 1.07e+08 ...
 $ CAGED      : num [1:14] 21061 41153 47347 34404 83975 ...
 $ RAIS       : num [1:14] 992822 1061426 1135046 1209310 1313641 ...
 $ Pop        : num [1:14] 5730762 5840650 5844996 5926308 6003788 ...
 $ DPGO_MPE_pc: num [1:14] 28.9 30.1 35.1 55.6 75.5 ...
 $ PIB_pc     : num [1:14] 10710 12226 14101 15670 17784 ...
 - attr(*, "spec")=
  .. cols(
  ..   ano = col_double(),
  ..   PgtoGO_MPE = col_double(),
  ..   PIB = col_double(),
  ..   CAGED = col_double(),
  ..   RAIS = col_double(),
  ..   Pop = col_double(),
  ..   DPGO_MPE_pc = col_double(),
  ..   PIB_pc = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; 

Nomes das 8 colunas do objeto mpe:
[1] "ano"         "PgtoGO_MPE"  "PIB"         "CAGED"       "RAIS"       
[6] "Pop"         "DPGO_MPE_pc" "PIB_pc"     
# A tibble: 14 × 8
     ano PgtoGO_MPE       PIB  CAGED    RAIS     Pop DPGO_MPE_pc PIB_pc
   &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt;  &lt;dbl&gt;
 1  2006 165475952.  61375409  21061  992822 5730762        28.9 10710.
 2  2007 175555748.  71410569  41153 1061426 5840650        30.1 12226.
 3  2008 205135955.  82417571  47347 1135046 5844996        35.1 14101.
 4  2009 329706125.  92865740  34404 1209310 5926308        55.6 15670.
 5  2010 453279122. 106770107  83975 1313641 6003788        75.5 17784.
 6  2011 333961964. 121296722  69552 1385230 6080716        54.9 19948.
 7  2012 472699129. 138757833  66230 1439341 6154996        76.8 22544.
 8  2013 640670509. 151300180  60831 1509395 6434048        99.6 23516.
 9  2014 562863907. 165015307  25333 1514532 6523222        86.3 25297.
10  2015 370979808. 173632448 -24551 1501397 6610681        56.1 26265.
11  2016 393978072. 181692438 -19354 1445943 6695855        58.8 27135.
12  2017 490777617. 191898682  25370 1515422 6778772        72.4 28309.
13  2018 422735929. 195682000  17293 1507648 6921161        61.1 28273 
14  2019 241392288. 208672000  21550 1524304 6939629        34.8 30070.</code></pre>
</div>
</div>
</section><section id="dicionário-de-dados" class="level3" data-number="4.18.2"><h3 data-number="4.18.2" class="anchored" data-anchor-id="dicionário-de-dados">
<span class="header-section-number">4.18.2</span> Dicionário de Dados</h3>
<p>O significado das 8 variáveis coletadas neste Estudo Observacional de 267 do TCE-GO: o Poder das compras públicas pelo Estado de Goiás como instrumento de Política Pública de fomento às MPE’s - Micro e Pequenas Empresas (art. 179, CF/1988; arts. 44 e 45, <a href="https://www.planalto.gov.br/ccivil_03/leis/lcp/lcp123.htm">LC n.&nbsp;123/2006</a> - Estatuto Nacional da Microempresa e da Empresa de Pequeno Porte).<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<ol type="1">
<li><p>“<code>ano</code>” - vai de 2006 até 2019 (são 14 linhas de observações para as 8 colunas de variáveis)</p></li>
<li><p>“<code>PgtoGO_MPE</code>” - Despesas anuais do Estado de Goiás com MPE - Micro e Pequenas Empresas <span class="citation" data-cites="Barzellay2022-ppfmpe">(<a href="referencias.html#ref-Barzellay2022-ppfmpe" role="doc-biblioref">BARZELLAY; DAS NEVES, 2022</a> , p.&nbsp;144, tabela 12)</span>, obtido do Sistema SIOFNet - Sistema de Elabroação e Execução Orcamentária e Financeira do Estado de Goiás.</p></li>
<li><p>“<code>PIB</code>” - Produto Interno Bruto do Esatado de Goiás, obtido junto ao IMB - Instituto Mauro Borges;</p></li>
<li><p>“<code>CAGED</code>” - Cadastro Geral de Empregados e Desempregados, obtido junto ao IMB - Instituto Mauro Borges, que fornece o <strong><em>saldo anual</em></strong> de empregos, ou seja, Contratações - Demissões <span class="citation" data-cites="Barzellay2022-ppfmpe">(<a href="referencias.html#ref-Barzellay2022-ppfmpe" role="doc-biblioref">BARZELLAY; DAS NEVES, 2022</a> , p.&nbsp;155)</span>;</p></li>
<li><p>“<code>RAIS</code>” - Relação Anual de Informações Sociais, obtido junto ao IMB - Instituto Mauro Borges, que fornece o <strong><em>número total</em></strong> de <strong><em>vínculos empregatícios</em></strong> ano a ano <span class="citation" data-cites="Barzellay2022-ppfmpe">(<a href="referencias.html#ref-Barzellay2022-ppfmpe" role="doc-biblioref">BARZELLAY; DAS NEVES, 2022</a> , p.&nbsp;154-155)</span>;</p></li>
<li><p>“<code>Pop</code>” - População do Estado de Goiás, [obtido junto ao IMB - Instituto Mauro Borges];</p></li>
<li>
<p>“<code>DPGO_MPE_pc</code>” - Despesas anuais <em>per capta</em> do Estado de Goiás com MPE - Micro e Pequenas Empresas, calculada, ano a ano, de 2006 a 2019, pela seguinte fórmula:</p>
<p><span class="math display">\[
DPGO\_MPE\_pc = \frac{PgtoGO\_MPE}{Pop}
\]</span></p>
</li>
<li>
<p>“<code>PIB_pc</code>” - Produto Interno Bruto <em>per capta</em> do Esatado de Goiás, calculado, ano a ano, de 2006 a 2019, pela seguinte fórmula:</p>
<p><span class="math display">\[
PIB\_pc = \frac{PIB}{Pop}
\]</span></p>
</li>
</ol></section><section id="contexto-dos-dados" class="level3" data-number="4.18.3"><h3 data-number="4.18.3" class="anchored" data-anchor-id="contexto-dos-dados">
<span class="header-section-number">4.18.3</span> Contexto dos dados</h3>
<p>A figura a seguir ilustra o contexto em que se deve interpretar os dados sobre CAGED e a MPE’s no Brasil <span class="citation" data-cites="Barzellay2022-ppfmpe">(<a href="referencias.html#ref-Barzellay2022-ppfmpe" role="doc-biblioref">BARZELLAY; DAS NEVES, 2022</a> , p.&nbsp;100)</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="fig/CAGED-2006-2019-MPE-x-demEmpresas-MinEcon.png" class="img-fluid figure-img"></p>
<figcaption>CAGED (2006 a 2019) por porte das empresas: MPE’s versus demais Empresas. Fonte: Min. Economia</figcaption></figure>
</div>
<p>Observe-se que, mesmo em príodo de <strong><em>crise</em></strong> de <em>empregos</em>, 2015 a 2019, as MPE’s - Micro e Pequenas Empresas são <em>menos afetadas</em> e <em>tendem</em> a sofrer <strong><em>quedas não tão acentuadas</em></strong> e mesmo <strong><em>recuperar-se mais rapidamente</em></strong> que as empresas dos demais portes (médias e grandes).</p>
<p>Outro aspceto relevante é a participação das MPEs no PIB Brasil (1985-2017), conforme estudo realizado pela FGV e SEBRAE.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="fig/MPE-participacao-PIB-Br-FGV-SEBRAE.png" class="img-fluid figure-img"></p>
<figcaption>Participação das MPEs no PIB-Br (1985 a 2019). Fonte: FGV e SEBRAE</figcaption></figure>
</div>
<p>Percebe-se pouca dispersão em torno da reta tracejada (provável reta de regressão), que representa uma <strong><em>correlação positiva</em></strong> entre a <strong>proporção</strong> <strong>(%) da participação</strong> das MPE’s no PIB-Br ao longo do período observados, de 1985 a 2017, de forma <strong><em>consistente</em></strong> ao longos desses <strong>32 anos</strong>.</p>
<p>Agora vamos olhar para os <strong><em>Valores</em></strong>, em reais (R$), da <strong><em>participação das MPEs beneficiárias de contratos nas compras públicas</em></strong> (licitações) de <strong><em>entes federais</em></strong>, de 2016 a 2020 <span class="citation" data-cites="Barzellay2022-ppfmpe">(<a href="referencias.html#ref-Barzellay2022-ppfmpe" role="doc-biblioref">BARZELLAY; DAS NEVES, 2022</a> , p.&nbsp;107, gráfico 2)</span>.</p>
<p><img src="images/clipboard-3769383876.png" class="img-fluid"></p>
<p>E verificar como a <strong><em>proporção (%) dessa participação evoluiu</em></strong> nesse mesmo período de <strong><em>tempo</em></strong>, <span class="citation" data-cites="Barzellay2022-ppfmpe">(<a href="referencias.html#ref-Barzellay2022-ppfmpe" role="doc-biblioref">BARZELLAY; DAS NEVES, 2022</a> , p.&nbsp;108, gráfico 4)</span>.</p>
<p><img src="images/clipboard-1656164584.png" class="img-fluid"></p>
</section><section id="explorar" class="level3" data-number="4.18.4"><h3 data-number="4.18.4" class="anchored" data-anchor-id="explorar">
<span class="header-section-number">4.18.4</span> Explorar</h3>
<p>Ver um <strong><em>resumo</em></strong> das <strong><em>possíveis relações entre cada par dessas 8 variáveis quantitativas</em></strong>.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs.panels</span>(mpe, <span class="at">lm=</span><span class="cn">TRUE</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap5-pldr-modelos-dados_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>A matriz de gr[aficos acima fornece uma visão geral rápida das relações entre as variáveis e identificar quais são mais importantes.</p>
<p>Exibir o <u><strong>Nível de Significância</strong></u> dos <strong><em>coeficientes de correlação</em></strong> acima através de um <u><strong>correlograma</strong></u> com <em>mapa de calor</em> (de cores) ou <strong><em>hit-map</em></strong> para corroborar essas evidências iniciais.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculando correlações e p-valores</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">rcorr</span>(<span class="fu">as.matrix</span>(mpe))</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular a matriz de correlação e os p-valores</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">rcorr</span>(<span class="fu">as.matrix</span>(mpe)) <span class="co"># retorna lista com r (correlações) e P (p-valores)</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Gera o corrplot com personalização</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  res<span class="sc">$</span>r,                        <span class="co"># matriz de correlação</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"color"</span>,             <span class="co"># método de visualização (pode ser "number", "circle", etc.)</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"upper"</span>,               <span class="co"># mostra apenas a metade superior</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">order =</span> <span class="st">"hclust"</span>,             <span class="co"># ordena as variáveis por similaridade</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">addCoef.col =</span> <span class="st">"black"</span>,        <span class="co"># adiciona os valores das correlações</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.col =</span> <span class="st">"black"</span>,             <span class="co"># cor dos nomes das variáveis</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.srt =</span> <span class="dv">45</span>,                  <span class="co"># rotação dos nomes das variáveis</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.cex =</span> <span class="fl">0.8</span>,                 <span class="co"># tamanho dos nomes das variáveis</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"white"</span>, <span class="st">"blue"</span>))(<span class="dv">200</span>), <span class="co"># gradiente de cores</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.cex =</span> <span class="fl">0.7</span>,             <span class="co"># tamanho dos números e asteriscos</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)              <span class="co"># margens do gráfico</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona um título ao gráfico</span></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a><span class="co"># title("Mapa de Correlação - MPE's Goiás", line = 0.5, cex.main = 1.5)</span></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona asteriscos manualmente</span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(res<span class="sc">$</span>r)</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)) {</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n) {</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>    pval <span class="ot">&lt;-</span> res<span class="sc">$</span>P[i, j]</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(pval)) {</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(pval <span class="sc">&lt;</span> <span class="fl">0.001</span>) {</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>        ast <span class="ot">&lt;-</span> <span class="st">"***"</span></span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span>(pval <span class="sc">&lt;</span> <span class="fl">0.01</span>) {</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>        ast <span class="ot">&lt;-</span> <span class="st">"**"</span></span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span>(pval <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>        ast <span class="ot">&lt;-</span> <span class="st">"*"</span></span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>        ast <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(ast <span class="sc">!=</span> <span class="st">""</span>) {</span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Ajuste os valores de x e y para posicionar acima e à direita</span></span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>        x <span class="ot">&lt;-</span> j <span class="sc">+</span> <span class="fl">0.25</span></span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a>        y <span class="ot">&lt;-</span> n <span class="sc">-</span> i <span class="sc">+</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fl">0.25</span></span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>        <span class="fu">text</span>(x, y, <span class="at">labels =</span> ast, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">cex =</span> <span class="fl">1.2</span>, <span class="at">font =</span> <span class="dv">2</span>)</span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona a nota de rodapé explicando os asteriscos</span></span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(</span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a>  <span class="st">"*** p &lt; 0.001   ** p &lt; 0.01   * p &lt; 0.05"</span>,</span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">side =</span> <span class="dv">1</span>,         <span class="co"># parte inferior do gráfico</span></span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">line =</span> <span class="dv">3</span>,         <span class="co"># distância da margem</span></span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> <span class="fl">0.7</span>,        <span class="co"># tamanho da fonte</span></span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">adj =</span> <span class="dv">0</span>           <span class="co"># centralizado</span></span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap5-pldr-modelos-dados_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Há correlações que são <strong><em>esperadas</em></strong>, como PIB e PIB_pc, entre PIB_pc e Pop ou entre DPGO_MPE_pc e Pop, dada ao modo como foram calculados esses indicadores <em>per capta</em>.</p>
</section><section id="contexto-mpe-no-estado-de-goiás" class="level3" data-number="4.18.5"><h3 data-number="4.18.5" class="anchored" data-anchor-id="contexto-mpe-no-estado-de-goiás">
<span class="header-section-number">4.18.5</span> Contexto MPE no Estado de Goiás</h3>
<p>Proporção de órgãos públicos estaduais no valor total de compras públicas realizadas pelo Estado de Goiás ao contratar com MPEs, no período 2006 a 2019, com uma análise de Pareto.</p>
<p>Comparação do valor total, em reais (R$) gasto nas licitações do estado de Goiás, de 2009 a 2019, com a participação das MPEs em relação a esse total de compras públicas, <span class="citation" data-cites="Barzellay2022-ppfmpe">(<a href="referencias.html#ref-Barzellay2022-ppfmpe" role="doc-biblioref">BARZELLAY; DAS NEVES, 2022</a> , p.&nbsp;146, gráfico 17)</span>.</p>
<p><img src="images/clipboard-2788289314.png" class="img-fluid"></p>
<p>Agora a <em>mesma informação</em> acima expressa como <strong>proporção (%)</strong> do <strong><em>valor das compras públicas pagos às MPE’s</em></strong> em <u><strong><em>relação</em></strong></u> ao <strong><em>valor total das despesas do Estado de Goiás com licitações</em></strong> (2009 a 2019), no mesmo período de 11 anos <span class="citation" data-cites="Barzellay2022-ppfmpe">(<a href="referencias.html#ref-Barzellay2022-ppfmpe" role="doc-biblioref">BARZELLAY; DAS NEVES, 2022</a> , p.&nbsp;146, gráfico 18)</span>.</p>
<p><img src="images/clipboard-862037786.png" class="img-fluid"></p>
<p>Agora é nítida a <u><strong>tendência</strong></u> de <strong><em>queda sistemática</em></strong> dessa <strong><em>proporção (%)</em></strong> desde 2010, quando chegou a <strong><em>41,9%</em></strong>, em um ano em que claramente foi o de menor despesa pública com licitações; até 2019, quando terminou com a menor proporção registrada no período de 11 anos, com <strong><em>6,4%</em></strong>.</p>
<p><strong><em>Tendência</em></strong> essa em <strong><em>clara divergência</em></strong> com a <strong><em>Política Pública de fomento às MPPs</em></strong> preconizada no art. 179, CF/1988 e arts. 44 e 45, <a href="https://www.planalto.gov.br/ccivil_03/leis/lcp/lcp123.htm">LC n.&nbsp;123/2006</a> - Estatuto Nacional da Microempresa e da Empresa de Pequeno Porte).</p>
<p>Uma <strong>Análise de Pareto</strong> referente ao volume de recursos fiscalizados (VTF, R$) de cada um dos <strong>28 órgãos licitantes</strong>, dos n = 267 processos cujos acórdãos foram analisados (possível viés de busca por palavras chave no site do TCE-GO), ilusta em que órgãos concentram-se as despesas públicas com MPE’s.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="fig/MPE-analise-Pareto-VRF.png" class="img-fluid figure-img"></p>
<figcaption>Análise de Pareto referente ao volume de recursos fiscalizados (VRF, R$) de cada órgão licitante dos 267 processos cujos acórdãos foram analisados.</figcaption></figure>
</div>
<p>Esse gráfico evidencia que <strong>20%</strong> dos <strong>28 órgãos</strong>, que corresponde a 0,20 x 28 = 5,6 = <strong><em>6 primeiros órgãos</em></strong>, <strong>concentram 80% do VRF</strong> - Volume de Recursos Fiscalizados (R$) pelo TCE-GO quanto às despesas com licitação do Estado de Goiás (2006 a 2019, um período de 14 anos).</p>
<p>Os órgãos em que o Controle Externo do TCE-GO deveria <strong><em>priorizar</em></strong> o <strong><em>controle</em></strong> do <strong><em>poder das compras públicas</em></strong> tendo em vista o monitoramento do cumprimento da Política Pública de fomento às MPE’s são:</p>
<ol type="1">
<li>
<code>SES</code> - Secretaria de Estado da Saúde</li>
<li><code>GOINFRA</code></li>
<li><code>AGEHAB</code></li>
<li><code>SSP</code></li>
<li><code>SANEAGO</code></li>
<li>
<code>SEAD</code> - Secretaria de Estado da Administração</li>
</ol>
<p>Para se ter uma ideia do alcance dessa política em relação a todas as MPE’s ativas sediadas no Estado de Goiás, do total das <strong>629.359</strong> (seiscentos e vinte e nove mil, trezentos e cinquenta e nove) empresas registradas como empresa de pequeno porte com endereço no Estado de Goiás, apenas <strong>6.893</strong> (seis mil, oitocentos e noventa e três), ou seja, <strong>1,1%</strong> (um vírgula zero nove por cento) <strong><em>consta da lista das empresas beneficiadas com os empenhos realizados pelo Estado de Goiás entre 2006 e 2020</em></strong>.</p>
<p>O gráfico a seguir ilustra esse cenário.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="fig/MPE-proporcao-GO-contratadas-x-naoContr.png" class="img-fluid figure-img"></p>
<figcaption>Relação MPEs ativas, com endereço registrado no Estado de Goiás, contratadas e não contratadas pelo Estado de Goiás (2006 a 2020), em números.</figcaption></figure>
</div>
<p>Apenas 1% do total de MPE’s ativas situadas no Estado de Goiás tiveram acesso à Política Pública de fomento prevista na <a href="https://www.planalto.gov.br/ccivil_03/leis/lcp/lcp123.htm">LC n.&nbsp;123/2006</a>, o que denota um amplo espaço de alcance dessa política pública ainda sem cobertura.</p>
</section><section id="análise-exploratória-explicativa-bivariada" class="level3" data-number="4.18.6"><h3 data-number="4.18.6" class="anchored" data-anchor-id="análise-exploratória-explicativa-bivariada">
<span class="header-section-number">4.18.6</span> Análise Exploratória Explicativa bivariada</h3>
<section id="y-caged-e-x-pgtogo_mpe" class="level4" data-number="4.18.6.1"><h4 data-number="4.18.6.1" class="anchored" data-anchor-id="y-caged-e-x-pgtogo_mpe">
<span class="header-section-number">4.18.6.1</span> Y = <code>CAGED</code> e X = <code>PgtoGO_MPE</code>
</h4>
<p>Baseia-se no estudo de uma possível <strong><em>relação linear</em></strong> entre <strong>uma variável resposta Y</strong> e <strong>uma variável explicativa X</strong>, ambas <strong>quantitativas</strong>.</p>
<p>Vamos considerar, inicialmente:</p>
<ul>
<li>Y = <code>CAGED</code>
</li>
<li>X = <code>PgtoGO_MPE</code>
</li>
</ul>
<p>Script a seguir gera um gráfico de dispersão com a reta de regressão.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># dados do data frame chamado mpe</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mpe<span class="sc">$</span>CAGED)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de dispersão com reta de regressão linear, r e R²</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpe, <span class="fu">aes</span>(<span class="at">x =</span> PgtoGO_MPE <span class="sc">/</span> <span class="dv">1000000</span>,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> CAGED <span class="sc">/</span> <span class="dv">1000</span>)) <span class="sc">+</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span>           <span class="co"># pontos de dispersão</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span> <span class="co"># reta de regressão linear com intervalo de confiança</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_cor</span>(</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(..r.label.., ..p.label.., <span class="at">sep =</span> <span class="st">"~`,`~"</span>)),</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.x =</span> <span class="cn">Inf</span>, <span class="at">label.y =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">hjust =</span> <span class="fl">1.1</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="fu">stat_regline_equation</span>(</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(..eq.label.., ..rr.label.., <span class="at">sep =</span> <span class="st">"~~~"</span>)),</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.x =</span> <span class="cn">Inf</span>, <span class="at">label.y =</span> <span class="cn">Inf</span>, <span class="at">hjust =</span> <span class="fl">1.1</span>, <span class="at">vjust =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Gráfico de Dispersão c/Reta Regressão"</span>,</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Período: 2006 a 2019 (n = 14 obs.)"</span>,</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"PgtoGO_MPE (despesa pública GO c/MPE, milhões R$)"</span>,</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"CAGED (saldo em milhares de empregos)"</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">30</span>, <span class="dv">85</span>) <span class="sc">+</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)         <span class="co"># tema visual limpo e fonte maior</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 -24551   21183   29887   33585   57460   83975 </code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap5-pldr-modelos-dados_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="z-score" class="level4" data-number="4.18.6.2"><h4 data-number="4.18.6.2" class="anchored" data-anchor-id="z-score">
<span class="header-section-number">4.18.6.2</span> Z-score</h4>
<p>Calcular o Z-score para os dados do data frame <code>mpe</code>.</p>
<p>Exceto para a coluna <code>ano</code>, para a qual não faz sentido determinar o Z-score.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para calcular o z-score de um vetor numérico</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>z_score <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove valores ausentes (NA) do cálculo da média e do desvio padrão</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  media <span class="ot">&lt;-</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  desvio <span class="ot">&lt;-</span> <span class="fu">sd</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calcula o z-score para cada elemento de x</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> (x <span class="sc">-</span> media) <span class="sc">/</span> desvio</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(z)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpretação: valores positivos estão acima da média, negativos abaixo.</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Se usar essa função com um vetor contendo NA</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Os NAs permanecem como NA no resultado.</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co"># deletar a variável mpe_z, caso ela exista</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">"mpe_z"</span>)) {</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(mpe_z) <span class="co"># remove mpe_z, somente se ela existir</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>mpe <span class="co"># exibe o data frame mpe</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Aplicar a função z_score em cada coluna do data frame mpe:</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Exceto à primeira coluna ano, porque não faz sentido.</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>mpe_z <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">apply</span>(mpe[, <span class="sc">-</span><span class="dv">1</span>], <span class="at">MARGIN=</span><span class="dv">2</span>, <span class="at">FUN=</span>z_score))</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>mpe_z <span class="ot">&lt;-</span> mpe_z <span class="sc">%&gt;%</span> </span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">ano =</span> mpe<span class="sc">$</span>ano, <span class="at">.before =</span> PgtoGO_MPE)</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>mpe_z <span class="co"># exibe o data frame de z-socores, acrescido da 1ª coluna ano.</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 8
     ano PgtoGO_MPE       PIB  CAGED    RAIS     Pop DPGO_MPE_pc PIB_pc
   &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt;  &lt;dbl&gt;
 1  2006 165475952.  61375409  21061  992822 5730762        28.9 10710.
 2  2007 175555748.  71410569  41153 1061426 5840650        30.1 12226.
 3  2008 205135955.  82417571  47347 1135046 5844996        35.1 14101.
 4  2009 329706125.  92865740  34404 1209310 5926308        55.6 15670.
 5  2010 453279122. 106770107  83975 1313641 6003788        75.5 17784.
 6  2011 333961964. 121296722  69552 1385230 6080716        54.9 19948.
 7  2012 472699129. 138757833  66230 1439341 6154996        76.8 22544.
 8  2013 640670509. 151300180  60831 1509395 6434048        99.6 23516.
 9  2014 562863907. 165015307  25333 1514532 6523222        86.3 25297.
10  2015 370979808. 173632448 -24551 1501397 6610681        56.1 26265.
11  2016 393978072. 181692438 -19354 1445943 6695855        58.8 27135.
12  2017 490777617. 191898682  25370 1515422 6778772        72.4 28309.
13  2018 422735929. 195682000  17293 1507648 6921161        61.1 28273 
14  2019 241392288. 208672000  21550 1524304 6939629        34.8 30070.
    ano PgtoGO_MPE      PIB  CAGED  RAIS   Pop DPGO_MPE_pc PIB_pc
1  2006     -1.454 -1.56017 -0.400 -1.97 -1.38     -1.3900  -1.67
2  2007     -1.384 -1.35788  0.241 -1.61 -1.12     -1.3356  -1.44
3  2008     -1.179 -1.13599  0.439 -1.21 -1.11     -1.1030  -1.15
4  2009     -0.318 -0.92537  0.026 -0.81 -0.92     -0.1555  -0.91
5  2010      0.537 -0.64508  1.608 -0.25 -0.74      0.7616  -0.58
6  2011     -0.288 -0.35225  1.147  0.13 -0.56     -0.1882  -0.25
7  2012      0.671 -0.00026  1.041  0.42 -0.39      0.8216   0.15
8  2013      1.833  0.25258  0.869  0.79  0.27      1.8729   0.30
9  2014      1.295  0.52906 -0.263  0.82  0.47      1.2595   0.58
10 2015     -0.032  0.70277 -1.855  0.75  0.68     -0.1329   0.73
11 2016      0.127  0.86524 -1.689  0.45  0.88     -0.0073   0.86
12 2017      0.796  1.07099 -0.262  0.83  1.07      0.6185   1.04
13 2018      0.326  1.14725 -0.520  0.79  1.40      0.0961   1.03
14 2019     -0.929  1.40911 -0.384  0.87  1.45     -1.1177   1.31</code></pre>
</div>
</div>
<p>Mesmo grágfico de dispersão acima, mas agora para os escores-z das variáveis X e Y.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># dados do data frame chamado mpe</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mpe_z<span class="sc">$</span>CAGED)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de dispersão com reta de regressão linear, r e R²</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpe_z, <span class="fu">aes</span>(<span class="at">x =</span> PgtoGO_MPE,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> CAGED)) <span class="sc">+</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span>           <span class="co"># pontos de dispersão</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span> <span class="co"># reta de regressão linear com intervalo de confiança</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_cor</span>(</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(..r.label.., ..p.label.., <span class="at">sep =</span> <span class="st">"~`,`~"</span>)),</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.x =</span> <span class="cn">Inf</span>, <span class="at">label.y =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">hjust =</span> <span class="fl">1.1</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="fu">stat_regline_equation</span>(</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(..eq.label.., ..rr.label.., <span class="at">sep =</span> <span class="st">"~~~"</span>)),</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.x =</span> <span class="cn">Inf</span>, <span class="at">label.y =</span> <span class="cn">Inf</span>, <span class="at">hjust =</span> <span class="fl">1.1</span>, <span class="at">vjust =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Gráfico de Dispersão c/Reta Regressão p/Z-scores"</span>,</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Período: 2006 a 2019 (n = 14 obs.)"</span>,</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Z-PgtoGO_MPE (Z-score da despesa pública GO c/MPE)"</span>,</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Z-CAGED (Z-score do saldo de empregos)"</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)         <span class="co"># tema visual limpo e fonte maior</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 -1.855  -0.396  -0.118   0.000   0.762   1.608 </code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap5-pldr-modelos-dados_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Observar que ao trasformar os valores originais em score-Z, os gráficos de dispersão e a reta de regressão não mudam de forma.</p>
<p>Apenas a <em>reta de regressão</em> fica <strong><em>centrada na origem</em></strong>, ponto (X = 0, Y = 0).</p>
<p>O resultado final é uma <u><strong>fraca correção</strong></u> (r = 0,16) entre Y = <code>CAGED</code> e X = <code>PgtoGO_MPE</code>.</p>
<p>Além disso essa <strong><em>correlação não é estatisticamente significativa</em></strong> para um <em>nível de significância</em> de 5% (Erro tipo I, alpha = 0,05 = 5%), poi seu valor-P = 0,59 = 59%.</p>
</section><section id="y-rais-e-x-pgtogo_mpe" class="level4" data-number="4.18.6.3"><h4 data-number="4.18.6.3" class="anchored" data-anchor-id="y-rais-e-x-pgtogo_mpe">
<span class="header-section-number">4.18.6.3</span> Y = <code>RAIS</code> e X = <code>PgtoGO_MPE</code>
</h4>
<p>Vamos considerar, agora:</p>
<ul>
<li>Y = <code>RAIS</code>
</li>
<li>X = <code>PgtoGO_MPE</code>
</li>
</ul>
<p>Script a seguir gera um gráfico de dispersão com a reta de regressão.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># dados do data frame chamado mpe</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mpe<span class="sc">$</span>RAIS)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de dispersão com reta de regressão linear, r e R²</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpe, <span class="fu">aes</span>(<span class="at">x =</span> PgtoGO_MPE <span class="sc">/</span> <span class="dv">1000000</span>,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> RAIS <span class="sc">/</span> <span class="dv">1000000</span>)) <span class="sc">+</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span>           <span class="co"># pontos de dispersão</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span> <span class="co"># reta de regressão linear com intervalo de confiança</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_cor</span>(</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(..r.label.., ..p.label.., <span class="at">sep =</span> <span class="st">"~`,`~"</span>)),</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.x =</span> <span class="cn">Inf</span>, <span class="at">label.y =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">hjust =</span> <span class="fl">1.1</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="fu">stat_regline_equation</span>(</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(..eq.label.., ..rr.label.., <span class="at">sep =</span> <span class="st">"~~~"</span>)),</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.x =</span> <span class="cn">Inf</span>, <span class="at">label.y =</span> <span class="cn">Inf</span>, <span class="at">hjust =</span> <span class="fl">1.1</span>, <span class="at">vjust =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Gráfico de Dispersão c/Reta Regressão"</span>,</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Período: 2006 a 2019 (n = 14 obs.)"</span>,</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"PgtoGO_MPE (despesa pública GO c/MPE, milhões R$)"</span>,</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"RAIS (núm. empregos, em milhões)"</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)         <span class="co"># tema visual limpo e fonte maior</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 992822 1235393 1442642 1361104 1508958 1524304 </code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap5-pldr-modelos-dados_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>O mesmo gráfico para os já calculados escores-Z.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"># dados do data frame chamado mpe</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mpe_z<span class="sc">$</span>RAIS)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de dispersão com reta de regressão linear, r e R²</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpe_z, <span class="fu">aes</span>(<span class="at">x =</span> PgtoGO_MPE,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> RAIS)) <span class="sc">+</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span>           <span class="co"># pontos de dispersão</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span> <span class="co"># reta de regressão linear com intervalo de confiança</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_cor</span>(</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(..r.label.., ..p.label.., <span class="at">sep =</span> <span class="st">"~`,`~"</span>)),</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.x =</span> <span class="cn">Inf</span>, <span class="at">label.y =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">hjust =</span> <span class="fl">1.1</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="fu">stat_regline_equation</span>(</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(..eq.label.., ..rr.label.., <span class="at">sep =</span> <span class="st">"~~~"</span>)),</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.x =</span> <span class="cn">Inf</span>, <span class="at">label.y =</span> <span class="cn">Inf</span>, <span class="at">hjust =</span> <span class="fl">1.1</span>, <span class="at">vjust =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Gráfico de Dispersão c/Reta Regressão p/Z-scores"</span>,</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Período: 2006 a 2019 (n = 14 obs.)"</span>,</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Z-PgtoGO_MPE (Z-score da despesa pública GO c/MPE)"</span>,</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Z-CAGED (Z-score do saldo de empregos)"</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)         <span class="co"># tema visual limpo e fonte maior</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 -1.973  -0.674   0.437   0.000   0.792   0.874 </code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap5-pldr-modelos-dados_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>O resultado final é uma <u><strong>forte correção</strong></u> (r = 0,73) entre Y = <code>RAIS</code> e X = <code>PgtoGO_MPE</code>.</p>
<p>Além disso essa <strong><em>correlação <u>é estatisticamente significativa</u></em></strong> para um <em>nível de significância</em> de 5% (Erro tipo I, alpha = 0,05 = 5%), poi seu <strong>valor-P</strong> = 0,0028 = 0,3% é <u><strong>menor que</strong></u> 5,0% = alpha.</p>
</section><section id="y-pib-e-x-pgtogo_mpe" class="level4" data-number="4.18.6.4"><h4 data-number="4.18.6.4" class="anchored" data-anchor-id="y-pib-e-x-pgtogo_mpe">
<span class="header-section-number">4.18.6.4</span> Y = <code>PIB</code> e X = <code>PgtoGO_MPE</code>
</h4>
<p>Vamos considerar, agora:</p>
<ul>
<li>Y = <code>PIB</code>
</li>
<li>X = <code>PgtoGO_MPE</code>
</li>
</ul>
<p>Script a seguir gera um gráfico de dispersão com a reta de regressão.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># dados do data frame chamado mpe</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mpe<span class="sc">$</span>PIB)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de dispersão com reta de regressão linear, r e R²</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpe, <span class="fu">aes</span>(<span class="at">x =</span> PgtoGO_MPE <span class="sc">/</span> <span class="dv">1000000</span>,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> PIB <span class="sc">/</span> <span class="dv">1000000</span>)) <span class="sc">+</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span>           <span class="co"># pontos de dispersão</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span> <span class="co"># reta de regressão linear com intervalo de confiança</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_cor</span>(</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(..r.label.., ..p.label.., <span class="at">sep =</span> <span class="st">"~`,`~"</span>)),</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.x =</span> <span class="cn">Inf</span>, <span class="at">label.y =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">hjust =</span> <span class="fl">1.1</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="fu">stat_regline_equation</span>(</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(..eq.label.., ..rr.label.., <span class="at">sep =</span> <span class="st">"~~~"</span>)),</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.x =</span> <span class="cn">Inf</span>, <span class="at">label.y =</span> <span class="cn">Inf</span>, <span class="at">hjust =</span> <span class="fl">1.1</span>, <span class="at">vjust =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Gráfico de Dispersão c/Reta Regressão"</span>,</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Período: 2006 a 2019 (n = 14 obs.)"</span>,</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"PgtoGO_MPE (despesa pública GO c/MPE, milhões R$)"</span>,</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"PIB (em milhões R$)"</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">50</span>, <span class="dv">200</span>) <span class="sc">+</span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)         <span class="co"># tema visual limpo e fonte maior</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
6.14e+07 9.63e+07 1.45e+08 1.39e+08 1.80e+08 2.09e+08 </code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap5-pldr-modelos-dados_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>O mesmo gráfico para os já calculados escores-Z.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># dados do data frame chamado mpe</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mpe_z<span class="sc">$</span>PIB)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de dispersão com reta de regressão linear, r e R²</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpe_z, <span class="fu">aes</span>(<span class="at">x =</span> PgtoGO_MPE,</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> PIB)) <span class="sc">+</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span>           <span class="co"># pontos de dispersão</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span> <span class="co"># reta de regressão linear com intervalo de confiança</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_cor</span>(</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(..r.label.., ..p.label.., <span class="at">sep =</span> <span class="st">"~`,`~"</span>)),</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.x =</span> <span class="cn">Inf</span>, <span class="at">label.y =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">hjust =</span> <span class="fl">1.1</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="fu">stat_regline_equation</span>(</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(..eq.label.., ..rr.label.., <span class="at">sep =</span> <span class="st">"~~~"</span>)),</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.x =</span> <span class="cn">Inf</span>, <span class="at">label.y =</span> <span class="cn">Inf</span>, <span class="at">hjust =</span> <span class="fl">1.1</span>, <span class="at">vjust =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Gráfico de Dispersão c/Reta Regressão p/Z-scores"</span>,</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Período: 2006 a 2019 (n = 14 obs.)"</span>,</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Z-PgtoGO_MPE (Z-score da despesa pública GO c/MPE)"</span>,</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Z-PIB (Z-score do PIB-GO)"</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)         <span class="co"># tema visual limpo e fonte maior</span></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 -1.560  -0.855   0.126   0.000   0.825   1.409 </code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap5-pldr-modelos-dados_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>O resultado final é uma <u><strong>correção moderada a forte</strong></u> (r = 0,51) entre Y = <code>PIB</code> e X = <code>PgtoGO_MPE</code>.</p>
<p>Além disso essa <strong><em>correlação <u>nãoé estatisticamente significativa</u></em></strong> para um <em>nível de significância</em> de 5% (Erro tipo I, alpha = 0,05 = 5%), poi seu valor-P = 0,06 = 6,0% é <u><strong>menor que</strong></u> 5,0% = alpha.</p>
</section></section><section id="conclusão" class="level3" data-number="4.18.7"><h3 data-number="4.18.7" class="anchored" data-anchor-id="conclusão">
<span class="header-section-number">4.18.7</span> Conclusão</h3>
<p>Pelos resultados ancançados e pelos testes de significância da hipótese nula (r = 0), pode-se afrimar que há <strong><em>forte correlação</em></strong> entre Y = <code>RAIS</code> e X = <code>PgtoGO_MPE</code>, pois <strong>r = 0,73</strong> e seu correspondente <strong>valor-P</strong> = 0,0028 = 0,3% é <u><strong>menor que</strong></u> 5,0% = alpha.</p>
<p>Pela reta de regressão, pode-se <strong>interpretar</strong> que <strong><em>para cada 1 milhão de R$ gastos anualmente com a despesa pública do Estado de Goiás em contratos públicos com MPE’s</em></strong> o <u><strong><em>total de empregos eleva-se</em></strong></u>, em média, 0,00095 milhões = 0,95 mil = <strong><em>950 empregos formais</em></strong> (<code>RAIS</code>).</p>
<p>O que equivaleria a um <u><strong><em>gasto médio marginal</em></strong></u> de <strong>R$1.052,63</strong> com MPE’s pelo Estado de Goiás para <strong><em>cada vaga de emprego formal alcançada</em></strong> no período observado de <strong>2006 até 2019</strong>.</p>
<p>Evidência que corrobora a intenção contitucional e legal de fomentar as MPE’s, a partir da consideração de que são elas as principais responsáveis pela geração de postos de trabalho no meio urbano (no meio rural esse papel fica com a agricultura familiar).</p>


<div id="refs" class="references csl-bib-body" data-entry-spacing="1" role="list" style="display: none">
<div id="ref-Barzellay2022-ppfmpe" class="csl-entry" role="listitem">
BARZELLAY, Larissa Sampaio; DAS NEVES, Cleuler Barbosa. <strong>Pol<span>ı́</span>tica p<span>ú</span>blica de fomento <span>à</span>s micro e pequenas empresas pelo poder das compras p<span>ú</span>blicas no estado de Goi<span>á</span>s: controle externo pelo <span>TCE/GO</span> (2006-2019)</strong>. São Paulo: Editora Dial<span>é</span>tica, 2022.
</div>
<div id="ref-poldrack_pensamento_est_2025" class="csl-entry" role="listitem">
POLDRACK, Russell. <strong>Pensamento <span>Estatístico</span>: <span>Analisando</span> <span>Dados</span> em um <span>Mundo</span> de <span>Incertezas</span></strong>. Tradução: Cibelle Ravaglia. Rio de Janeiro, RJ: Alta Books, 2025.
</div>
</div>
</section></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>Esse exemplo hipotético se refere às eleições nos Estados Unidos. Lá, cada estado tem autonomia para criar suas regras de votação no âmbito permitido pelas leis federais. Ou seja, já que o voto não é obrigatório, dependendo da localização, os eleitores podem se registrar antes de votar ou podem se registrar no mesmo dia. Estadunidenses podem votar pelo correio, ou presencialmente, seja por cédulas de papel ou por urnas eletrônicas. [N. da T.]<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2">
<p>Art. 44. Nas licitações será assegurada, como critério de desempate, <strong><em>preferência de contratação para as microempresas e empresas de pequeno porte</em></strong>. (Vide Lei nº 14.133, de 2021)</p>
<p>§ 1º Entende-se por <strong><em>empate</em></strong> aquelas situações em que as <strong><em>propostas apresentadas pelas microempresas e empresas de pequeno porte sejam iguais ou até 10% (dez por cento) superiores à proposta mais bem classificada</em></strong>.</p>
<p>§ 2º Na modalidade de <strong><em>pregão</em></strong>, o intervalo percentual estabelecido no § 1º deste artigo será de <strong><em>até 5% (cinco por cento) superior ao melhor preço</em></strong>.</p>
<p>Art. 45. Para efeito do disposto no art. 44 desta Lei Complementar, ocorrendo o <strong><em>empate</em></strong>, proceder-se-á da seguinte forma: (Vide Lei nº 14.133, de 2021</p>
<p>I - a <strong><em>microempresa ou empresa de pequeno porte mais bem classificada poderá apresentar proposta de preço inferior àquela considerada vencedora do certame</em></strong>, situação em que será <strong><em>adjudicado em seu favor o objeto licitado</em></strong>;</p>
<p>II - <strong><em>não</em></strong> ocorrendo a <strong><em>contratação da microempresa ou empresa de pequeno porte</em></strong>, na forma do <strong><em>inciso I</em></strong> do caput deste artigo, serão <strong><em>convocadas as remanescentes que porventura se enquadrem na hipótese dos §§ 1º e 2º do art. 44</em></strong> desta Lei Complementar, na <strong><em>ordem classificatória</em></strong>, para o exercício do <strong><em>mesmo direito</em></strong>;</p>
<p>III - no caso de <strong><em>equivalência dos valores</em></strong> apresentados pelas microempresas e empresas de pequeno porte que se encontrem nos intervalos estabelecidos nos §§ 1º e 2º do art. 44 desta Lei Complementar, será <strong><em>realizado sorteio</em></strong> entre elas para que <strong><em>se identifique aquela que primeiro poderá apresentar melhor oferta</em></strong>.</p>
<p>§ 1º Na hipótese da <strong><em>não-contratação</em></strong> nos termos previstos no caput deste artigo, o <strong><em>objeto licitado será adjudicado</em></strong> em <strong><em>favor da proposta originalmente vencedora</em></strong> do certame.</p>
<p>§ 2º O disposto neste artigo <strong><em>somente se aplicará quando a melhor oferta inicial não tiver sido apresentada por microempresa ou empresa de pequeno porte</em></strong>.</p>
<p>§ 3º No caso de <strong><em>pregão</em></strong>, a <em>microempresa ou empresa de pequeno porte mais bem classificada será convocada</em> para apresentar <strong><em>nova proposta no prazo máximo de 5 (cinco) minutos após o encerramento dos lances</em></strong>, sob <strong><em>pena de preclusão</em></strong>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p>
</li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiada");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiada");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./cap3-DistNorm.html" class="pagination-link" aria-label="AED - cap 3 - As Distribuições Normais">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">AED - cap 3 - As Distribuições Normais</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./cap13-pldr-model-rel-contin.html" class="pagination-link" aria-label="AID - cap 13 - Modelagem de Relações Contínuas">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">AID - cap 13 - Modelagem de Relações Contínuas</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Relatório escrito em <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


</body></html>