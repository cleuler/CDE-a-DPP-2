<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt-BR" xml:lang="pt-BR"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Cleuler Barbosa das Neves">
<title>7&nbsp; AED - cap 6 moore - Tabelas de Dupla Entrada – __Ciência de Dados e Estatística Aplicadas ao Direito e Políticas Públicas__</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 1em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./replicar-suco-uva-tab-graf.html" rel="next">
<link href="./cap16-pldr-EstMultiv.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-364982630eef5352dd1537128a8ed5cb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./cap6-moore-tab-dupla-entrada.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">AED - cap 6 moore - Tabelas de Dupla Entrada</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Procurar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./"><strong>Ciência de Dados e Estatística Aplicadas ao Direito e Políticas Públicas</strong></a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Alternar modo de leitor">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Procurar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pretexto</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introdução</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AEID-cap18-Reproduzivel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">AEID - Análise Exploratória e Inferencial de Dados</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cap3-DistNorm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">AED - cap 3 - As Distribuições Normais</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cap5-pldr-modelos-dados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">AED - cap 5 pldr - Ajustando Modelos aos Dados</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cap13-pldr-model-rel-contin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">AID - cap 13 - Modelagem de Relações Contínuas</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cap16-pldr-EstMultiv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">AID - cap 16 - Estatística Multivariada</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cap6-moore-tab-dupla-entrada.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">AED - cap 6 moore - Tabelas de Dupla Entrada</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./replicar-suco-uva-tab-graf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">AED - suco uva - Tabelas e Gráficos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cap16-moore-IC-o-basico.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">AEI - cap 16 moore - IC: o Básico</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cap17-moore-TSHN-o-basico.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">AEI - cap 17 moore - TSH0</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Conclusão</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apendiceA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Apêndice A - EMENTA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apendiceB-quadroVar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Apêndice B - Quadro Var</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./referencias.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referências</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Sumário</h2>
   
  <ul>
<li>
<a href="#objetivos-da-aprendizagem" id="toc-objetivos-da-aprendizagem" class="nav-link active" data-scroll-target="#objetivos-da-aprendizagem"><span class="header-section-number">7.1</span> Objetivos da Aprendizagem</a>
  <ul>
<li><a href="#exemplo-6.1-quem-recebe-graus-acad%C3%AAmicos" id="toc-exemplo-6.1-quem-recebe-graus-acadêmicos" class="nav-link" data-scroll-target="#exemplo-6.1-quem-recebe-graus-acad%C3%AAmicos"><span class="header-section-number">7.1.1</span> Exemplo 6.1 Quem recebe graus acadêmicos?</a></li>
  </ul>
</li>
  <li>
<a href="#distribui%C3%A7%C3%B5es-marginais" id="toc-distribuições-marginais" class="nav-link" data-scroll-target="#distribui%C3%A7%C3%B5es-marginais"><span class="header-section-number">7.2</span> Distribuições Marginais</a>
  <ul>
<li><a href="#exemplo-6.2-c%C3%A1lculo-de-uma-distribui%C3%A7%C3%A3o-marginal" id="toc-exemplo-6.2-cálculo-de-uma-distribuição-marginal" class="nav-link" data-scroll-target="#exemplo-6.2-c%C3%A1lculo-de-uma-distribui%C3%A7%C3%A3o-marginal"><span class="header-section-number">7.2.1</span> Exemplo 6.2 Cálculo de uma distribuição marginal</a></li>
  <li>
<a href="#aplique-seu-conhecimento" id="toc-aplique-seu-conhecimento" class="nav-link" data-scroll-target="#aplique-seu-conhecimento"><span class="header-section-number">7.2.2</span> Aplique seu conhecimento</a>
  <ul class="collapse">
<li><a href="#videogames-e-conceitos." id="toc-videogames-e-conceitos." class="nav-link" data-scroll-target="#videogames-e-conceitos."><span class="header-section-number">7.2.2.1</span> 6.1 Videogames e conceitos.</a></li>
  <li><a href="#idades-de-universit%C3%A1rios." id="toc-idades-de-universitários." class="nav-link" data-scroll-target="#idades-de-universit%C3%A1rios."><span class="header-section-number">7.2.2.2</span> 6.2 Idades de Universitários.</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#distribui%C3%A7%C3%B5es-condicionais" id="toc-distribuições-condicionais" class="nav-link" data-scroll-target="#distribui%C3%A7%C3%B5es-condicionais"><span class="header-section-number">7.3</span> Distribuições condicionais</a>
  <ul>
<li><a href="#exemplo-6.3-compara%C3%A7%C3%A3o-de-mulheres-e-homens" id="toc-exemplo-6.3-comparação-de-mulheres-e-homens" class="nav-link" data-scroll-target="#exemplo-6.3-compara%C3%A7%C3%A3o-de-mulheres-e-homens"><span class="header-section-number">7.3.1</span> Exemplo 6.3 Comparação de mulheres e homens</a></li>
  <li>
<a href="#aplique-seu-conhecimento-1" id="toc-aplique-seu-conhecimento-1" class="nav-link" data-scroll-target="#aplique-seu-conhecimento-1"><span class="header-section-number">7.3.2</span> Aplique seu conhecimento</a>
  <ul class="collapse">
<li><a href="#videogames-e-conceitos.-1" id="toc-videogames-e-conceitos.-1" class="nav-link" data-scroll-target="#videogames-e-conceitos.-1"><span class="header-section-number">7.3.2.1</span> 6.3 Videogames e conceitos.</a></li>
  <li><a href="#idades-de-universit%C3%A1rios.-1" id="toc-idades-de-universitários.-1" class="nav-link" data-scroll-target="#idades-de-universit%C3%A1rios.-1"><span class="header-section-number">7.3.2.2</span> 6.3 Idades de universitários.</a></li>
  </ul>
</li>
  </ul>
</li>
  <li><a href="#paradoxo-de-simpson" id="toc-paradoxo-de-simpson" class="nav-link" data-scroll-target="#paradoxo-de-simpson"><span class="header-section-number">7.4</span> Paradoxo de Simpson</a></li>
  <li><a href="#verifique-suas-habilidades" id="toc-verifique-suas-habilidades" class="nav-link" data-scroll-target="#verifique-suas-habilidades"><span class="header-section-number">7.5</span> Verifique suas habilidades</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"><span class="header-section-number">7.6</span> </a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-tab-dupla-entr" class="quarto-section-identifier"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">AED - cap 6 moore - Tabelas de Dupla Entrada</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><blockquote class="blockquote">
<p>Nos Capítulos 4 e 5, consideramos relações entre duas variáveis quantitativas.</p>
<p>Neste capítulo, usaremos tabelas de dupla entrada para descrevermos relações entre duas variáveis categóricas. Algumas variáveis – tais como gênero, raça e ocupação – são categóricas por natureza. Outras variáveis categóricas são criadas pelo agrupamento em classes dos valores de uma variável quantitativa.</p>
<p>Para explorar relações entre duas variáveis categóricas, usamos as contagens ou percentuais de indivíduos que se encaixam nas várias categorias.</p>
<p>Assim como com variáveis quantitativas, devemos estar alertas para a influência de variáveis ocultas, e tomar cuidado para não assumirmos que os padrões que observamos continuem a valer para dados adicionais ou em um contexto mais amplo. <span class="citation" data-cites="Moore2023">(<a href="referencias.html#ref-Moore2023" role="doc-biblioref">MOORE; NOTZ; FLIGNER, 2023</a> , p.&nbsp;130)</span>.</p>
</blockquote>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(NHANES)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mapproj)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pander)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelr)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">panderOptions</span>(<span class="st">'round'</span>,<span class="dv">2</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">panderOptions</span>(<span class="st">'digits'</span>,<span class="dv">7</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>))</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>) <span class="co"># set random seed to exactly replicate results</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="objetivos-da-aprendizagem" class="level2" data-number="7.1"><h2 data-number="7.1" class="anchored" data-anchor-id="objetivos-da-aprendizagem">
<span class="header-section-number">7.1</span> Objetivos da Aprendizagem</h2>
<blockquote class="blockquote">
<p>Após ler este capítulo, você deve ser capaz de:</p>
<p>▶ 6.1 Calcular e interpretar distribuições marginais em tabelas de dupla entrada.</p>
<p>▶6.2 Calcular e interpretar distribuições condicionais em tabelas de dupla entrada.</p>
<p>▶6.3Reconhecer e explicar o paradoxo de Simpson. <span class="citation" data-cites="Moore2023">(<a href="referencias.html#ref-Moore2023" role="doc-biblioref">MOORE; NOTZ; FLIGNER, 2023</a> , p.&nbsp;130)</span>.</p>
</blockquote>
<section id="exemplo-6.1-quem-recebe-graus-acadêmicos" class="level3" data-number="7.1.1"><h3 data-number="7.1.1" class="anchored" data-anchor-id="exemplo-6.1-quem-recebe-graus-acadêmicos">
<span class="header-section-number">7.1.1</span> Exemplo 6.1 Quem recebe graus acadêmicos?</h3>
<p>Em 2017, o órgão norte-americano National Center for Education Statistics fez uma projeção do número de graus acadêmicos a serem dados em 2020 e 2021 para homens e mulheres. A Tabela 6.1 mostra suas projeções.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> Essa é uma tabela de dupla entrada porque descreve duas variáveis categóricas. Uma é o sexo de um indivíduo. A outra é o grau acadêmico recebido. Sexo é a variável linha porque cada linha na tabela descreve o sexo de um indivíduo. Grau acadêmico conferido é a variável coluna porque cada coluna descreve um grau. Como o grau acadêmico conferido tem uma ordem natural, desde “Associado” a “Doutor”, as colunas estão nessa ordem. As entradas na tabela são as contagens de indivíduos (em milhares) em cada classe de sexo por grau acadêmico.</p>
<p>As entradas na margem direita são os totais das entradas das linhas, as entradas na margem inferior são os totais das entradas das colunas, e a entrada embaixo à direita é o total de todos os estudantes previstos para receberem um grau acadêmico no período de 2020 e 2021.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Graus acadêmicos por sexo (com ordem explícita dos fatores)</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>grausex <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sex  =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"M"</span>, <span class="dv">2283</span>), <span class="fu">rep</span>(<span class="st">"H"</span>, <span class="dv">1622</span>)),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"H"</span>)),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">grau =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"ass"</span>, <span class="dv">639</span>), <span class="fu">rep</span>(<span class="st">"bach"</span>, <span class="dv">1087</span>), <span class="fu">rep</span>(<span class="st">"ms"</span>, <span class="dv">460</span>), <span class="fu">rep</span>(<span class="st">"dr"</span>, <span class="dv">97</span>),</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">rep</span>(<span class="st">"ass"</span>, <span class="dv">402</span>), <span class="fu">rep</span>(<span class="st">"bach"</span>,  <span class="dv">804</span>), <span class="fu">rep</span>(<span class="st">"ms"</span>, <span class="dv">329</span>), <span class="fu">rep</span>(<span class="st">"dr"</span>, <span class="dv">87</span>)),</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"ass"</span>, <span class="st">"bach"</span>, <span class="st">"ms"</span>, <span class="st">"dr"</span>))</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># tabela multiway do data.frame (mantém a ordem dos níveis)</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(grausex)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>   grau
sex  ass bach   ms   dr
  M  639 1087  460   97
  H  402  804  329   87</code></pre>
</div>
</div>
<p>Acrescentar os totais marginais de linhas e de colunas.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabela de contingência (linhas = sexo, colunas = grau)</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">table</span>(grausex<span class="sc">$</span>sex, grausex<span class="sc">$</span>grau)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Adicionar totais marginais (linha e coluna)</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>tab_totais <span class="ot">&lt;-</span> <span class="fu">addmargins</span>(tab)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Substituir o rótulo padrão "Sum" por "Total" nas margens (mais legível em pt-BR)</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tab_totais)[<span class="fu">nrow</span>(tab_totais)] <span class="ot">&lt;-</span> <span class="st">"Total"</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab_totais)[<span class="fu">ncol</span>(tab_totais)] <span class="ot">&lt;-</span> <span class="st">"Total"</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibir tabela com totais marginais</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Tabela com totais marginais:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tab_totais)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemplo: acessar apenas totais de linha ou coluna (se precisar)</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co"># margin.table(tab, 1)  # totais por grau (linhas)</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co"># margin.table(tab, 2)  # totais por sexo (colunas)</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Tabela com totais marginais:
       
         ass bach   ms   dr Total
  M      639 1087  460   97  2283
  H      402  804  329   87  1622
  Total 1041 1891  789  184  3905</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tabela de dupla entrada
</div>
</div>
<div class="callout-body-container callout-body">
<p>Uma tabela de contagens usada para a <strong><em>organização de dados sobre duas variáveis categóricas</em></strong>.</p>
<p>Valores de cada variável linha percorrem horizontalmente a tabela, e valores de cada variável coluna percorrem a tabela verticalmente.</p>
<p>Entradas na tabela são as contagens da frequência em que cada combinação da linha e da coluna correspondentes ocorre.</p>
<p>Tabelas de dupla entrada são usadas, em geral, para o <strong><em>resumo</em></strong> de grandes quantidades de informação por meio do agrupamento das observações em categorias.</p>
</div>
</div>
</section></section><section id="distribuições-marginais" class="level2" data-number="7.2"><h2 data-number="7.2" class="anchored" data-anchor-id="distribuições-marginais">
<span class="header-section-number">7.2</span> Distribuições Marginais</h2>
<blockquote class="blockquote">
<p>Como podemos apreender a informação contida na Tabela 6.1? Primeiro, olhe a distribuição de cada variável separadamente. A distribuição de uma variável categórica diz com que frequência cada resultado ocorreu. A coluna “Total” à direita da tabela contém os totais para as linhas. Esses totais de linhas mostram a distribuição de sexo no grupo inteiro de 3.905 mil estudantes: 2.283 mil são mulheres, e 1.622 mil são homens.</p>
<p>Se os totais de linhas e de colunas estiverem ausentes, a primeira coisa a fazer no estudo de uma tabela de dupla entrada é calcular esses totais. As distribuições de sexo apenas e de grau conferido apenas são chamadas distribuições marginais, porque elas aparecem nas margens direita e inferior da tabela de dupla entrada.</p>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Distribuições marginais
</div>
</div>
<div class="callout-body-container callout-body">
<p>A distribuição marginal de uma das variáveis categóricas em uma tabela de dupla entrada de contagens é a distribuição dos valores daquela variável entre todos os indivíduos descritos pela tabela.</p>
</div>
</div>
<p>Porcentagens são, em geral, mais informativas do que contagens.</p>
<p>Podemos apresentar a distribuição marginal de sexo em porcentagens, dividindo cada total de linha pelo total da tabela e convertendo para uma porcentagem. <span class="citation" data-cites="Moore2023">(<a href="referencias.html#ref-Moore2023" role="doc-biblioref">MOORE; NOTZ; FLIGNER, 2023</a> , p.&nbsp;131)</span>.</p>
</blockquote>
<section id="exemplo-6.2-cálculo-de-uma-distribuição-marginal" class="level3" data-number="7.2.1"><h3 data-number="7.2.1" class="anchored" data-anchor-id="exemplo-6.2-cálculo-de-uma-distribuição-marginal">
<span class="header-section-number">7.2.1</span> Exemplo 6.2 Cálculo de uma distribuição marginal</h3>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Marginais em contagem ---</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Totais por linha (por sexo)</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>margem_linhas <span class="ot">&lt;-</span> <span class="fu">margin.table</span>(tab, <span class="dv">1</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Totais por coluna (por grau)</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>margem_colunas <span class="ot">&lt;-</span> <span class="fu">margin.table</span>(tab, <span class="dv">2</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Marginal — por sexo (contagem):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(margem_linhas)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Marginal — por grau (contagem):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(margem_colunas)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Marginais em proporção (relativas ao total geral) ---</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>prop_linhas  <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(margem_linhas)  <span class="co"># soma = 1</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>prop_colunas <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(margem_colunas) <span class="co"># soma = 1</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Marginal — por sexo (proporção % do total):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> prop_linhas, <span class="dv">2</span>))</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Marginal — por grau (proporção % do total):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> prop_colunas, <span class="dv">2</span>))</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Proporções condicionais e por célula ---</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>prop_celula_total <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(tab)        <span class="co"># cada célula / total geral</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>prop_cond_linha <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(tab, <span class="dv">1</span>)       <span class="co"># cada linha soma 1 (condicional por sexo)</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>prop_cond_coluna <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(tab, <span class="dv">2</span>)      <span class="co"># cada coluna soma 1 (condicional por grau)</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Proporção de cada célula em relação ao total (em %):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> prop_celula_total, <span class="dv">2</span>))</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Proporção condicional por sexo (cada linha soma 100%):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> prop_cond_linha, <span class="dv">2</span>))</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Proporção condicional por grau (cada coluna soma 100%):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> prop_cond_coluna, <span class="dv">2</span>))</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Data.frames resumidos para relatório ---</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>resumo_sexo <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">sexo =</span> <span class="fu">names</span>(margem_linhas),</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">contagem =</span> <span class="fu">as.integer</span>(margem_linhas),</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">proporcao_total =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(prop_linhas), <span class="dv">4</span>)</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>resumo_grau <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">grau =</span> <span class="fu">names</span>(margem_colunas),</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">contagem =</span> <span class="fu">as.integer</span>(margem_colunas),</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">proporcao_total =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(prop_colunas), <span class="dv">4</span>)</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Resumo por sexo (contagem + proporção do total):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(resumo_sexo)</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Resumo por grau (contagem + proporção do total):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(resumo_grau)</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Marginal — por sexo (contagem):

   M    H 
2283 1622 

Marginal — por grau (contagem):

 ass bach   ms   dr 
1041 1891  789  184 

Marginal — por sexo (proporção % do total):

 M  H 
58 42 

Marginal — por grau (proporção % do total):

 ass bach   ms   dr 
26.7 48.4 20.2  4.7 

Proporção de cada célula em relação ao total (em %):
   
     ass bach   ms   dr
  M 16.4 27.8 11.8  2.5
  H 10.3 20.6  8.4  2.2

Proporção condicional por sexo (cada linha soma 100%):
   
     ass bach   ms   dr
  M 28.0 47.6 20.1  4.2
  H 24.8 49.6 20.3  5.4

Proporção condicional por grau (cada coluna soma 100%):
   
    ass bach ms dr
  M  61   57 58 53
  H  39   43 42 47

Resumo por sexo (contagem + proporção do total):
  sexo contagem proporcao_total
1    M     2283            0.58
2    H     1622            0.42

Resumo por grau (contagem + proporção do total):
  grau contagem proporcao_total
1  ass     1041           0.267
2 bach     1891           0.484
3   ms      789           0.202
4   dr      184           0.047</code></pre>
</div>
</div>
<p>Cada distribuição marginal de uma tabela de dupla entrada é uma distribuição para uma única variável categórica. Como vimos no Capítulo 1, podemos usar um gráfico de barras ou um gráfico de setores para apresentar essa distribuição. A Figura 6.1 é um gráfico de barras da distribuição de sexo entre os estudantes na amostra.</p>
<p>Ao trabalhar com uma tabela de dupla entrada, você deve calcular muitos percentuais. Aqui está uma sugestão para ajudá-lo a decidir qual fração dá o percentual que você deseja. Pergunte-se: “qual grupo representa o total do qual eu desejo uma porcentagem?” A contagem para esse grupo é o denominador da fração que leva à porcentagem. No Exemplo 6.2, desejamos a porcentagem “de estudantes”, de modo que a contagem de estudantes (o total da tabela) é o denominador.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Pacotes necessários (instala se não existir)</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"ggplot2"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"scales"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"scales"</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Gráfico de barras para 'sexo' (contagem) ---</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>tab_sexo <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(grausex<span class="sc">$</span>sex))</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tab_sexo) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sexo"</span>, <span class="st">"contagem"</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>tab_sexo<span class="sc">$</span>proporcao <span class="ot">&lt;-</span> tab_sexo<span class="sc">$</span>contagem <span class="sc">/</span> <span class="fu">sum</span>(tab_sexo<span class="sc">$</span>contagem)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>p_sexo <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tab_sexo, <span class="fu">aes</span>(<span class="at">x =</span> sexo, <span class="at">y =</span> contagem, <span class="at">fill =</span> sexo)) <span class="sc">+</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> contagem), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Contagem por sexo"</span>, <span class="at">x =</span> <span class="st">"Sexo"</span>, <span class="at">y =</span> <span class="st">"Contagem"</span>) <span class="sc">+</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibir</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_sexo)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("barra_sexo_contagem.png", p_sexo, width = 6, height = 4)</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Gráfico de barras para 'sexo' (proporção) ---</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>p_sexo_prop <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tab_sexo, <span class="fu">aes</span>(<span class="at">x =</span> sexo, <span class="at">y =</span> proporcao, <span class="at">fill =</span> sexo)) <span class="sc">+</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">percent</span>(proporcao, <span class="at">accuracy =</span> <span class="fl">0.1</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Proporção por sexo"</span>, <span class="at">x =</span> <span class="st">"Sexo"</span>, <span class="at">y =</span> <span class="st">"Proporção"</span>) <span class="sc">+</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_sexo_prop)</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("barra_sexo_proporcao.png", p_sexo_prop, width = 6, height = 4)</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Gráfico de barras para 'grau' (contagem) ---</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>tab_grau <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(grausex<span class="sc">$</span>grau))</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tab_grau) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"grau"</span>, <span class="st">"contagem"</span>)</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>tab_grau<span class="sc">$</span>proporcao <span class="ot">&lt;-</span> tab_grau<span class="sc">$</span>contagem <span class="sc">/</span> <span class="fu">sum</span>(tab_grau<span class="sc">$</span>contagem)</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>p_grau <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tab_grau, <span class="fu">aes</span>(<span class="at">x =</span> grau, <span class="at">y =</span> contagem, <span class="at">fill =</span> grau)) <span class="sc">+</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> contagem), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Contagem por grau acadêmico"</span>, <span class="at">x =</span> <span class="st">"Grau"</span>, <span class="at">y =</span> <span class="st">"Contagem"</span>) <span class="sc">+</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_grau)</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("barra_grau_contagem.png", p_grau, width = 7, height = 4)</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Gráfico de barras para 'grau' (proporção) ---</span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>p_grau_prop <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tab_grau, <span class="fu">aes</span>(<span class="at">x =</span> grau, <span class="at">y =</span> proporcao, <span class="at">fill =</span> grau)) <span class="sc">+</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">percent</span>(proporcao, <span class="at">accuracy =</span> <span class="fl">0.1</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Proporção por grau acadêmico"</span>, <span class="at">x =</span> <span class="st">"Grau"</span>, <span class="at">y =</span> <span class="st">"Proporção"</span>) <span class="sc">+</span></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_grau_prop)</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("barra_grau_proporcao.png", p_grau_prop, width = 7, height = 4)</span></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap6-moore-tab-dupla-entrada_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap6-moore-tab-dupla-entrada_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap6-moore-tab-dupla-entrada_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap6-moore-tab-dupla-entrada_files/figure-html/unnamed-chunk-5-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="aplique-seu-conhecimento" class="level3" data-number="7.2.2"><h3 data-number="7.2.2" class="anchored" data-anchor-id="aplique-seu-conhecimento">
<span class="header-section-number">7.2.2</span> Aplique seu conhecimento</h3>
<section id="videogames-e-conceitos." class="level4" data-number="7.2.2.1"><h4 data-number="7.2.2.1" class="anchored" data-anchor-id="videogames-e-conceitos.">
<span class="header-section-number">7.2.2.1</span> 6.1 Videogames e conceitos.</h4>
<p>A popularidade do computador, vídeo, internet e de jogos de realidade virtual tem aumentado a preocupação sobre sua capacidade de impactar negativamente a juventude. Os dados neste exercício se baseiam em pesquisa recente com alunos do Ensino Médio com idade entre 14 a 18 anos, em escolas de Connecticut. Eis as distribuições das notas dos meninos que jogaram e que não jogaram videogame.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabela de contingência: Conceito x Jogaram videogame</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Linhas: status (Jogaram / Nunca jogaram)</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Colunas: Conceito (As e Bs, Cs, Ds e Fs)</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Montar matriz com os dados (cada linha corresponde a um status)</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Linha 1 = "Jogaram videogame": 736, 450, 193</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Linha 2 = "Nunca jogaram videogame": 205, 144, 80</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">736</span>, <span class="dv">450</span>, <span class="dv">193</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">205</span>, <span class="dv">144</span>,  <span class="dv">80</span>),</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(counts) <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Status =</span> <span class="fu">c</span>(<span class="st">"Jogaram videogame"</span>, <span class="st">"Nunca jogaram videogame"</span>),</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">Conceito =</span> <span class="fu">c</span>(<span class="st">"As e Bs"</span>, <span class="st">"Cs"</span>, <span class="st">"Ds e Fs"</span>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Converter para objeto table (mantém dimnames)</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">as.table</span>(counts)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibir tabela original</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Tabela de contingência (contagens):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tab)</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Tabela de contingência (contagens):
                         Conceito
Status                    As e Bs  Cs Ds e Fs
  Jogaram videogame           736 450     193
  Nunca jogaram videogame     205 144      80</code></pre>
</div>
</div>
<p>(a) Quantas pessoas essa tabela descreve? Quantas delas jogaram videogame?</p>
<p>(b) Dê a distribuição marginal dos conceitos. Qual percentual dos meninos representados na tabela teve conc eito C ou menos?</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Adicionar totais marginais (linha e coluna) e renomear para "Total"</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>tab_totais <span class="ot">&lt;-</span> <span class="fu">addmargins</span>(tab)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tab_totais)[<span class="fu">nrow</span>(tab_totais)] <span class="ot">&lt;-</span> <span class="st">"Total"</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab_totais)[<span class="fu">ncol</span>(tab_totais)] <span class="ot">&lt;-</span> <span class="st">"Total"</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Tabela com totais marginais:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tab_totais)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Marginais em contagem ---</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>margem_status  <span class="ot">&lt;-</span> <span class="fu">margin.table</span>(tab, <span class="dv">1</span>)  <span class="co"># totais por status (linhas)</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>margem_conceito <span class="ot">&lt;-</span> <span class="fu">margin.table</span>(tab, <span class="dv">2</span>) <span class="co"># totais por conceito (colunas)</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Marginal — por status (contagem):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(margem_status)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Marginal — por conceito (contagem):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(margem_conceito)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Marginais em proporção (relativas ao total geral) ---</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>prop_status  <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(margem_status)   <span class="co"># soma = 1</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>prop_conceito <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(margem_conceito)</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Marginal — por status (porcentagem do total):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> prop_status, <span class="dv">2</span>))</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Marginal — por conceito (porcentagem do total):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> prop_conceito, <span class="dv">2</span>))</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Proporções por célula e condicionais ---</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>prop_celula_total <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(tab)    <span class="co"># cada célula / total geral</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>prop_cond_status  <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(tab, <span class="dv">1</span>) <span class="co"># condicional por linha (status)</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>prop_cond_conceito <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(tab, <span class="dv">2</span>)<span class="co"># condicional por coluna (conceito)</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Proporção de cada célula em relação ao total (em %):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> prop_celula_total, <span class="dv">2</span>))</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Proporção condicional por status (cada linha = 100%):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> prop_cond_status, <span class="dv">2</span>))</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Proporção condicional por conceito (cada coluna = 100%):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> prop_cond_conceito, <span class="dv">2</span>))</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Data.frames resumidos (para relatório/exportação) ---</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>resumo_status <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">status =</span> <span class="fu">names</span>(margem_status),</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">contagem =</span> <span class="fu">as.integer</span>(margem_status),</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">proporcao_total =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(prop_status), <span class="dv">4</span>),</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">porcentagem =</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="fu">as.numeric</span>(prop_status), <span class="dv">2</span>)</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>resumo_conceito <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">conceito =</span> <span class="fu">names</span>(margem_conceito),</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">contagem =</span> <span class="fu">as.integer</span>(margem_conceito),</span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">proporcao_total =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(prop_conceito), <span class="dv">4</span>),</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">porcentagem =</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="fu">as.numeric</span>(prop_conceito), <span class="dv">2</span>)</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Resumo por status:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(resumo_status)</span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Resumo por conceito:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(resumo_conceito)</span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Tabela com totais marginais:
                         Conceito
Status                    As e Bs   Cs Ds e Fs Total
  Jogaram videogame           736  450     193  1379
  Nunca jogaram videogame     205  144      80   429
  Total                       941  594     273  1808

Marginal — por status (contagem):
Status
      Jogaram videogame Nunca jogaram videogame 
                   1379                     429 

Marginal — por conceito (contagem):
Conceito
As e Bs      Cs Ds e Fs 
    941     594     273 

Marginal — por status (porcentagem do total):
Status
      Jogaram videogame Nunca jogaram videogame 
                     76                      24 

Marginal — por conceito (porcentagem do total):
Conceito
As e Bs      Cs Ds e Fs 
     52      33      15 

Proporção de cada célula em relação ao total (em %):
                         Conceito
Status                    As e Bs   Cs Ds e Fs
  Jogaram videogame          40.7 24.9    10.7
  Nunca jogaram videogame    11.3  8.0     4.4

Proporção condicional por status (cada linha = 100%):
                         Conceito
Status                    As e Bs Cs Ds e Fs
  Jogaram videogame            53 33      14
  Nunca jogaram videogame      48 34      19

Proporção condicional por conceito (cada coluna = 100%):
                         Conceito
Status                    As e Bs Cs Ds e Fs
  Jogaram videogame            78 76      71
  Nunca jogaram videogame      22 24      29

Resumo por status:
                   status contagem proporcao_total porcentagem
1       Jogaram videogame     1379            0.76          76
2 Nunca jogaram videogame      429            0.24          24

Resumo por conceito:
  conceito contagem proporcao_total porcentagem
1  As e Bs      941            0.52          52
2       Cs      594            0.33          33
3  Ds e Fs      273            0.15          15</code></pre>
</div>
</div>
<p>Olhando para as saídas acima, temos as respostas.</p>
<p>(a) Total de pessoas descritas pela tabela: 1808</p>
<p>Total de pessoas que jogaram videogame: 1379</p>
<p>(b) A partir da distribuição marginal dos conceitos, o percentual de meninos com conceito C ou menos é: 32,85% + 15,10% = 47,96%.</p>
<p>Ou seja, a maioria dos meninos que jogam videogame apresentam conceito A ou B: 52,05%.</p>
</section><section id="idades-de-universitários." class="level4" data-number="7.2.2.2"><h4 data-number="7.2.2.2" class="anchored" data-anchor-id="idades-de-universitários.">
<span class="header-section-number">7.2.2.2</span> 6.2 Idades de Universitários.</h4>
<p>Eis uma tabela de dupla entrada de dados do U.S. Census Bureau que descreve a idade e o gênero de todos os alunos universitários americanos. As entradas na tabela são contagens em milhares de estudantes.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Montar tabela Faixa etária x Sexo</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Linhas: faixas etárias (na ordem desejada)</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Colunas: Mulher, Homem</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2348</span>, <span class="dv">1831</span>,  <span class="co"># 15 a 19 anos: Mulher, Homem</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4280</span>, <span class="dv">3713</span>,  <span class="co"># 20 a 24 anos</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2166</span>, <span class="dv">1714</span>,  <span class="co"># 25 a 34 anos</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1492</span>,  <span class="dv">853</span>   <span class="co"># 35 anos ou mais</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(counts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"15 a 19 anos"</span>, <span class="st">"20 a 24 anos"</span>, <span class="st">"25 a 34 anos"</span>, <span class="st">"35 anos ou mais"</span>)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(counts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Mulher"</span>, <span class="st">"Homem"</span>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Converter para objeto table (mantém dimnames)</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>tab_faixa <span class="ot">&lt;-</span> <span class="fu">as.table</span>(counts)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibir tabela original</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Tabela Faixa etária x Sexo (contagens):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tab_faixa)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Tabela Faixa etária x Sexo (contagens):
                Mulher Homem
15 a 19 anos      2348  1831
20 a 24 anos      4280  3713
25 a 34 anos      2166  1714
35 anos ou mais   1492   853</code></pre>
</div>
</div>
<p>(a) Há quantos alunos universitários?</p>
<p>(b) Encontre a distribuição marginal das faixas etárias. Qual percentual de universitários está na faixa etária de 20 a 24 anos?</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Adicionar totais marginais (linhas e colunas)</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>tab_com_totais <span class="ot">&lt;-</span> <span class="fu">addmargins</span>(tab_faixa)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Renomear as margens para "Total" (substitui o rótulo padrão)</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tab_com_totais)[<span class="fu">nrow</span>(tab_com_totais)] <span class="ot">&lt;-</span> <span class="st">"Total"</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab_com_totais)[<span class="fu">ncol</span>(tab_com_totais)] <span class="ot">&lt;-</span> <span class="st">"Total"</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Tabela com totais marginais:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tab_com_totais)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Marginais em contagem</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>totais_por_faixa <span class="ot">&lt;-</span> <span class="fu">margin.table</span>(tab_faixa, <span class="dv">1</span>)  <span class="co"># soma por linha (faixa etária)</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>totais_por_sexo  <span class="ot">&lt;-</span> <span class="fu">margin.table</span>(tab_faixa, <span class="dv">2</span>)  <span class="co"># soma por coluna (sexo)</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Totais por faixa etária:</span><span class="sc">\n</span><span class="st">"</span>); <span class="fu">print</span>(totais_por_faixa)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Totais por sexo:</span><span class="sc">\n</span><span class="st">"</span>); <span class="fu">print</span>(totais_por_sexo)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Proporções</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>prop_total <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(tab_faixa)              <span class="co"># cada célula / total geral</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>prop_por_faixa <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(tab_faixa, <span class="dv">1</span>)       <span class="co"># condicional por faixa (linhas somam 1)</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>prop_por_sexo  <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(tab_faixa, <span class="dv">2</span>)       <span class="co"># condicional por sexo (colunas somam 1)</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Proporção de cada célula em relação ao total (em %):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> prop_total, <span class="dv">2</span>))</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Converter para data.frame em formato "long" (útil para ggplot2 ou export)</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(tab_faixa)</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df_long) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"faixa_etaria"</span>, <span class="st">"sexo"</span>, <span class="st">"contagem"</span>)</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Data.frame (long) pronto para plotagem/exportação:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df_long)</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Tabela com totais marginais:
                Mulher Homem Total
15 a 19 anos      2348  1831  4179
20 a 24 anos      4280  3713  7993
25 a 34 anos      2166  1714  3880
35 anos ou mais   1492   853  2345
Total            10286  8111 18397

Totais por faixa etária:
   15 a 19 anos    20 a 24 anos    25 a 34 anos 35 anos ou mais 
           4179            7993            3880            2345 

Totais por sexo:
Mulher  Homem 
 10286   8111 

Proporção de cada célula em relação ao total (em %):
                Mulher Homem
15 a 19 anos      12.8   9.9
20 a 24 anos      23.3  20.2
25 a 34 anos      11.8   9.3
35 anos ou mais    8.1   4.6

Data.frame (long) pronto para plotagem/exportação:
     faixa_etaria   sexo contagem
1    15 a 19 anos Mulher     2348
2    20 a 24 anos Mulher     4280
3    25 a 34 anos Mulher     2166
4 35 anos ou mais Mulher     1492
5    15 a 19 anos  Homem     1831
6    20 a 24 anos  Homem     3713
7    25 a 34 anos  Homem     1714
8 35 anos ou mais  Homem      853</code></pre>
</div>
</div>
<p>Respostas:</p>
<p>(a) Há 18397 alunos universitários no total.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Distribuição marginal por faixa etária (contagens) ---</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>margem_faixa <span class="ot">&lt;-</span> <span class="fu">margin.table</span>(tab_faixa, <span class="dv">1</span>)   <span class="co"># soma sobre colunas =&gt; total por faixa</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Marginal (contagem) por faixa etária:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(margem_faixa)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Proporção e porcentagem da distribuição marginal ---</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>prop_faixa <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(margem_faixa)       <span class="co"># proporção relativa ao total geral (soma = 1)</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>pct_faixa  <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> prop_faixa               <span class="co"># porcentagem</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Marginal (proporção) por faixa etária (em %):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> prop_faixa, <span class="dv">2</span>))            <span class="co"># exibir porcentagem com 2 casas</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Marginal (contagem) por faixa etária:
   15 a 19 anos    20 a 24 anos    25 a 34 anos 35 anos ou mais 
           4179            7993            3880            2345 

Marginal (proporção) por faixa etária (em %):
   15 a 19 anos    20 a 24 anos    25 a 34 anos 35 anos ou mais 
             23              43              21              13 </code></pre>
</div>
</div>
<p>(b) A partir da distribuição marginal das faixas etárias, vê-se que o percentual de universitários que está na faixa estária de 20 a 24 anos é: 43,45%.</p>
</section></section></section><section id="distribuições-condicionais" class="level2" data-number="7.3"><h2 data-number="7.3" class="anchored" data-anchor-id="distribuições-condicionais">
<span class="header-section-number">7.3</span> Distribuições condicionais</h2>
<blockquote class="blockquote">
<p>A Tabela 6.1 contém muito mais informação do que as duas distribuições marginais de sexo e de grau conferido, separadas. Distribuições marginais nada dizem sobre a relação entre duas variáveis. Para descrevermos uma relação entre duas variáveis categóricas, devemos calcular alguns percentuais bem escolhidos a partir das contagens mostradas no corpo da tabela.</p>
<p>Digamos que você deseje comparar as proporções de mulheres e de homens que recebem um grau de doutor. Para isso, compare os percentuais para cada categoria de sexo. Para estudar as mulheres, examinamos apenas a linha “Mulheres” na Tabela 6.1. Para encontrar o percentual de mulheres que recebem o grau de doutor, divida a contagem dessas mulheres pelo número total de mulheres (total da linha):</p>
<p><span class="math display">\[
\frac{\text{mulheres que recebem um grau de doutorado}}{\text{total da linha}} = \frac{97}{2283} = 0,042 = 4,2\%
\]</span></p>
<p>Fazendo isso para todas as quatro entradas na linha “Mulheres” obtemos a <strong><em>distribuição condicional de graus conferidos entre as mulheres</em></strong>. Usamos o termo <u><strong><em>condicional</em></strong></u> porque essa distribuição <strong><em>descreve apenas estudantes que satisfazem a condição de serem mulheres</em></strong>. <span class="citation" data-cites="Moore2023">(<a href="referencias.html#ref-Moore2023" role="doc-biblioref">MOORE; NOTZ; FLIGNER, 2023</a> , p.&nbsp;132)</span></p>
</blockquote>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Distribuições condicionais
</div>
</div>
<div class="callout-body-container callout-body">
<p>Uma distribuição condicional de uma variável é a <strong><em>distribuição dos valores daquela variável apenas entre os indivíduos que têm determinado valor na outra variável</em></strong>.</p>
<p><strong><em>Há uma distribuição condicional distinta para cada valor da outra variável.</em></strong></p>
</div>
</div>
<section id="exemplo-6.3-comparação-de-mulheres-e-homens" class="level3" data-number="7.3.1"><h3 data-number="7.3.1" class="anchored" data-anchor-id="exemplo-6.3-comparação-de-mulheres-e-homens">
<span class="header-section-number">7.3.1</span> Exemplo 6.3 Comparação de mulheres e homens</h3>
<p><code>ESTABELEÇA</code>: como diferem homens e mulheres em relação aos graus que pretendiam receber no período de 2020 e 2021?&nbsp;</p>
<p><code>PLANEJE</code>: faça uma tabela de dupla entrada das respostas pela categoria sexo. Encontre a distribuição condicional para cada categoria de sexo. Compare essas duas distribuições.</p>
<p><code>RESOLVA</code>: a Tabela 6.1 é a tabela de dupla entrada de que precisamos. Olhe primeiro apenas para a linha “Mulheres” para encontrar a distribuição condicional para mulheres; depois, apenas para a linha “Homens” para encontrar a distribuição condicional para homens. Eis os cálculos e as duas distribuições condicionais:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="fig/Moore-tab-ex-6.3-comp-sexo-M-H-por-graus.png" class="img-fluid figure-img"></p>
<figcaption>Duas distribuições condicionais de graus por sexo (M, H)</figcaption></figure>
</div>
<p>Gerar gráficos de barras empilhadas lado a lado para essas duas distribuições condicionais.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar data.frame com fatores e ordem explícita dos níveis</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>grausex <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sex  =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"M"</span>, <span class="dv">2283</span>), <span class="fu">rep</span>(<span class="st">"H"</span>, <span class="dv">1622</span>)), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"H"</span>)),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">grau =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"ass"</span>, <span class="dv">639</span>), <span class="fu">rep</span>(<span class="st">"bach"</span>, <span class="dv">1087</span>), <span class="fu">rep</span>(<span class="st">"ms"</span>, <span class="dv">460</span>), <span class="fu">rep</span>(<span class="st">"dr"</span>, <span class="dv">97</span>),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">rep</span>(<span class="st">"ass"</span>, <span class="dv">402</span>), <span class="fu">rep</span>(<span class="st">"bach"</span>,  <span class="dv">804</span>), <span class="fu">rep</span>(<span class="st">"ms"</span>, <span class="dv">329</span>), <span class="fu">rep</span>(<span class="st">"dr"</span>, <span class="dv">87</span>)),</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"ass"</span>, <span class="st">"bach"</span>, <span class="st">"ms"</span>, <span class="st">"dr"</span>))</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabela com linhas = sexo e colunas = grau (contagens)</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">table</span>(grausex<span class="sc">$</span>sex, grausex<span class="sc">$</span>grau)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Tabela de contagens (linhas = sexo, colunas = grau):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tab)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribuição condicional de grau dado o sexo:</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="co"># para cada linha (sexo) as proporções somam 1</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>prop_condicional <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(tab, <span class="at">margin =</span> <span class="dv">1</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Distribuição condicional (grau | sexo) - proporções:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(prop_condicional, <span class="dv">4</span>))   <span class="co"># 4 casas decimais</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Distribuição condicional (grau | sexo) - porcentagens:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> prop_condicional, <span class="dv">2</span>))  <span class="co"># em %</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Data.frame com contagens e proporções (útil para relatórios/plotagem)</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>df_counts <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(tab)</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df_counts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sexo"</span>, <span class="st">"grau"</span>, <span class="st">"contagem"</span>)</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>df_props <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(prop_condicional)</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df_props) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sexo"</span>, <span class="st">"grau"</span>, <span class="st">"proporcao"</span>)</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>df_condicional <span class="ot">&lt;-</span> <span class="fu">merge</span>(df_counts, df_props, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sexo"</span>, <span class="st">"grau"</span>))</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>df_condicional<span class="sc">$</span>porcentagem <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> df_condicional<span class="sc">$</span>proporcao, <span class="dv">2</span>)</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Preservar ordem dos fatores e ordenar para exibição</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>df_condicional<span class="sc">$</span>sexo <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_condicional<span class="sc">$</span>sexo, <span class="at">levels =</span> <span class="fu">levels</span>(grausex<span class="sc">$</span>sex))</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>df_condicional<span class="sc">$</span>grau <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_condicional<span class="sc">$</span>grau, <span class="at">levels =</span> <span class="fu">levels</span>(grausex<span class="sc">$</span>grau))</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>df_condicional <span class="ot">&lt;-</span> df_condicional[<span class="fu">order</span>(df_condicional<span class="sc">$</span>sexo, df_condicional<span class="sc">$</span>grau), ]</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Data.frame com contagem + proporção condicional (ordenado):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df_condicional)</span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Opcional: gráfico (ggplot2) mostrando proporção de graus por sexo ---</span></span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_condicional, <span class="fu">aes</span>(<span class="at">x =</span> sexo, <span class="at">y =</span> proporcao, <span class="at">fill =</span> grau)) <span class="sc">+</span></span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span>                         <span class="co"># altura = proporção por sexo (soma = 1)</span></span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribuição condicional: Grau dado o Sexo"</span>,</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Sexo"</span>, <span class="at">y =</span> <span class="st">"Proporção (grau | sexo)"</span>) <span class="sc">+</span></span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Tabela de contagens (linhas = sexo, colunas = grau):
   
     ass bach   ms   dr
  M  639 1087  460   97
  H  402  804  329   87

Distribuição condicional (grau | sexo) - proporções:
   
      ass  bach    ms    dr
  M 0.280 0.476 0.202 0.042
  H 0.248 0.496 0.203 0.054

Distribuição condicional (grau | sexo) - porcentagens:
   
     ass bach   ms   dr
  M 28.0 47.6 20.1  4.2
  H 24.8 49.6 20.3  5.4

Data.frame com contagem + proporção condicional (ordenado):
  sexo grau contagem proporcao porcentagem
5    M  ass      639     0.280        28.0
6    M bach     1087     0.476        47.6
8    M   ms      460     0.201        20.1
7    M   dr       97     0.042         4.2
1    H  ass      402     0.248        24.8
2    H bach      804     0.496        49.6
4    H   ms      329     0.203        20.3
3    H   dr       87     0.054         5.4</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap6-moore-tab-dupla-entrada_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong><em>As porcentagens em cada linha devem somar 100% porque, para cada categoria de sexo, todos recebem um, [e somente um], dos quatro graus</em></strong>.</p>
<p>No entanto, em geral, as porcentagens podem não ter soma exatamente 100% porque arredondamos para um número fixo de casas decimais. Esse é o <u><strong>erro de arredondamento</strong></u>, e vemos que há erro de arredondamento aqui.</p>
<p>O mesmo gráfico mais elaborado: barras empilhadas lado a lado para essas duas distribuições condicionais com indicação dos percentuais de cada classe de <code>graus</code> dentro de cada classe de <code>sexo</code>.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Pacotes necessários</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"ggplot2"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"scales"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"scales"</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar data.frame com fatores e ordem explícita dos níveis (preserva ordem nos gráficos)</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>grausex <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">sex  =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"M"</span>, <span class="dv">2283</span>), <span class="fu">rep</span>(<span class="st">"H"</span>, <span class="dv">1622</span>)), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"H"</span>)),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">grau =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"ass"</span>, <span class="dv">639</span>), <span class="fu">rep</span>(<span class="st">"bach"</span>, <span class="dv">1087</span>), <span class="fu">rep</span>(<span class="st">"ms"</span>, <span class="dv">460</span>), <span class="fu">rep</span>(<span class="st">"dr"</span>, <span class="dv">97</span>),</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">rep</span>(<span class="st">"ass"</span>, <span class="dv">402</span>), <span class="fu">rep</span>(<span class="st">"bach"</span>,  <span class="dv">804</span>), <span class="fu">rep</span>(<span class="st">"ms"</span>, <span class="dv">329</span>), <span class="fu">rep</span>(<span class="st">"dr"</span>, <span class="dv">87</span>)),</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"ass"</span>, <span class="st">"bach"</span>, <span class="st">"ms"</span>, <span class="st">"dr"</span>))</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparar data.frame de contagens por sexo x grau</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(grausex<span class="sc">$</span>sex, grausex<span class="sc">$</span>grau))</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sexo"</span>, <span class="st">"grau"</span>, <span class="st">"contagem"</span>)</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular proporção de cada grau dentro de cada sexo: P(grau | sexo)</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="co"># usa ave para somar por sexo sem depender de dplyr</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>proporcao <span class="ot">&lt;-</span> df<span class="sc">$</span>contagem <span class="sc">/</span> <span class="fu">ave</span>(df<span class="sc">$</span>contagem, df<span class="sc">$</span>sexo, <span class="at">FUN =</span> sum)</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Opcional: formatar rótulo em porcentagem (com 1 casa decimal)</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>label_pct <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>proporcao <span class="sc">&gt;=</span> <span class="fl">0.03</span>, <span class="fu">percent</span>(df<span class="sc">$</span>proporcao, <span class="at">accuracy =</span> <span class="fl">0.1</span>), <span class="st">""</span>) </span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a><span class="co"># (esconde rótulos muito pequenos para evitar sobreposição)</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico: barras empilhadas com posição = "fill" para mostrar proporção dentro de cada sexo</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> sexo, <span class="at">y =</span> contagem, <span class="at">fill =</span> grau)) <span class="sc">+</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">colour =</span> <span class="st">"grey30"</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label_pct), <span class="at">position =</span> <span class="fu">position_fill</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="at">colour =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Proporção de graus dentro de cada sexo"</span>,</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Sexo"</span>,</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Proporção (cada barra = 100%)"</span>,</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Grau"</span></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibir gráfico</span></span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Observações:</span></span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a><span class="co"># - position = "fill" transforma as alturas em proporções por sexo (P(grau | sexo)).</span></span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a><span class="co"># - Rótulos aparecem apenas quando proporção &gt;= 3% (ajuste em df$label_pct).</span></span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a><span class="co"># - A ordem dos graus é preservada pelos levels definidos em grausex$grau.</span></span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap6-moore-tab-dupla-entrada_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><code>CONCLUA</code>: a porcentagem projetada de <code>mulheres</code> a receber um <code>grau</code> de <code>associado</code> é <u>maior do que</u> a porcentagem projetada de <code>homens</code> a receber esse mesmo <code>grau</code>, enquanto a porcentagem projetada de <code>homens</code> a <u>receber outros graus diferentes</u> de <code>associado</code> é <u>ligeiramente maior</u> do que a porcentagem de <code>mulheres</code>.</p>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Erro de Arredondamento
</div>
</div>
<div class="callout-body-container callout-body">
<p>O erro de arredondamento é a <strong><em>pequena diferença entre um número decimal arredondado e seu valor preciso antes do arredondamento</em></strong>.</p>
</div>
</div>
<p>Um programa de computador fará esses cálculos para você. A maioria dos programas permite que você escolha quais distribuições condicionais você quer comparar. A saída na Figura 6.2 apresenta as <u>duas distribuições condicionais</u> de <u>graus conferidos</u>, <u>uma para cada sexo</u>, e também a distribuição marginal dos graus conferidos a todos os estudantes. As distribuições coincidem (a menos de erro de arredondamento) com os resultados nos Exemplos 6.2 e 6.3.</p>
<p>Lembre-se de que <u><strong>há dois conjuntos de distribuições condicionais para qualquer tabela de dupla entrada</strong></u>.</p>
<p>O Exemplo 6.3 examinou as <u>distribuições condicionais de graus conferidos para as duas categorias de sexo</u>. A Figura 6.3(a) faz essa comparação em um gráfico de barras, com barras separadas para homens e mulheres, lado a lado, para cada categoria de grau. Nesse gráfico, o total das quatro barras cinza-escuro é 100%, e o total das barras cinza-claro também é 100%.</p>
<p>Poderíamos também examinar as <u>quatro distribuições condicionais de sexo</u>, <u>uma para cada categoria de grau conferido</u>, olhando separadamente as quatro colunas na Tabela 6.1. A Figura 6.3(b) faz essa comparação em um gráfico de barras, novamente com barras separadas para homens e mulheres, lado a lado, para cada categoria de grau. Note que os percentuais de cada par lado a lado têm soma 100%. A Figura 6.3(c) também faz essa comparação. Em (c), cada barra é dividida (segmentada) em duas partes, representadas por dois tons de cinza. A porção superior de cada barra representa a proporção de mulheres que receberam cada grau. A porção inferior representa a proporção de homens. Cada barra tem altura 1, porque cada barra representa todos os estudantes em cada grupo diferente de pessoas. Gráficos de barras como esse na Figura 6.3(c), nos quais cada barra é dividida em partes, cada parte representando uma categoria diferente, são algumas vezes chamados de <strong><em>gráficos de barras segmentadas</em></strong>.</p>
<p>Gerar esses gráficos.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparar data.frame com contagens por grau x sexo</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(grausex<span class="sc">$</span>grau, grausex<span class="sc">$</span>sex))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"grau"</span>, <span class="st">"sexo"</span>, <span class="st">"contagem"</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Converter sexo para rótulos mais legíveis (opcional)</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>sexo <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>sexo, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"H"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Mulher"</span>, <span class="st">"Homem"</span>))</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico: barras lado a lado (position = position_dodge)</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> grau, <span class="at">y =</span> contagem, <span class="at">fill =</span> sexo)) <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>), <span class="at">width =</span> <span class="fl">0.7</span>, <span class="at">colour =</span> <span class="st">"grey20"</span>, <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> contagem),</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>),</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#4E79A7"</span>, <span class="st">"#F28E2B"</span>)) <span class="sc">+</span> <span class="co"># cores opcionais</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribuição de graus por sexo"</span>,</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Grau acadêmico"</span>,</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Contagem"</span>,</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Sexo"</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibir gráfico</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Observações:</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a><span class="co"># - Cada grupo em x (grau) contém duas barras: Mulher e Homem, lado a lado.</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a><span class="co"># - Ajuste width/position_dodge para espaçamento diferente entre as barras.</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap6-moore-tab-dupla-entrada_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Mesmo gráfico acima agora com proporções no eixo y ao invés de contagens.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar data.frame com fatores e ordem explícita dos níveis</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>grausex <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sex  =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"M"</span>, <span class="dv">2283</span>), <span class="fu">rep</span>(<span class="st">"H"</span>, <span class="dv">1622</span>)), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"H"</span>)),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">grau =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"ass"</span>, <span class="dv">639</span>), <span class="fu">rep</span>(<span class="st">"bach"</span>, <span class="dv">1087</span>), <span class="fu">rep</span>(<span class="st">"ms"</span>, <span class="dv">460</span>), <span class="fu">rep</span>(<span class="st">"dr"</span>, <span class="dv">97</span>),</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">rep</span>(<span class="st">"ass"</span>, <span class="dv">402</span>), <span class="fu">rep</span>(<span class="st">"bach"</span>,  <span class="dv">804</span>), <span class="fu">rep</span>(<span class="st">"ms"</span>, <span class="dv">329</span>), <span class="fu">rep</span>(<span class="st">"dr"</span>, <span class="dv">87</span>)),</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"ass"</span>, <span class="st">"bach"</span>, <span class="st">"ms"</span>, <span class="st">"dr"</span>))</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparar data.frame com contagens por grau x sexo</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(grausex<span class="sc">$</span>grau, grausex<span class="sc">$</span>sex))</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"grau"</span>, <span class="st">"sexo"</span>, <span class="st">"contagem"</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Converter sexo para rótulos legíveis</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>sexo <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>sexo, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"H"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Mulher"</span>, <span class="st">"Homem"</span>))</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Converter grau para rótulos legíveis (opcional)</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>grau <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>grau,</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"ass"</span>, <span class="st">"bach"</span>, <span class="st">"ms"</span>, <span class="st">"dr"</span>),</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Associado"</span>, <span class="st">"Bacharel"</span>, <span class="st">"Mestre"</span>, <span class="st">"Doutor"</span>)</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular proporção de cada sexo dentro de cada grau: P(sexo | grau)</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>proporcao <span class="ot">&lt;-</span> df<span class="sc">$</span>contagem <span class="sc">/</span> <span class="fu">ave</span>(df<span class="sc">$</span>contagem, df<span class="sc">$</span>grau, <span class="at">FUN =</span> sum)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Rótulo em porcentagem (mostrar somente se &gt;= 2% para evitar sobreposição)</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>proporcao <span class="sc">&gt;=</span> <span class="fl">0.02</span>, <span class="fu">percent</span>(df<span class="sc">$</span>proporcao, <span class="at">accuracy =</span> <span class="fl">0.1</span>), <span class="st">""</span>)</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular proporção de cada sexo dentro de cada grau: P(sexo | grau)</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>proporcao <span class="ot">&lt;-</span> df<span class="sc">$</span>contagem <span class="sc">/</span> <span class="fu">ave</span>(df<span class="sc">$</span>contagem, df<span class="sc">$</span>grau, <span class="at">FUN =</span> sum)</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Rótulo em porcentagem</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">percent</span>(df<span class="sc">$</span>proporcao, <span class="at">accuracy =</span> <span class="fl">0.1</span>)</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Posicionamento do texto: garantir que fique totalmente dentro da barra</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a><span class="co"># - Para barras pequenas, colocar no centro (mais legível)</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a><span class="co"># - Para barras maiores, colocar próximo à extremidade interna direita (95% do comprimento)</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>label_x <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>proporcao <span class="sc">&lt;</span> <span class="fl">0.05</span>,</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>                     df<span class="sc">$</span>proporcao <span class="sc">*</span> <span class="fl">0.5</span>,   <span class="co"># centro para barras muito pequenas</span></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>                     df<span class="sc">$</span>proporcao <span class="sc">*</span> <span class="fl">0.95</span>)  <span class="co"># perto da extremidade interna direita</span></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico: barras agrupadas (lado a lado) por grau, depois inverte eixos (coord_flip)</span></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> grau, <span class="at">y =</span> proporcao, <span class="at">fill =</span> sexo)) <span class="sc">+</span></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>), <span class="at">width =</span> <span class="fl">0.7</span>, <span class="at">colour =</span> <span class="st">"grey20"</span>, <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_text com y = label_x posiciona o texto dentro da barra (posição horizontal definida por label_x)</span></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> label_x, <span class="at">label =</span> label),</span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>),   <span class="co"># mantém alinhamento com as barras dodge</span></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#4E79A7"</span>, <span class="st">"#F28E2B"</span>)) <span class="sc">+</span></span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Proporção de sexo por grau (cada grau = 100%)"</span>,</span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Grau"</span>,</span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Proporção"</span>,</span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Sexo"</span></span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()  <span class="co"># barras horizontais</span></span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibir gráfico</span></span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap6-moore-tab-dupla-entrada_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Mesmo gráfico acima com barras empilhadas.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Gerar gráfico de barras empilhadas (horizontais) mostrando P(sexo | grau)</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Cada barra representa um grau; segmentos mostram a proporção de Mulher/Homem dentro desse grau.</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Pacotes necessários</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"ggplot2"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"scales"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"scales"</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Dados (preservar ordem dos níveis)</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>grausex <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">sex  =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"M"</span>, <span class="dv">2283</span>), <span class="fu">rep</span>(<span class="st">"H"</span>, <span class="dv">1622</span>)), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"H"</span>)),</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">grau =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"ass"</span>, <span class="dv">639</span>), <span class="fu">rep</span>(<span class="st">"bach"</span>, <span class="dv">1087</span>), <span class="fu">rep</span>(<span class="st">"ms"</span>, <span class="dv">460</span>), <span class="fu">rep</span>(<span class="st">"dr"</span>, <span class="dv">97</span>),</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">rep</span>(<span class="st">"ass"</span>, <span class="dv">402</span>), <span class="fu">rep</span>(<span class="st">"bach"</span>,  <span class="dv">804</span>), <span class="fu">rep</span>(<span class="st">"ms"</span>, <span class="dv">329</span>), <span class="fu">rep</span>(<span class="st">"dr"</span>, <span class="dv">87</span>)),</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"ass"</span>, <span class="st">"bach"</span>, <span class="st">"ms"</span>, <span class="st">"dr"</span>))</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparar data.frame de contagens por grau x sexo</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(grausex<span class="sc">$</span>grau, grausex<span class="sc">$</span>sex))</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"grau"</span>, <span class="st">"sexo"</span>, <span class="st">"contagem"</span>)</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Etiquetas legíveis para sexo</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>sexo <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>sexo, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"H"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Mulher"</span>, <span class="st">"Homem"</span>))</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular proporção de cada sexo dentro de cada grau: P(sexo | grau)</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>proporcao <span class="ot">&lt;-</span> df<span class="sc">$</span>contagem <span class="sc">/</span> <span class="fu">ave</span>(df<span class="sc">$</span>contagem, df<span class="sc">$</span>grau, <span class="at">FUN =</span> sum)</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Rótulo em porcentagem (mostrar apenas quando segmento for suficientemente grande)</span></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>limite_label <span class="ot">&lt;-</span> <span class="fl">0.03</span>   <span class="co"># exibir rótulo somente se proporção &gt;= 3%</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>proporcao <span class="sc">&gt;=</span> limite_label, <span class="fu">percent</span>(df<span class="sc">$</span>proporcao, <span class="at">accuracy =</span> <span class="fl">0.1</span>), <span class="st">""</span>)</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Escolher cor do rótulo para garantir contraste (branco em segmentos grandes, preto em pequenos)</span></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>label_color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>proporcao <span class="sc">&gt;=</span> <span class="fl">0.15</span>, <span class="st">"white"</span>, <span class="st">"black"</span>)</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico: barras empilhadas (cada barra soma 100%) eixos invertidos (horizontais)</span></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> grau, <span class="at">y =</span> proporcao, <span class="at">fill =</span> sexo)) <span class="sc">+</span></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"stack"</span>, <span class="at">width =</span> <span class="fl">0.7</span>, <span class="at">colour =</span> <span class="st">"grey20"</span>, <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label, <span class="at">colour =</span> label_color),</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_identity</span>() <span class="sc">+</span>  <span class="co"># usa as cores definidas em df$label_color diretamente</span></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#4E79A7"</span>, <span class="st">"#F28E2B"</span>)) <span class="sc">+</span></span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Proporção de sexo por grau (cada grau = 100%) — barras empilhadas"</span>,</span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Grau"</span>,</span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Proporção"</span>,</span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Sexo"</span></span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()  <span class="co"># barras horizontais</span></span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibir gráfico</span></span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap6-moore-tab-dupla-entrada_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Mesmo gráfico anterior com as classes do grau ordenadas de cima para baixo.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de barras empilhadas horizontais com as classes de 'grau'</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ordenadas de cima para baixo (controle via levels do fator).</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Pacotes necessários</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"ggplot2"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"scales"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"scales"</span>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Dados (preservar ordem natural desejada das classes de grau)</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>ordem_grau <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ass"</span>, <span class="st">"bach"</span>, <span class="st">"ms"</span>, <span class="st">"dr"</span>)  <span class="co"># ordem desejada top -&gt; bottom no gráfico final</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>grausex <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">sex  =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"M"</span>, <span class="dv">2283</span>), <span class="fu">rep</span>(<span class="st">"H"</span>, <span class="dv">1622</span>)), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"H"</span>)),</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">grau =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"ass"</span>, <span class="dv">639</span>), <span class="fu">rep</span>(<span class="st">"bach"</span>, <span class="dv">1087</span>), <span class="fu">rep</span>(<span class="st">"ms"</span>, <span class="dv">460</span>), <span class="fu">rep</span>(<span class="st">"dr"</span>, <span class="dv">97</span>),</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">rep</span>(<span class="st">"ass"</span>, <span class="dv">402</span>), <span class="fu">rep</span>(<span class="st">"bach"</span>,  <span class="dv">804</span>), <span class="fu">rep</span>(<span class="st">"ms"</span>, <span class="dv">329</span>), <span class="fu">rep</span>(<span class="st">"dr"</span>, <span class="dv">87</span>)))</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparar data.frame de contagens por grau x sexo</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(grausex<span class="sc">$</span>grau, grausex<span class="sc">$</span>sex))</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"grau"</span>, <span class="st">"sexo"</span>, <span class="st">"contagem"</span>)</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Etiquetas legíveis para sexo</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>sexo <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>sexo, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"H"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Mulher"</span>, <span class="st">"Homem"</span>))</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Garantir que 'grau' preserve a ordem desejada no gráfico:</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Para que, após coord_flip(), a ordem apareça de cima para baixo como em ordem_grau,</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a><span class="co"># definimos os níveis como o reverso da ordem desejada.</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>grau <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(df<span class="sc">$</span>grau), <span class="at">levels =</span> <span class="fu">rev</span>(ordem_grau))</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular proporção de cada sexo dentro de cada grau: P(sexo | grau)</span></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>proporcao <span class="ot">&lt;-</span> df<span class="sc">$</span>contagem <span class="sc">/</span> <span class="fu">ave</span>(df<span class="sc">$</span>contagem, df<span class="sc">$</span>grau, <span class="at">FUN =</span> sum)</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Rótulo em porcentagem (apenas quando segmento suficientemente grande)</span></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>limite_label <span class="ot">&lt;-</span> <span class="fl">0.03</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>proporcao <span class="sc">&gt;=</span> limite_label, <span class="fu">percent</span>(df<span class="sc">$</span>proporcao, <span class="at">accuracy =</span> <span class="fl">0.1</span>), <span class="st">""</span>)</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Cor do rótulo para contraste (branco em segmentos grandes)</span></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>label_color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>proporcao <span class="sc">&gt;=</span> <span class="fl">0.15</span>, <span class="st">"white"</span>, <span class="st">"black"</span>)</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico: barras empilhadas horizontais (cada grau = 100%)</span></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> grau, <span class="at">y =</span> proporcao, <span class="at">fill =</span> sexo)) <span class="sc">+</span></span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"stack"</span>, <span class="at">width =</span> <span class="fl">0.7</span>, <span class="at">colour =</span> <span class="st">"grey20"</span>, <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label, <span class="at">colour =</span> label_color),</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_identity</span>() <span class="sc">+</span></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#4E79A7"</span>, <span class="st">"#F28E2B"</span>)) <span class="sc">+</span></span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Proporção de sexo por grau (cada grau = 100%) — empilhadas"</span>,</span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Grau"</span>,</span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Proporção"</span>,</span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Sexo"</span></span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()  <span class="co"># barras horizontais; ordem por níveis de 'grau' (já invertida acima)</span></span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibir gráfico</span></span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap6-moore-tab-dupla-entrada_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Fica claro agora que, nos EUA, a categoria Mulher na variável <code>sexo</code> obterá <u><strong>maior proporção</strong></u> (&gt; 50,0%) em cada uma das 4 categorias de <code>graus</code>.</p>
<p>No Brasil espera-se uma distribuição oposta a essa.</p>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Gráfico de Barras Segmentadas
</div>
</div>
<div class="callout-body-container callout-body">
<p>Um gráfico de barras segmentadas é <strong><em>um gráfico de barras para a apresentação de dados sobre duas variáveis categóricas no qual cada barra é dividida em partes</em></strong>. Cada barra representa as observações que assumem determinado valor de uma variável, e o <strong><em>comprimento de cada parte da barra representa a proporção daquelas observações que assumem um valor específico da segunda variável</em></strong>.</p>
</div>
</div>
<p>A Figura 6.4 mostra um gráfico de mosaico, que é uma variação de um gráfico de barras segmentadas.</p>
<p>Agora, as barras têm larguras diferentes, e essas larguras correspondem à proporção de estudantes em cada uma das quatro categorias de grau. Assim, as larguras mostram a distribuição marginal do grau conferido. Cada barra é, novamente, dividida (segmentada) em duas partes, representadas por dois tons de cinza. A porção superior (cinza-claro) de cada barra representa a proporção de mulheres entre os estudantes que receberam cada um dos graus. A outra porção (cinza-escuro) representa a proporção de homens. Cada barra tem altura de 100%, porque cada barra representa todos os adultos em cada grupo diferente de pessoas. O gráfico de mosaico é mais informativo do que o gráfico de barras segmentadas porque mostra a distribuição marginal do grau conferido, bem como a distribuição condicional de sexo, dado o grau conferido.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico mosaico para Grau x Sexo (preserva ordem dos níveis)</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Instala e carrega pacote vcd opcionalmente (melhor visual). Fallback para mosaicplot().</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"vcd"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"Pacote 'vcd' não encontrado — usando mosaicplot() base. Para visual mais rico, instale: install.packages('vcd')"</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(vcd)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar data.frame com fatores e ordem explícita dos níveis</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>grausex <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">sex  =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Mulher"</span>, <span class="dv">2283</span>), <span class="fu">rep</span>(<span class="st">"Homem"</span>, <span class="dv">1622</span>)), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Mulher"</span>, <span class="st">"Homem"</span>)),</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">grau =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"ass"</span>, <span class="dv">639</span>), <span class="fu">rep</span>(<span class="st">"bach"</span>, <span class="dv">1087</span>), <span class="fu">rep</span>(<span class="st">"ms"</span>, <span class="dv">460</span>), <span class="fu">rep</span>(<span class="st">"dr"</span>, <span class="dv">97</span>),</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">rep</span>(<span class="st">"ass"</span>, <span class="dv">402</span>), <span class="fu">rep</span>(<span class="st">"bach"</span>,  <span class="dv">804</span>), <span class="fu">rep</span>(<span class="st">"ms"</span>, <span class="dv">329</span>), <span class="fu">rep</span>(<span class="st">"dr"</span>, <span class="dv">87</span>)),</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"ass"</span>, <span class="st">"bach"</span>, <span class="st">"ms"</span>, <span class="st">"dr"</span>))</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabela de contingência (linhas = grau, colunas = sexo)</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">table</span>(grausex<span class="sc">$</span>grau, grausex<span class="sc">$</span>sex)</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibir tabela para conferência</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tab)</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Gráfico mosaico com vcd::mosaic (se disponível) ---</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="st">"vcd"</span> <span class="sc">%in%</span> <span class="fu">loadedNamespaces</span>()) {</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mosaic(~ grau + sex, ...) mostra pedaços por grau primeiro; shade colore conforme associação</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>  vcd<span class="sc">::</span><span class="fu">mosaic</span>(<span class="sc">~</span> grau <span class="sc">+</span> sex, <span class="at">data =</span> grausex,</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">shade =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>              <span class="at">main =</span> <span class="st">"Gráfico mosaico — Grau vs Sexo"</span>,</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>              <span class="at">labeling_args =</span> <span class="fu">list</span>(<span class="at">set_varnames =</span> <span class="fu">c</span>(<span class="at">grau =</span> <span class="st">"Grau"</span>, <span class="at">sex =</span> <span class="st">"Sexo"</span>))</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fallback: mosaicplot da base R</span></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note: mosaicplot espera tabela com categorias nas dimensões; color=TRUE usa paleta padrão</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mosaicplot</span>(tab,</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>             <span class="at">main =</span> <span class="st">"Gráfico mosaico — Grau vs Sexo (base)"</span>,</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>             <span class="at">xlab =</span> <span class="st">"Grau"</span>, <span class="at">ylab =</span> <span class="st">"Sexo"</span>,</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="cn">TRUE</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>      
       Mulher Homem
  ass     639   402
  bach   1087   804
  ms      460   329
  dr       97    87</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap6-moore-tab-dupla-entrada_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Gráfico de mosaico
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong><em>Um gráfico de barras segmentadas</em></strong> no qual a <strong><em>largura de cada barra representa a proporção de todas as observações que estão na categoria que a barra representa</em></strong>.</p>
</div>
</div>
<p>Mesmo gráfico acima indicando as percentagens no eixo y e seu valor dentro de cada mosaico.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Mosaic-like com eixo y em percentagem (corrigido)</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Corrige erro: "subset(...) deve ser lógico" substituindo uso incorreto de subset por indexação com match()</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"ggplot2"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"scales"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"scales"</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Dados (preservar ordem dos níveis)</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>grausex <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">sex  =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"M"</span>, <span class="dv">2283</span>), <span class="fu">rep</span>(<span class="st">"H"</span>, <span class="dv">1622</span>)), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"H"</span>)),</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">grau =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"ass"</span>, <span class="dv">639</span>), <span class="fu">rep</span>(<span class="st">"bach"</span>, <span class="dv">1087</span>), <span class="fu">rep</span>(<span class="st">"ms"</span>, <span class="dv">460</span>), <span class="fu">rep</span>(<span class="st">"dr"</span>, <span class="dv">97</span>),</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">rep</span>(<span class="st">"ass"</span>, <span class="dv">402</span>), <span class="fu">rep</span>(<span class="st">"bach"</span>,  <span class="dv">804</span>), <span class="fu">rep</span>(<span class="st">"ms"</span>, <span class="dv">329</span>), <span class="fu">rep</span>(<span class="st">"dr"</span>, <span class="dv">87</span>)),</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"ass"</span>, <span class="st">"bach"</span>, <span class="st">"ms"</span>, <span class="st">"dr"</span>))</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabela de contingência grau x sexo</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(grausex<span class="sc">$</span>grau, grausex<span class="sc">$</span>sex))</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tab) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"grau"</span>, <span class="st">"sexo"</span>, <span class="st">"contagem"</span>)</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Totais por grau e total geral</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>totais_grau <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(contagem <span class="sc">~</span> grau, <span class="at">data =</span> tab, sum)</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>total_geral <span class="ot">&lt;-</span> <span class="fu">sum</span>(totais_grau<span class="sc">$</span>contagem)</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Garantir ordem desejada das categorias de grau (usa levels do fator original)</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>ord <span class="ot">&lt;-</span> <span class="fu">levels</span>(grausex<span class="sc">$</span>grau)</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Obter as larguras (proporção de cada grau no total) na ordem correta</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a><span class="co"># CORREÇÃO: usar indexação com match() em vez de subset(...)</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>larguras <span class="ot">&lt;-</span> totais_grau[<span class="fu">match</span>(ord, totais_grau<span class="sc">$</span>grau), ]</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>larguras<span class="sc">$</span>prop <span class="ot">&lt;-</span> larguras<span class="sc">$</span>contagem <span class="sc">/</span> total_geral</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a><span class="co"># posições x para cada coluna (xmin/xmax)</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>larguras<span class="sc">$</span>cum_prev <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">head</span>(<span class="fu">cumsum</span>(larguras<span class="sc">$</span>prop), <span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>larguras<span class="sc">$</span>xmin <span class="ot">&lt;-</span> larguras<span class="sc">$</span>cum_prev</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>larguras<span class="sc">$</span>xmax <span class="ot">&lt;-</span> larguras<span class="sc">$</span>cum_prev <span class="sc">+</span> larguras<span class="sc">$</span>prop</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a><span class="co"># juntar totais por grau ao dataframe por linha</span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">merge</span>(tab, totais_grau, <span class="at">by =</span> <span class="st">"grau"</span>, <span class="at">suffixes =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"_grau"</span>))</span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tab)[<span class="fu">names</span>(tab) <span class="sc">==</span> <span class="st">"contagem_grau"</span>] <span class="ot">&lt;-</span> <span class="st">"total_grau"</span></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a><span class="co"># proporção dentro de cada grau (P(sexo | grau))</span></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>tab<span class="sc">$</span>prop_within_grau <span class="ot">&lt;-</span> tab<span class="sc">$</span>contagem <span class="sc">/</span> tab<span class="sc">$</span>total_grau</span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a><span class="co"># juntar posições x ao dataframe tab (mantendo ordem por grau)</span></span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">merge</span>(tab, larguras[, <span class="fu">c</span>(<span class="st">"grau"</span>, <span class="st">"xmin"</span>, <span class="st">"xmax"</span>)], <span class="at">by =</span> <span class="st">"grau"</span>)</span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a><span class="co"># calcular posições y (ymin, ymax) empilhadas dentro de cada grau</span></span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> tab[<span class="fu">order</span>(<span class="fu">match</span>(tab<span class="sc">$</span>grau, ord), tab<span class="sc">$</span>sexo), ]  <span class="co"># ordenar por grau na ordem desejada</span></span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(<span class="fu">split</span>(tab, tab<span class="sc">$</span>grau), <span class="cf">function</span>(dfg) {</span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>  dfg<span class="sc">$</span>ymin <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">head</span>(<span class="fu">cumsum</span>(dfg<span class="sc">$</span>prop_within_grau), <span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>  dfg<span class="sc">$</span>ymax <span class="ot">&lt;-</span> dfg<span class="sc">$</span>ymin <span class="sc">+</span> dfg<span class="sc">$</span>prop_within_grau</span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>  dfg</span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a><span class="co"># posições para rótulos (centro de cada segmento)</span></span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>tab<span class="sc">$</span>xmid <span class="ot">&lt;-</span> (tab<span class="sc">$</span>xmin <span class="sc">+</span> tab<span class="sc">$</span>xmax) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>tab<span class="sc">$</span>ymid <span class="ot">&lt;-</span> (tab<span class="sc">$</span>ymin <span class="sc">+</span> tab<span class="sc">$</span>ymax) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a><span class="co"># rótulo em percentagem e cor de rótulo para contraste</span></span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a>tab<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(tab<span class="sc">$</span>prop_within_grau <span class="sc">&gt;=</span> <span class="fl">0.03</span>, <span class="fu">percent</span>(tab<span class="sc">$</span>prop_within_grau, <span class="at">accuracy =</span> <span class="fl">0.1</span>), <span class="st">""</span>)</span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a>tab<span class="sc">$</span>label_col <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(tab<span class="sc">$</span>prop_within_grau <span class="sc">&gt;=</span> <span class="fl">0.15</span>, <span class="st">"white"</span>, <span class="st">"black"</span>)</span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Texto de rodapé (nota)</span></span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a>rodape <span class="ot">&lt;-</span> <span class="st">"Gráfico de mosaico comparando as proporções de mulheres e homens entre aqueles em cada categoria</span><span class="sc">\n</span><span class="st">de grau a ser conferido (n = 3905)."</span></span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot: retângulos com largura proporcional (mosaic-like) e y em percentagem</span></span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tab) <span class="sc">+</span></span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax, <span class="at">ymin =</span> ymin, <span class="at">ymax =</span> ymax, <span class="at">fill =</span> sexo),</span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">"grey30"</span>, <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb29-71"><a href="#cb29-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> xmid, <span class="at">y =</span> ymid, <span class="at">label =</span> label, <span class="at">colour =</span> label_col),</span>
<span id="cb29-72"><a href="#cb29-72" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb29-73"><a href="#cb29-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_identity</span>() <span class="sc">+</span></span>
<span id="cb29-74"><a href="#cb29-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.25</span>)) <span class="sc">+</span></span>
<span id="cb29-75"><a href="#cb29-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> (larguras<span class="sc">$</span>xmin <span class="sc">+</span> larguras<span class="sc">$</span>xmax) <span class="sc">/</span> <span class="dv">2</span>,</span>
<span id="cb29-76"><a href="#cb29-76" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> larguras<span class="sc">$</span>grau,</span>
<span id="cb29-77"><a href="#cb29-77" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb29-78"><a href="#cb29-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#4E79A7"</span>, <span class="st">"#F28E2B"</span>)) <span class="sc">+</span></span>
<span id="cb29-79"><a href="#cb29-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mosaico (estilo) — Grau x Sexo"</span>,</span>
<span id="cb29-80"><a href="#cb29-80" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Distribuição condicional do Sexo (%), uma vez dada a classe do Grau"</span>,</span>
<span id="cb29-81"><a href="#cb29-81" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Grau (largura proporcional ao total do grau)"</span>,</span>
<span id="cb29-82"><a href="#cb29-82" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proporção dentro do grau (percentagem)"</span>,</span>
<span id="cb29-83"><a href="#cb29-83" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> rodape,</span>
<span id="cb29-84"><a href="#cb29-84" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Sexo"</span>) <span class="sc">+</span></span>
<span id="cb29-85"><a href="#cb29-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-86"><a href="#cb29-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb29-87"><a href="#cb29-87" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb29-88"><a href="#cb29-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-89"><a href="#cb29-89" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb29-90"><a href="#cb29-90" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap6-moore-tab-dupla-entrada_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>A Figura 6.4 acima <strong><em>mostra apenas um dos dois conjuntos de distribuições condicionais</em></strong>.</p>
<p>Precisaríamos de outro gráfico para apresentar o outro (a distribuição condicional de grau conferido, dado o sexo). Também, os gráficos nas Figuras 6.3 e 6.4 indicam apenas porcentagens ou proporções, não contagens totais.</p>
<p>Script R comentado para o gráfico mosaico anterior agora para o <code>grau</code> dado o <code>sexo</code>.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Mosaic-like: Grau dado o Sexo (P(grau | sexo)) com rótulos "Mulher" / "Homem"</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Legenda de 'Grau' invertida (ordem mostrada de cima para baixo invertida)</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"ggplot2"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"scales"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"scales"</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Dados (sexos nomeados como "Mulher" e "Homem", ordem preservada)</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>grausex <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">sex  =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Mulher"</span>, <span class="dv">2283</span>), <span class="fu">rep</span>(<span class="st">"Homem"</span>, <span class="dv">1622</span>)), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Mulher"</span>, <span class="st">"Homem"</span>)),</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">grau =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"ass"</span>, <span class="dv">639</span>), <span class="fu">rep</span>(<span class="st">"bach"</span>, <span class="dv">1087</span>), <span class="fu">rep</span>(<span class="st">"ms"</span>, <span class="dv">460</span>), <span class="fu">rep</span>(<span class="st">"dr"</span>, <span class="dv">97</span>),</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">rep</span>(<span class="st">"ass"</span>, <span class="dv">402</span>), <span class="fu">rep</span>(<span class="st">"bach"</span>,  <span class="dv">804</span>), <span class="fu">rep</span>(<span class="st">"ms"</span>, <span class="dv">329</span>), <span class="fu">rep</span>(<span class="st">"dr"</span>, <span class="dv">87</span>)),</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"ass"</span>, <span class="st">"bach"</span>, <span class="st">"ms"</span>, <span class="st">"dr"</span>))</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabela de contagens por sexo x grau</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(grausex<span class="sc">$</span>sex, grausex<span class="sc">$</span>grau))</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tab) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sexo"</span>, <span class="st">"grau"</span>, <span class="st">"contagem"</span>)</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Totais por sexo e total geral (para larguras das colunas)</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>totais_sexo <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(contagem <span class="sc">~</span> sexo, <span class="at">data =</span> tab, sum)</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>total_geral <span class="ot">&lt;-</span> <span class="fu">sum</span>(totais_sexo<span class="sc">$</span>contagem)</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Garantir ordem desejada dos sexos e graus</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>ord_sexo <span class="ot">&lt;-</span> <span class="fu">levels</span>(grausex<span class="sc">$</span>sex)   <span class="co"># c("Mulher","Homem")</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>ord_grau <span class="ot">&lt;-</span> <span class="fu">levels</span>(grausex<span class="sc">$</span>grau)  <span class="co"># c("ass","bach","ms","dr")</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Larguras proporcionais por sexo (na ordem correta)</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>larguras <span class="ot">&lt;-</span> totais_sexo[<span class="fu">match</span>(ord_sexo, totais_sexo<span class="sc">$</span>sexo), ]</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>larguras<span class="sc">$</span>prop <span class="ot">&lt;-</span> larguras<span class="sc">$</span>contagem <span class="sc">/</span> total_geral</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>larguras<span class="sc">$</span>cum_prev <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">head</span>(<span class="fu">cumsum</span>(larguras<span class="sc">$</span>prop), <span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>larguras<span class="sc">$</span>xmin <span class="ot">&lt;-</span> larguras<span class="sc">$</span>cum_prev</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>larguras<span class="sc">$</span>xmax <span class="ot">&lt;-</span> larguras<span class="sc">$</span>cum_prev <span class="sc">+</span> larguras<span class="sc">$</span>prop</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Juntar totais ao dataframe por linha</span></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">merge</span>(tab, totais_sexo, <span class="at">by =</span> <span class="st">"sexo"</span>, <span class="at">suffixes =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"_sexo"</span>))</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tab)[<span class="fu">names</span>(tab) <span class="sc">==</span> <span class="st">"contagem_sexo"</span>] <span class="ot">&lt;-</span> <span class="st">"total_sexo"</span></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Proporção dentro de cada sexo: P(grau | sexo)</span></span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>tab<span class="sc">$</span>prop_within_sexo <span class="ot">&lt;-</span> tab<span class="sc">$</span>contagem <span class="sc">/</span> tab<span class="sc">$</span>total_sexo</span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Juntar posições x (xmin/xmax) ao dataframe tab</span></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">merge</span>(tab, larguras[, <span class="fu">c</span>(<span class="st">"sexo"</span>, <span class="st">"xmin"</span>, <span class="st">"xmax"</span>)], <span class="at">by =</span> <span class="st">"sexo"</span>)</span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular posições y empilhadas (ymin/ymax) dentro de cada sexo, mantendo ordem de grau</span></span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> tab[<span class="fu">order</span>(<span class="fu">match</span>(tab<span class="sc">$</span>sexo, ord_sexo), <span class="fu">match</span>(tab<span class="sc">$</span>grau, ord_grau)), ]</span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(<span class="fu">split</span>(tab, tab<span class="sc">$</span>sexo), <span class="cf">function</span>(dfg) {</span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>  dfg <span class="ot">&lt;-</span> dfg[<span class="fu">order</span>(<span class="fu">match</span>(dfg<span class="sc">$</span>grau, ord_grau)), ]</span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a>  dfg<span class="sc">$</span>ymin <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">head</span>(<span class="fu">cumsum</span>(dfg<span class="sc">$</span>prop_within_sexo), <span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a>  dfg<span class="sc">$</span>ymax <span class="ot">&lt;-</span> dfg<span class="sc">$</span>ymin <span class="sc">+</span> dfg<span class="sc">$</span>prop_within_sexo</span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a>  dfg</span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Posições para rótulos (centro de cada segmento)</span></span>
<span id="cb30-57"><a href="#cb30-57" aria-hidden="true" tabindex="-1"></a>tab<span class="sc">$</span>xmid <span class="ot">&lt;-</span> (tab<span class="sc">$</span>xmin <span class="sc">+</span> tab<span class="sc">$</span>xmax) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb30-58"><a href="#cb30-58" aria-hidden="true" tabindex="-1"></a>tab<span class="sc">$</span>ymid <span class="ot">&lt;-</span> (tab<span class="sc">$</span>ymin <span class="sc">+</span> tab<span class="sc">$</span>ymax) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb30-59"><a href="#cb30-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-60"><a href="#cb30-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Rótulos em percentagem (mostrar só quando segmento &gt;= 3% dentro do sexo)</span></span>
<span id="cb30-61"><a href="#cb30-61" aria-hidden="true" tabindex="-1"></a>tab<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(tab<span class="sc">$</span>prop_within_sexo <span class="sc">&gt;=</span> <span class="fl">0.03</span>, <span class="fu">percent</span>(tab<span class="sc">$</span>prop_within_sexo, <span class="at">accuracy =</span> <span class="fl">0.1</span>), <span class="st">""</span>)</span>
<span id="cb30-62"><a href="#cb30-62" aria-hidden="true" tabindex="-1"></a>tab<span class="sc">$</span>label_col <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(tab<span class="sc">$</span>prop_within_sexo <span class="sc">&gt;=</span> <span class="fl">0.15</span>, <span class="st">"white"</span>, <span class="st">"black"</span>)</span>
<span id="cb30-63"><a href="#cb30-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-64"><a href="#cb30-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Texto de rodapé (opcional)</span></span>
<span id="cb30-65"><a href="#cb30-65" aria-hidden="true" tabindex="-1"></a>rodape <span class="ot">&lt;-</span> <span class="st">"Gráfico de mosaico: proporção de graus dentro de cada sexo (P(grau | sexo))."</span></span>
<span id="cb30-66"><a href="#cb30-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-67"><a href="#cb30-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot: a única diferença em relação ao script anterior é a inversão da legenda de 'grau'</span></span>
<span id="cb30-68"><a href="#cb30-68" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tab) <span class="sc">+</span></span>
<span id="cb30-69"><a href="#cb30-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax, <span class="at">ymin =</span> ymin, <span class="at">ymax =</span> ymax, <span class="at">fill =</span> grau),</span>
<span id="cb30-70"><a href="#cb30-70" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">"grey30"</span>, <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb30-71"><a href="#cb30-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> xmid, <span class="at">y =</span> ymid, <span class="at">label =</span> label, <span class="at">colour =</span> label_col),</span>
<span id="cb30-72"><a href="#cb30-72" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb30-73"><a href="#cb30-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_identity</span>() <span class="sc">+</span></span>
<span id="cb30-74"><a href="#cb30-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.25</span>)) <span class="sc">+</span></span>
<span id="cb30-75"><a href="#cb30-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> (larguras<span class="sc">$</span>xmin <span class="sc">+</span> larguras<span class="sc">$</span>xmax) <span class="sc">/</span> <span class="dv">2</span>,</span>
<span id="cb30-76"><a href="#cb30-76" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> larguras<span class="sc">$</span>sexo,</span>
<span id="cb30-77"><a href="#cb30-77" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb30-78"><a href="#cb30-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">type =</span> <span class="st">"qual"</span>, <span class="at">palette =</span> <span class="st">"Set2"</span>, <span class="at">labels =</span> ord_grau) <span class="sc">+</span></span>
<span id="cb30-79"><a href="#cb30-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mosaic (estilo) — Grau dado o Sexo"</span>,</span>
<span id="cb30-80"><a href="#cb30-80" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Sexo (largura proporcional ao total por sexo)"</span>,</span>
<span id="cb30-81"><a href="#cb30-81" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proporção dentro do sexo (percentagem)"</span>,</span>
<span id="cb30-82"><a href="#cb30-82" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Grau"</span>,</span>
<span id="cb30-83"><a href="#cb30-83" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> rodape) <span class="sc">+</span></span>
<span id="cb30-84"><a href="#cb30-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span>   <span class="co"># INVERTE apenas a ordem da legenda de 'Grau'</span></span>
<span id="cb30-85"><a href="#cb30-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb30-86"><a href="#cb30-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb30-87"><a href="#cb30-87" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-88"><a href="#cb30-88" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">face =</span> <span class="st">"italic"</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">8</span>)))</span>
<span id="cb30-89"><a href="#cb30-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-90"><a href="#cb30-90" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb30-91"><a href="#cb30-91" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap6-moore-tab-dupla-entrada_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Gráficos!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Nenhum gráfico único retrata a forma da relação entre variáveis categóricas (como um diagrama de dispersão faz para variáveis quantitativas).</p>
<p>Nenhuma medida numérica única (como a correlação) resume a intensidade da associação.</p>
<p>Gráficos de barras são flexíveis o bastante para serem úteis, mas você deve pensar sobre quais comparações você deseja apresentar.</p>
<p>Para medidas numéricas, confiamos em porcentagens bem escolhidas. Convém você decidir de quais porcentagens você precisa.</p>
<p>Eis uma sugestão: <strong><em>se houver uma relação explicativa-resposta</em></strong>, <u><strong><em>compare</em></strong></u> as <strong><em>distribuições condicionais da variável resposta para os valores separados da variável explicativa</em></strong>. Se você acha que <u><strong><em>sexo influencia o grau conferido</em></strong></u>, <u><strong>compare</strong></u> as <u><strong><em>distribuições condicionais de grau conferido para cada categoria de sexo</em></strong></u>, como no Exemplo 6.3.</p>
</div>
</div>
</section><section id="aplique-seu-conhecimento-1" class="level3" data-number="7.3.2"><h3 data-number="7.3.2" class="anchored" data-anchor-id="aplique-seu-conhecimento-1">
<span class="header-section-number">7.3.2</span> Aplique seu conhecimento</h3>
<section id="videogames-e-conceitos.-1" class="level4" data-number="7.3.2.1"><h4 data-number="7.3.2.1" class="anchored" data-anchor-id="videogames-e-conceitos.-1">
<span class="header-section-number">7.3.2.1</span> 6.3 Videogames e conceitos.</h4>
<p>O Exercício 6.1 fornece os dados sobre a distribuição de conceitos de meninos que jogaram e não jogaram videogames.</p>
<p>Para <strong><em>ver a relação</em></strong> entre <code>conceitos</code> e <code>jogar videogames</code>, <u><strong>determine as distribuições condicionais de conceitos (a variável resposta) para jogadores e não jogadores</strong></u>. O que você conclui?</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar tabela agregada: Conceito x Jogaram videogame</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">736</span>, <span class="dv">450</span>, <span class="dv">193</span>,   <span class="co"># "Jogaram videogame"</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">205</span>, <span class="dv">144</span>,  <span class="dv">80</span>    <span class="co"># "Nunca jogaram videogame"</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(counts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Jogaram videogame"</span>, <span class="st">"Nunca jogaram videogame"</span>)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(counts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"As e Bs"</span>, <span class="st">"Cs"</span>, <span class="st">"Ds e Fs"</span>)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Converter para objeto table</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">as.table</span>(counts)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibir tabela de contagens</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Tabela de contagens (linhas = status, colunas = conceito):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tab)</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Distribuições condicionais: P(conceito | status) ---</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="co"># margin = 1 ==&gt; soma por linha = 1 (cada status)</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>condicional <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(tab, <span class="at">margin =</span> <span class="dv">1</span>)</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Distribuições condicionais P(conceito | status) (proporções):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(condicional, <span class="dv">4</span>))</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Distribuições condicionais P(conceito | status) (percentuais):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> condicional, <span class="dv">2</span>))</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Data.frame "long" com contagens e proporções (útil para plotagem) ---</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(tab)</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"status"</span>, <span class="st">"conceito"</span>, <span class="st">"contagem"</span>)</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a><span class="co"># proporção de cada conceito dentro do respectivo status</span></span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>proporcao <span class="ot">&lt;-</span> df<span class="sc">$</span>contagem <span class="sc">/</span> <span class="fu">ave</span>(df<span class="sc">$</span>contagem, df<span class="sc">$</span>status, <span class="at">FUN =</span> sum)</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>percent <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> df<span class="sc">$</span>proporcao, <span class="dv">2</span>)</span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Data.frame com contagem + proporção condicional (ordenado):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df)</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Tamanho da amostra:"</span>, <span class="fu">sum</span>(df<span class="sc">$</span>contagem),<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Teste de independência (opcional) ---</span></span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a><span class="co"># chisq &lt;- chisq.test(tab)</span></span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a><span class="co"># print(chisq)</span></span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Gráfico: barras empilhadas mostrando composição por status (cada barra = 100%) ---</span></span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"ggplot2"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"scales"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"scales"</span>)</span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Preservar ordem das categorias</span></span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>status <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>status, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Jogaram videogame"</span>, <span class="st">"Nunca jogaram videogame"</span>))</span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>conceito <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>conceito, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"As e Bs"</span>, <span class="st">"Cs"</span>, <span class="st">"Ds e Fs"</span>))</span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> status, <span class="at">y =</span> contagem, <span class="at">fill =</span> conceito)) <span class="sc">+</span></span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">colour =</span> <span class="st">"grey30"</span>, <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(proporcao <span class="sc">&gt;=</span> <span class="fl">0.03</span>, <span class="fu">percent</span>(proporcao, <span class="at">accuracy =</span> <span class="fl">0.1</span>), <span class="st">""</span>)),</span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_fill</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">colour =</span> <span class="st">"white"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Composição por Conceito dentro de cada Status de Jogar videogame"</span>,</span>
<span id="cb31-65"><a href="#cb31-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Status"</span>,</span>
<span id="cb31-66"><a href="#cb31-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Proporção dentro do status"</span>,</span>
<span id="cb31-67"><a href="#cb31-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Conceito"</span></span>
<span id="cb31-68"><a href="#cb31-68" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb31-69"><a href="#cb31-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb31-70"><a href="#cb31-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb31-71"><a href="#cb31-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-72"><a href="#cb31-72" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb31-73"><a href="#cb31-73" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Tabela de contagens (linhas = status, colunas = conceito):
                        As e Bs  Cs Ds e Fs
Jogaram videogame           736 450     193
Nunca jogaram videogame     205 144      80

Distribuições condicionais P(conceito | status) (proporções):
                        As e Bs   Cs Ds e Fs
Jogaram videogame          0.53 0.33    0.14
Nunca jogaram videogame    0.48 0.34    0.19

Distribuições condicionais P(conceito | status) (percentuais):
                        As e Bs Cs Ds e Fs
Jogaram videogame            53 33      14
Nunca jogaram videogame      48 34      19

Data.frame com contagem + proporção condicional (ordenado):
                   status conceito contagem proporcao percent
1       Jogaram videogame  As e Bs      736      0.53      53
2 Nunca jogaram videogame  As e Bs      205      0.48      48
3       Jogaram videogame       Cs      450      0.33      33
4 Nunca jogaram videogame       Cs      144      0.34      34
5       Jogaram videogame  Ds e Fs      193      0.14      14
6 Nunca jogaram videogame  Ds e Fs       80      0.19      19

Tamanho da amostra: 1808 </code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap6-moore-tab-dupla-entrada_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Considerando a variável <code>Jogar Videogame</code> como explicativa e a variável <code>Conceito</code> como resposta, então os meninos que já jogaram apresentam Conceito A ou B em maior proporção (53,4%) que aqueles que nunca jograram (47,8%).</p>
<p>Os jogadores tiveram conceitos um pouco maiores que os não jogadores, é o que podemos dizer, <strong><em>mas isso poderia se dever ao acaso</em></strong>.</p>
<p>Muito embora a amostra tenha um tamanho = 1808.</p>
<p>Não pode esquecer da reflexão sobre variáveis ocultas.</p>
<p><strong>Qual as possíveis variáveis ocultas nesse exemplo?</strong></p>
</section><section id="idades-de-universitários.-1" class="level4" data-number="7.3.2.2"><h4 data-number="7.3.2.2" class="anchored" data-anchor-id="idades-de-universitários.-1">
<span class="header-section-number">7.3.2.2</span> 6.3 Idades de universitários.</h4>
<p>O Exercício 6.2 fornece dados do <em>U.S. Census Bureau</em> que descrevem a <code>idade</code> e o <code>sexo</code> de todos os estudantes universitários americanos.</p>
<p>Suspeitamos de que o percentual de mulheres seja maior entre estudantes na faixa etária de 25 a 34 anos do que na faixa etária de 20 a 24 anos. Os dados apoiam essa suspeita? Siga o processo dos quatro passos, como ilustrado no Exemplo 6.3.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Análise: comparar percentual de mulheres em 25-34 vs 20-24</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Entrada: tabela longa com colunas Age, Sex, Count (conforme fornecido)</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Saídas:</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - Distribuições condicionais P(Mulher | faixa)</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - Teste de duas proporções (unilateral H1: p25-34 &gt; p20-24)</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co"># - Gráfico das proporções com IC95%</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Pacotes</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"dplyr"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"dplyr"</span>)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"ggplot2"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"scales"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"scales"</span>)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr); <span class="fu">library</span>(ggplot2); <span class="fu">library</span>(scales)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Criar data.frame a partir da tabela longa fornecida ---</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">Age  =</span> <span class="fu">c</span>(<span class="st">"15to19"</span>,<span class="st">"20to24"</span>,<span class="st">"25to34"</span>,<span class="st">"35up"</span>,</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>           <span class="st">"15to19"</span>,<span class="st">"20to24"</span>,<span class="st">"25to34"</span>,<span class="st">"35up"</span>),</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sex  =</span> <span class="fu">c</span>(<span class="st">"Female"</span>,<span class="st">"Female"</span>,<span class="st">"Female"</span>,<span class="st">"Female"</span>,</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Male"</span>,<span class="st">"Male"</span>,<span class="st">"Male"</span>,<span class="st">"Male"</span>),</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">Count =</span> <span class="fu">c</span>(<span class="dv">2348</span>, <span class="dv">4280</span>, <span class="dv">2166</span>, <span class="dv">1492</span>,</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>            <span class="dv">1831</span>, <span class="dv">3713</span>, <span class="dv">1714</span>,  <span class="dv">853</span>),</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibir tamanho da amostra</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">total das contagens (tamanho amostra) n:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>( <span class="fu">sum</span>(df_long<span class="sc">$</span>Count) )</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Padronizar rótulos de sexo para pt-BR (opcional)</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> df_long <span class="sc">%&gt;%</span></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sexo =</span> <span class="fu">case_when</span>(</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tolower</span>(Sex) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"female"</span>, <span class="st">"f"</span>) <span class="sc">~</span> <span class="st">"Mulher"</span>,</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tolower</span>(Sex) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"male"</span>, <span class="st">"m"</span>)   <span class="sc">~</span> <span class="st">"Homem"</span>,</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> Sex</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">faixa =</span> <span class="fu">case_when</span>(</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>    Age <span class="sc">==</span> <span class="st">"15to19"</span> <span class="sc">~</span> <span class="st">"15-19"</span>,</span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>    Age <span class="sc">==</span> <span class="st">"20to24"</span> <span class="sc">~</span> <span class="st">"20-24"</span>,</span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>    Age <span class="sc">==</span> <span class="st">"25to34"</span> <span class="sc">~</span> <span class="st">"25-34"</span>,</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>    Age <span class="sc">==</span> <span class="st">"35up"</span>   <span class="sc">~</span> <span class="st">"35+"</span>,</span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> Age</span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(faixa, sexo, Count)</span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Calcular totais por faixa e proporções condicionais P(Mulher | faixa) ---</span></span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>totais_faixa <span class="ot">&lt;-</span> df_long <span class="sc">%&gt;%</span></span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(faixa) <span class="sc">%&gt;%</span></span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_faixa =</span> <span class="fu">sum</span>(Count), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> df_long <span class="sc">%&gt;%</span></span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(totais_faixa, <span class="at">by =</span> <span class="st">"faixa"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proporcao =</span> Count <span class="sc">/</span> total_faixa) <span class="sc">%&gt;%</span></span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(faixa, <span class="fu">desc</span>(sexo))</span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibir tabela resumida</span></span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Distribuição por faixa e sexo (contagens e proporções):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(res)</span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Extrair números necessários para as duas faixas de interesse ---</span></span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a>n_20_24 <span class="ot">&lt;-</span> res <span class="sc">%&gt;%</span> <span class="fu">filter</span>(faixa <span class="sc">==</span> <span class="st">"20-24"</span>, sexo <span class="sc">==</span> <span class="st">"Mulher"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Count)</span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a>N_20_24 <span class="ot">&lt;-</span> res <span class="sc">%&gt;%</span> <span class="fu">filter</span>(faixa <span class="sc">==</span> <span class="st">"20-24"</span>) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(total_faixa)</span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a>n_25_34 <span class="ot">&lt;-</span> res <span class="sc">%&gt;%</span> <span class="fu">filter</span>(faixa <span class="sc">==</span> <span class="st">"25-34"</span>, sexo <span class="sc">==</span> <span class="st">"Mulher"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Count)</span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a>N_25_34 <span class="ot">&lt;-</span> res <span class="sc">%&gt;%</span> <span class="fu">filter</span>(faixa <span class="sc">==</span> <span class="st">"25-34"</span>) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(total_faixa)</span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Segurança caso algum esteja NA</span></span>
<span id="cb33-68"><a href="#cb33-68" aria-hidden="true" tabindex="-1"></a>n_20_24 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">length</span>(n_20_24)<span class="sc">==</span><span class="dv">0</span>, <span class="dv">0</span>, n_20_24)</span>
<span id="cb33-69"><a href="#cb33-69" aria-hidden="true" tabindex="-1"></a>n_25_34 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">length</span>(n_25_34)<span class="sc">==</span><span class="dv">0</span>, <span class="dv">0</span>, n_25_34)</span>
<span id="cb33-70"><a href="#cb33-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-71"><a href="#cb33-71" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Teste de duas proporções (unilateral)</span></span>
<span id="cb33-72"><a href="#cb33-72" aria-hidden="true" tabindex="-1"></a><span class="co"># H0: p20-24 = p25-34  vs  H1: p25-34 &gt; p20-24</span></span>
<span id="cb33-73"><a href="#cb33-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Usamos prop.test com x = c(x1, x2) e n = c(n1, n2); alternative = "less"</span></span>
<span id="cb33-74"><a href="#cb33-74" aria-hidden="true" tabindex="-1"></a><span class="co"># (colocamos p1 = 20-24, p2 = 25-34; alternative = "less" testa p1 &lt; p2)</span></span>
<span id="cb33-75"><a href="#cb33-75" aria-hidden="true" tabindex="-1"></a>prop_test <span class="ot">&lt;-</span> <span class="fu">prop.test</span>(<span class="at">x =</span> <span class="fu">c</span>(n_20_24, n_25_34),</span>
<span id="cb33-76"><a href="#cb33-76" aria-hidden="true" tabindex="-1"></a>                       <span class="at">n =</span> <span class="fu">c</span>(N_20_24, N_25_34),</span>
<span id="cb33-77"><a href="#cb33-77" aria-hidden="true" tabindex="-1"></a>                       <span class="at">alternative =</span> <span class="st">"less"</span>,</span>
<span id="cb33-78"><a href="#cb33-78" aria-hidden="true" tabindex="-1"></a>                       <span class="at">correct =</span> <span class="cn">FALSE</span>)</span>
<span id="cb33-79"><a href="#cb33-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-80"><a href="#cb33-80" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Teste de duas proporções (unilateral H1: p25-34 &gt; p20-24) ---</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-81"><a href="#cb33-81" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(prop_test)</span>
<span id="cb33-82"><a href="#cb33-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-83"><a href="#cb33-83" aria-hidden="true" tabindex="-1"></a><span class="co"># --- IC95% para cada proporção individual (para plotagem) ---</span></span>
<span id="cb33-84"><a href="#cb33-84" aria-hidden="true" tabindex="-1"></a>ci_20 <span class="ot">&lt;-</span> <span class="fu">prop.test</span>(n_20_24, N_20_24, <span class="at">correct =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>conf.int</span>
<span id="cb33-85"><a href="#cb33-85" aria-hidden="true" tabindex="-1"></a>ci_25 <span class="ot">&lt;-</span> <span class="fu">prop.test</span>(n_25_34, N_25_34, <span class="at">correct =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>conf.int</span>
<span id="cb33-86"><a href="#cb33-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-87"><a href="#cb33-87" aria-hidden="true" tabindex="-1"></a>plot_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb33-88"><a href="#cb33-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">faixa =</span> <span class="fu">c</span>(<span class="st">"20-24"</span>,<span class="st">"25-34"</span>),</span>
<span id="cb33-89"><a href="#cb33-89" aria-hidden="true" tabindex="-1"></a>  <span class="at">proporcao =</span> <span class="fu">c</span>(n_20_24 <span class="sc">/</span> N_20_24, n_25_34 <span class="sc">/</span> N_25_34),</span>
<span id="cb33-90"><a href="#cb33-90" aria-hidden="true" tabindex="-1"></a>  <span class="at">ci_low =</span> <span class="fu">c</span>(ci_20[<span class="dv">1</span>], ci_25[<span class="dv">1</span>]),</span>
<span id="cb33-91"><a href="#cb33-91" aria-hidden="true" tabindex="-1"></a>  <span class="at">ci_upp =</span> <span class="fu">c</span>(ci_20[<span class="dv">2</span>], ci_25[<span class="dv">2</span>])</span>
<span id="cb33-92"><a href="#cb33-92" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-93"><a href="#cb33-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-94"><a href="#cb33-94" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Gráfico: proporções com IC95% ---</span></span>
<span id="cb33-95"><a href="#cb33-95" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_df, <span class="fu">aes</span>(<span class="at">x =</span> faixa, <span class="at">y =</span> proporcao, <span class="at">fill =</span> faixa)) <span class="sc">+</span></span>
<span id="cb33-96"><a href="#cb33-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb33-97"><a href="#cb33-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ci_low, <span class="at">ymax =</span> ci_upp), <span class="at">width =</span> <span class="fl">0.12</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb33-98"><a href="#cb33-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>(proporcao, <span class="at">accuracy =</span> <span class="fl">0.1</span>)),</span>
<span id="cb33-99"><a href="#cb33-99" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.6</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb33-100"><a href="#cb33-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb33-101"><a href="#cb33-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Proporção de mulheres por faixa etária"</span>,</span>
<span id="cb33-102"><a href="#cb33-102" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Comparação entre 20-24 e 25-34 anos"</span>,</span>
<span id="cb33-103"><a href="#cb33-103" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Faixa etária (anos)"</span>,</span>
<span id="cb33-104"><a href="#cb33-104" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proporção de mulheres (IC95%)"</span>) <span class="sc">+</span></span>
<span id="cb33-105"><a href="#cb33-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb33-106"><a href="#cb33-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-107"><a href="#cb33-107" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Interpretação simples automática ---</span></span>
<span id="cb33-108"><a href="#cb33-108" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> prop_test<span class="sc">$</span>p.value</span>
<span id="cb33-109"><a href="#cb33-109" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Interpretação (teste unilaeral):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-110"><a href="#cb33-110" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (pval <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb33-111"><a href="#cb33-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"p = %.4f &lt; 0.05: evidência de que a proporção de mulheres é maior em 25-34 do que em 20-24.</span><span class="sc">\n</span><span class="st">"</span>, pval))</span>
<span id="cb33-112"><a href="#cb33-112" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb33-113"><a href="#cb33-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"p = %.4f &gt;= 0.05: sem evidência suficiente de que a proporção de mulheres seja maior em 25-34.</span><span class="sc">\n</span><span class="st">"</span>, pval))</span>
<span id="cb33-114"><a href="#cb33-114" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-115"><a href="#cb33-115" aria-hidden="true" tabindex="-1"></a><span class="co"># FIM</span></span>
<span id="cb33-116"><a href="#cb33-116" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
total das contagens (tamanho amostra) n:
[1] 18397

Distribuição por faixa e sexo (contagens e proporções):
  faixa   sexo Count total_faixa proporcao
1 15-19 Mulher  2348        4179      0.56
2 15-19  Homem  1831        4179      0.44
3 20-24 Mulher  4280        7993      0.54
4 20-24  Homem  3713        7993      0.46
5 25-34 Mulher  2166        3880      0.56
6 25-34  Homem  1714        3880      0.44
7   35+ Mulher  1492        2345      0.64
8   35+  Homem   853        2345      0.36

--- Teste de duas proporções (unilateral H1: p25-34 &gt; p20-24) ---

    2-sample test for equality of proportions without continuity correction

data:  c(n_20_24, n_25_34) out of c(N_20_24, N_25_34)
X-squared = 5, df = 1, p-value = 0.01
alternative hypothesis: less
95 percent confidence interval:
 -1.0000 -0.0068
sample estimates:
prop 1 prop 2 
  0.54   0.56 


Interpretação (teste unilaeral):
p = 0.0097 &lt; 0.05: evidência de que a proporção de mulheres é maior em 25-34 do que em 20-24.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap6-moore-tab-dupla-entrada_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>É preciso cuidado na interpretação dessas saídas, pois um grande tamanho de amostra pode capturar pequenas diferenças entre as duas categorias, que podem não ser <strong>praticamente significativas</strong>.</p>
</section></section></section><section id="paradoxo-de-simpson" class="level2" data-number="7.4"><h2 data-number="7.4" class="anchored" data-anchor-id="paradoxo-de-simpson">
<span class="header-section-number">7.4</span> Paradoxo de Simpson</h2>
<p>Como no caso de variáveis quantitativas, os efeitos de <u><strong>variáveis ocultas</strong></u> podem mudar, ou mesmo inverter, relações entre duas variáveis categóricas. Aqui está um exemplo que demonstra as surpresas com as quais um usuário de dados menos avisado pode se defrontar.</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemplo do Paradoxo de Simpson: socorro por Helicóptero vs Ambulância</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Em cada estrato (Leve / Grave) Helicóptero tem maior taxa de sobrevivência,</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># mas ao agregar os dados Ambulância apresenta taxa global maior.</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Dados hipotéticos construídos para ilustrar o paradoxo.</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Pacotes necessários</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"dplyr"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"dplyr"</span>)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"ggplot2"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"scales"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"scales"</span>)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Construção dos dados (contagens) ---</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Estratos: "Leve" e "Grave"</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Notação: successes = sobreviventes, total = número de acidentados atendidos</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Projeto intencional:</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="co"># - Helicóptero tem taxas maiores em ambos os estratos</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="co"># - Ambulância atende muito mais casos no estrato com alta taxa, invertendo o resultado agregado</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>df_counts <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">estrato =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Leve"</span>, <span class="st">"Grave"</span>), <span class="at">each =</span> <span class="dv">2</span>),</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">transporte =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Helicóptero"</span>, <span class="st">"Ambulância"</span>), <span class="at">times =</span> <span class="dv">2</span>),</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">success =</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">72</span>,    <span class="co"># Leve: H = 9/10 (0.90), A = 72/90 (0.80)</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>              <span class="dv">63</span>, <span class="dv">6</span>),   <span class="co"># Grave: H = 63/90 (0.70), A = 6/10  (0.60)</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">total =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">90</span>,     <span class="co"># totais correspondentes</span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>            <span class="dv">90</span>, <span class="dv">10</span>),</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular taxas por célula</span></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>df_counts <span class="ot">&lt;-</span> df_counts <span class="sc">%&gt;%</span></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rate =</span> success <span class="sc">/</span> total)</span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar tabela de contingência formatada</span></span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Tabela de contagens (cada linha = estrato x transporte):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df_counts)</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Comparações por estrato (teste de proporção) ---</span></span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Testes por estrato (Helicóptero vs Ambulância):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (e <span class="cf">in</span> <span class="fu">unique</span>(df_counts<span class="sc">$</span>estrato)) {</span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>  sub <span class="ot">&lt;-</span> df_counts <span class="sc">%&gt;%</span> <span class="fu">filter</span>(estrato <span class="sc">==</span> e) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(transporte)</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># x: successes para os dois grupos; n: totals</span></span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> sub<span class="sc">$</span>success</span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> sub<span class="sc">$</span>total</span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># prop.test compara as duas proporções (2 grupos)</span></span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>  tst <span class="ot">&lt;-</span> <span class="fu">prop.test</span>(<span class="at">x =</span> x, <span class="at">n =</span> n, <span class="at">correct =</span> <span class="cn">FALSE</span>)</span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Estrato: %s</span><span class="sc">\n</span><span class="st">"</span>, e))</span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(sub)</span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(tst)</span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Agregado: somar successes e totals por transporte ---</span></span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a>totais <span class="ot">&lt;-</span> df_counts <span class="sc">%&gt;%</span></span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(transporte) <span class="sc">%&gt;%</span></span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">success =</span> <span class="fu">sum</span>(success), <span class="at">total =</span> <span class="fu">sum</span>(total), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rate =</span> success <span class="sc">/</span> total)</span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Totais agregados por transporte:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(totais)</span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Teste agregado (Helicóptero vs Ambulância)</span></span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a>tst_global <span class="ot">&lt;-</span> <span class="fu">prop.test</span>(<span class="at">x =</span> totais<span class="sc">$</span>success, <span class="at">n =</span> totais<span class="sc">$</span>total, <span class="at">correct =</span> <span class="cn">FALSE</span>)</span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Teste agregado (Helicóptero vs Ambulância):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tst_global)</span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Visualização: taxas por estrato e agregado ---</span></span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparar dados para plot: taxas estrato-por-estrato + linha do agregado</span></span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a>plot_df <span class="ot">&lt;-</span> df_counts <span class="sc">%&gt;%</span></span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estrato =</span> <span class="fu">factor</span>(estrato, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Leve"</span>, <span class="st">"Grave"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(estrato, transporte, rate, success, total)</span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Dados agregados para adicionar como painel "Agregado"</span></span>
<span id="cb35-76"><a href="#cb35-76" aria-hidden="true" tabindex="-1"></a>agregado_panel <span class="ot">&lt;-</span> totais <span class="sc">%&gt;%</span></span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estrato =</span> <span class="st">"Agregado"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-78"><a href="#cb35-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(estrato, transporte, rate, success, total)</span>
<span id="cb35-79"><a href="#cb35-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-80"><a href="#cb35-80" aria-hidden="true" tabindex="-1"></a>plot_df_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(plot_df, agregado_panel) <span class="sc">%&gt;%</span></span>
<span id="cb35-81"><a href="#cb35-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estrato =</span> <span class="fu">factor</span>(estrato, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Leve"</span>, <span class="st">"Grave"</span>, <span class="st">"Agregado"</span>)))</span>
<span id="cb35-82"><a href="#cb35-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-83"><a href="#cb35-83" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_df_all, <span class="fu">aes</span>(<span class="at">x =</span> transporte, <span class="at">y =</span> rate, <span class="at">fill =</span> transporte)) <span class="sc">+</span></span>
<span id="cb35-84"><a href="#cb35-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb35-85"><a href="#cb35-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(success, <span class="st">"/"</span>, total, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">percent</span>(rate, <span class="at">accuracy =</span> <span class="fl">0.1</span>))),</span>
<span id="cb35-86"><a href="#cb35-86" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.6</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb35-87"><a href="#cb35-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> estrato, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb35-88"><a href="#cb35-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb35-89"><a href="#cb35-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Helicóptero"</span> <span class="ot">=</span> <span class="st">"#4E79A7"</span>, <span class="st">"Ambulância"</span> <span class="ot">=</span> <span class="st">"#F28E2B"</span>)) <span class="sc">+</span></span>
<span id="cb35-90"><a href="#cb35-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Exemplo do Paradoxo de Simpson — Socorro por Helicóptero vs Ambulância"</span>,</span>
<span id="cb35-91"><a href="#cb35-91" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Em cada estrato Helicóptero tem taxa maior; agregado favorece Ambulância"</span>,</span>
<span id="cb35-92"><a href="#cb35-92" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Taxa de sobrevivência"</span>,</span>
<span id="cb35-93"><a href="#cb35-93" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Dados hipotéticos ilustrativos"</span>) <span class="sc">+</span></span>
<span id="cb35-94"><a href="#cb35-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb35-95"><a href="#cb35-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb35-96"><a href="#cb35-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-97"><a href="#cb35-97" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb35-98"><a href="#cb35-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-99"><a href="#cb35-99" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Interpretação curta ---</span></span>
<span id="cb35-100"><a href="#cb35-100" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Interpretação:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb35-101"><a href="#cb35-101" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Em cada estrato (Leve e Grave) a taxa de sobrevivência do Helicóptero é maior que a da Ambulância.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb35-102"><a href="#cb35-102" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- No entanto, devido à distribuição muito diferente do número de pacientes entre estratos para cada transporte</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb35-103"><a href="#cb35-103" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  (ambulância atende muitos casos no estrato com alta taxa), a taxa global da Ambulância é maior.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb35-104"><a href="#cb35-104" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Esse é o Paradoxo de Simpson: a tendência observada em cada estrato pode ser invertida ao agregar os dados.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb35-105"><a href="#cb35-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-106"><a href="#cb35-106" aria-hidden="true" tabindex="-1"></a><span class="co"># Fim</span></span>
<span id="cb35-107"><a href="#cb35-107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Tabela de contagens (cada linha = estrato x transporte):
  estrato  transporte success total rate
1    Leve Helicóptero       9    10  0.9
2    Leve  Ambulância      72    90  0.8
3   Grave Helicóptero      63    90  0.7
4   Grave  Ambulância       6    10  0.6

Testes por estrato (Helicóptero vs Ambulância):

Estrato: Leve
  estrato  transporte success total rate
1    Leve  Ambulância      72    90  0.8
2    Leve Helicóptero       9    10  0.9

    2-sample test for equality of proportions without continuity correction

data:  x out of n
X-squared = 0.6, df = 1, p-value = 0.4
alternative hypothesis: two.sided
95 percent confidence interval:
 -0.3  0.1
sample estimates:
prop 1 prop 2 
   0.8    0.9 


Estrato: Grave
  estrato  transporte success total rate
1   Grave  Ambulância       6    10  0.6
2   Grave Helicóptero      63    90  0.7

    2-sample test for equality of proportions without continuity correction

data:  x out of n
X-squared = 0.4, df = 1, p-value = 0.5
alternative hypothesis: two.sided
95 percent confidence interval:
 -0.42  0.22
sample estimates:
prop 1 prop 2 
   0.6    0.7 


Totais agregados por transporte:
# A tibble: 2 × 4
  transporte  success total  rate
  &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Ambulância       78   100  0.78
2 Helicóptero      72   100  0.72

Teste agregado (Helicóptero vs Ambulância):

    2-sample test for equality of proportions without continuity correction

data:  totais$success out of totais$total
X-squared = 1, df = 1, p-value = 0.3
alternative hypothesis: two.sided
95 percent confidence interval:
 -0.06  0.18
sample estimates:
prop 1 prop 2 
  0.78   0.72 


Interpretação:
- Em cada estrato (Leve e Grave) a taxa de sobrevivência do Helicóptero é maior que a da Ambulância.
- No entanto, devido à distribuição muito diferente do número de pacientes entre estratos para cada transporte
  (ambulância atende muitos casos no estrato com alta taxa), a taxa global da Ambulância é maior.
- Esse é o Paradoxo de Simpson: a tendência observada em cada estrato pode ser invertida ao agregar os dados.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap6-moore-tab-dupla-entrada_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="verifique-suas-habilidades" class="level2" data-number="7.5"><h2 data-number="7.5" class="anchored" data-anchor-id="verifique-suas-habilidades">
<span class="header-section-number">7.5</span> Verifique suas habilidades</h2>
<p>Redes sociais</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Script: calculo de distribuições marginal e condicional</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Como usar: execute no R ou RStudio: source("scripts/distribuicoes_marginais_condicionais.R")</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Monta a tabela de contingência com os valores fornecidos</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>idades <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"18-29"</span>, <span class="st">"30-49"</span>, <span class="st">"50-64"</span>, <span class="st">"65+"</span>)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>respostas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Sim"</span>, <span class="st">"Não"</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Os valores estão em ordem por linha: (Sim, Não) para cada faixa etária</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">212</span>, <span class="dv">24</span>,   <span class="co"># Idade 18-29</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>    <span class="dv">324</span>, <span class="dv">71</span>,   <span class="co"># Idade 30-49</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    <span class="dv">293</span>, <span class="dv">131</span>,  <span class="co"># Idade 50-64</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    <span class="dv">156</span>, <span class="dv">235</span>   <span class="co"># Idade 65+</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="fu">length</span>(idades),</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(counts) <span class="ot">&lt;-</span> idades</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(counts) <span class="ot">&lt;-</span> respostas</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostra a tabela bruta</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Tabela de contingência (frequências absolutas):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(counts)</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Total geral</span></span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>total <span class="ot">&lt;-</span> <span class="fu">sum</span>(counts)</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Total geral:"</span>, total, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Distribuições marginais</span></span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a><span class="co"># - Marginal por idade (soma por linha)</span></span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>marginal_idade <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(counts)</span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a><span class="co"># - Marginal por resposta (soma por coluna)</span></span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>marginal_resposta <span class="ot">&lt;-</span> <span class="fu">colSums</span>(counts)</span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Distribuição marginal por idade (frequências):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(marginal_idade)</span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Distribuição marginal por resposta (frequências):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(marginal_resposta)</span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Também em proporções (frações do total) e em percentuais</span></span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a>prop_marginal_idade <span class="ot">&lt;-</span> marginal_idade <span class="sc">/</span> total</span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a>prop_marginal_resposta <span class="ot">&lt;-</span> marginal_resposta <span class="sc">/</span> total</span>
<span id="cb37-48"><a href="#cb37-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-49"><a href="#cb37-49" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Distribuição marginal por idade (percentual):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb37-50"><a href="#cb37-50" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(prop_marginal_idade <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>))</span>
<span id="cb37-51"><a href="#cb37-51" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Distribuição marginal por resposta (percentual):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb37-52"><a href="#cb37-52" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(prop_marginal_resposta <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>))</span>
<span id="cb37-53"><a href="#cb37-53" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb37-54"><a href="#cb37-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-55"><a href="#cb37-55" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Distribuição conjunta em proporções (tabela de proporções)</span></span>
<span id="cb37-56"><a href="#cb37-56" aria-hidden="true" tabindex="-1"></a>prop_conjunta <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(counts)  <span class="co"># por padrão divide por total</span></span>
<span id="cb37-57"><a href="#cb37-57" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Tabela conjunta (proporções):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb37-58"><a href="#cb37-58" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(prop_conjunta, <span class="dv">4</span>))</span>
<span id="cb37-59"><a href="#cb37-59" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Tabela conjunta (percentual):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb37-60"><a href="#cb37-60" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(prop_conjunta <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>))</span>
<span id="cb37-61"><a href="#cb37-61" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb37-62"><a href="#cb37-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-63"><a href="#cb37-63" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) Distribuições condicionais</span></span>
<span id="cb37-64"><a href="#cb37-64" aria-hidden="true" tabindex="-1"></a><span class="co"># a) Condicional por linha: P(Resposta | Idade)  =&gt; prop.table com margin = 1</span></span>
<span id="cb37-65"><a href="#cb37-65" aria-hidden="true" tabindex="-1"></a>condicional_por_idade <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(counts, <span class="at">margin =</span> <span class="dv">1</span>)</span>
<span id="cb37-66"><a href="#cb37-66" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P(Resposta | Idade) — probabilidade de 'Sim' ou 'Não' dado a faixa etária (linhas somam 1):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb37-67"><a href="#cb37-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(condicional_por_idade, <span class="dv">4</span>))</span>
<span id="cb37-68"><a href="#cb37-68" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Em percentuais:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb37-69"><a href="#cb37-69" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(condicional_por_idade <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>))</span>
<span id="cb37-70"><a href="#cb37-70" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb37-71"><a href="#cb37-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-72"><a href="#cb37-72" aria-hidden="true" tabindex="-1"></a><span class="co"># b) Condicional por coluna: P(Idade | Resposta) =&gt; prop.table com margin = 2</span></span>
<span id="cb37-73"><a href="#cb37-73" aria-hidden="true" tabindex="-1"></a>condicional_por_resposta <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(counts, <span class="at">margin =</span> <span class="dv">2</span>)</span>
<span id="cb37-74"><a href="#cb37-74" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P(Idade | Resposta) — distribuição etária entre quem disse 'Sim' ou 'Não' (colunas somam 1):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb37-75"><a href="#cb37-75" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(condicional_por_resposta, <span class="dv">4</span>))</span>
<span id="cb37-76"><a href="#cb37-76" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Em percentuais:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb37-77"><a href="#cb37-77" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(condicional_por_resposta <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>))</span>
<span id="cb37-78"><a href="#cb37-78" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb37-79"><a href="#cb37-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-80"><a href="#cb37-80" aria-hidden="true" tabindex="-1"></a><span class="co"># 5) Exemplos de acesso aos valores:</span></span>
<span id="cb37-81"><a href="#cb37-81" aria-hidden="true" tabindex="-1"></a><span class="co"># P(Sim | 18-29)</span></span>
<span id="cb37-82"><a href="#cb37-82" aria-hidden="true" tabindex="-1"></a>p_sim_18_29 <span class="ot">&lt;-</span> condicional_por_idade[<span class="st">"18-29"</span>, <span class="st">"Sim"</span>]</span>
<span id="cb37-83"><a href="#cb37-83" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P(Sim | 18-29) ="</span>, <span class="fu">round</span>(p_sim_18_29, <span class="dv">4</span>), <span class="st">"("</span>, <span class="fu">round</span>(p_sim_18_29<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>), <span class="st">"% )</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb37-84"><a href="#cb37-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-85"><a href="#cb37-85" aria-hidden="true" tabindex="-1"></a><span class="co"># P(18-29 | Sim)</span></span>
<span id="cb37-86"><a href="#cb37-86" aria-hidden="true" tabindex="-1"></a>p_18_29_sim <span class="ot">&lt;-</span> condicional_por_resposta[<span class="st">"18-29"</span>, <span class="st">"Sim"</span>]</span>
<span id="cb37-87"><a href="#cb37-87" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P(18-29 | Sim) ="</span>, <span class="fu">round</span>(p_18_29_sim, <span class="dv">4</span>), <span class="st">"("</span>, <span class="fu">round</span>(p_18_29_sim<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>), <span class="st">"% )</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb37-88"><a href="#cb37-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-89"><a href="#cb37-89" aria-hidden="true" tabindex="-1"></a><span class="co"># Fim do script</span></span>
<span id="cb37-90"><a href="#cb37-90" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Tabela de contingência (frequências absolutas):
      Sim Não
18-29 212  24
30-49 324  71
50-64 293 131
65+   156 235

Total geral: 1446 

Distribuição marginal por idade (frequências):
18-29 30-49 50-64   65+ 
  236   395   424   391 

Distribuição marginal por resposta (frequências):
Sim Não 
985 461 

Distribuição marginal por idade (percentual):
18-29 30-49 50-64   65+ 
   16    27    29    27 

Distribuição marginal por resposta (percentual):
Sim Não 
 68  32 

Tabela conjunta (proporções):
       Sim   Não
18-29 0.15 0.017
30-49 0.22 0.049
50-64 0.20 0.091
65+   0.11 0.163

Tabela conjunta (percentual):
      Sim  Não
18-29  15  1.7
30-49  22  4.9
50-64  20  9.1
65+    11 16.2

P(Resposta | Idade) — probabilidade de 'Sim' ou 'Não' dado a faixa etária (linhas somam 1):
       Sim  Não
18-29 0.90 0.10
30-49 0.82 0.18
50-64 0.69 0.31
65+   0.40 0.60

Em percentuais:
      Sim Não
18-29  90  10
30-49  82  18
50-64  69  31
65+    40  60

P(Idade | Resposta) — distribuição etária entre quem disse 'Sim' ou 'Não' (colunas somam 1):
       Sim   Não
18-29 0.22 0.052
30-49 0.33 0.154
50-64 0.30 0.284
65+   0.16 0.510

Em percentuais:
      Sim  Não
18-29  22  5.2
30-49  33 15.4
50-64  30 28.4
65+    16 51.0

P(Sim | 18-29) = 0.9 ( 90 % )
P(18-29 | Sim) = 0.22 ( 22 % )</code></pre>
</div>
</div>
<p>Gráficos</p>
<div class="cell">
<details class="code-fold"><summary>Código</summary><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Script: gráficos de barras empilhadas (contagem e 100% empilhado)</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Como usar: source("scripts/graficos_barras_empilhadas.R") ou execute no RStudio</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Saídas: exibe os gráficos e salva arquivos PNG no diretório de trabalho</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 0) Instala/carrega pacotes necessários (instala apenas se não existir)</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>required_pkgs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ggplot2"</span>, <span class="st">"dplyr"</span>, <span class="st">"scales"</span>, <span class="st">"RColorBrewer"</span>)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>installed <span class="ot">&lt;-</span> <span class="fu">rownames</span>(<span class="fu">installed.packages</span>())</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (pkg <span class="cf">in</span> required_pkgs) {</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>pkg <span class="sc">%in%</span> installed) <span class="fu">install.packages</span>(pkg, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(pkg, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Monta o data.frame com os dados fornecidos</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>idades <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"18-29"</span>, <span class="st">"30-49"</span>, <span class="st">"50-64"</span>, <span class="st">"65+"</span>)</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>respostas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Sim"</span>, <span class="st">"Não"</span>)</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Orden: para cada faixa etária -&gt; (Sim, Não)</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  <span class="dv">212</span>, <span class="dv">24</span>,    <span class="co"># 18-29</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>  <span class="dv">324</span>, <span class="dv">71</span>,    <span class="co"># 30-49</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>  <span class="dv">293</span>, <span class="dv">131</span>,   <span class="co"># 50-64</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>  <span class="dv">156</span>, <span class="dv">235</span>    <span class="co"># 65+</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">Idade =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(idades, <span class="at">each =</span> <span class="dv">2</span>), <span class="at">levels =</span> idades),</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">Resposta =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(respostas, <span class="at">times =</span> <span class="fu">length</span>(idades)), <span class="at">levels =</span> respostas),</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">Count =</span> counts</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Gráfico 1: barras empilhadas (contagens absolutas)</span></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>p_contagem <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> Idade, <span class="at">y =</span> Count, <span class="at">fill =</span> Resposta)) <span class="sc">+</span></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Count), <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">colour =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Respostas por faixa etária (contagem)"</span>,</span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Faixa etária"</span>,</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Contagem"</span>,</span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Resposta"</span>) <span class="sc">+</span></span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibe e salva</span></span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_contagem)</span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"barras_empilhadas_contagem.png"</span>, <span class="at">plot =</span> p_contagem, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Preparação para gráfico 100% empilhado (proporções dentro de cada idade)</span></span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>df_prop <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Idade) <span class="sc">%&gt;%</span></span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Prop =</span> Count <span class="sc">/</span> <span class="fu">sum</span>(Count)) <span class="sc">%&gt;%</span></span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) Gráfico 2: barras empilhadas em porcentagem (cada barra soma 100%)</span></span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a>p_percent <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_prop, <span class="fu">aes</span>(<span class="at">x =</span> Idade, <span class="at">y =</span> Count, <span class="at">fill =</span> Resposta)) <span class="sc">+</span></span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># rótulos com porcentagem dentro das fatias</span></span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(Prop <span class="sc">&gt;=</span> <span class="fl">0.03</span>, scales<span class="sc">::</span><span class="fu">percent</span>(Prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>), <span class="st">""</span>)),</span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_fill</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">colour =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Respostas por faixa etária (100% empilhado)"</span>,</span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Faixa etária"</span>,</span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Percentual"</span>,</span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Resposta"</span>) <span class="sc">+</span></span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-66"><a href="#cb39-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibe e salva</span></span>
<span id="cb39-67"><a href="#cb39-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_percent)</span>
<span id="cb39-68"><a href="#cb39-68" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"barras_empilhadas_percentual.png"</span>, <span class="at">plot =</span> p_percent, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb39-69"><a href="#cb39-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-70"><a href="#cb39-70" aria-hidden="true" tabindex="-1"></a><span class="co"># 5) Mensagem final</span></span>
<span id="cb39-71"><a href="#cb39-71" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">"Gráficos gerados: 'barras_empilhadas_contagem.png' e 'barras_empilhadas_percentual.png' no diretório de trabalho."</span>)</span>
<span id="cb39-72"><a href="#cb39-72" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap6-moore-tab-dupla-entrada_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cap6-moore-tab-dupla-entrada_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="section" class="level2" data-number="7.6"><h2 data-number="7.6" class="anchored" data-anchor-id="section">
<span class="header-section-number">7.6</span> </h2>


<div id="refs" class="references csl-bib-body" data-entry-spacing="1" role="list" style="display: none">
<div id="ref-Moore2023" class="csl-entry" role="listitem">
MOORE, David S.; NOTZ, William I.; FLIGNER, Michael A. <strong><a href="https://www.grupogen.com.br/livro-a-estatistica-basica-e-sua-pratica-david-s-moore-william-i-notz-e-michael-a-fligner-editora-ltc-9788521638605">Estatística Básica e sua prática</a></strong>. 9. ed. Rio de Janeiro: LTC, 2023.
</div>
</div>
</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>Os dados são do 2017 Digest of Education Statistics, no site do <em>National Center for Education Statistics</em>, <a href="https://nces.ed.gov/">nces.ed.gov</a>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiada");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiada");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./cap16-pldr-EstMultiv.html" class="pagination-link" aria-label="AID - cap 16 - Estatística Multivariada">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">AID - cap 16 - Estatística Multivariada</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./replicar-suco-uva-tab-graf.html" class="pagination-link" aria-label="AED - suco uva - Tabelas e Gráficos">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">AED - suco uva - Tabelas e Gráficos</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Relatório escrito em <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


</body></html>